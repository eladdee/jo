class BannermatrixBannerWebapi extends Polymer.Element{static get is(){return"bannermatrix-banner"}static get properties(){return{WEB_API:{type:String,value:"https://bannermatrix.nwacdn.com/v1"},WEB_API_CACHE:{type:Array,value:[]},operatorId:{type:String,value:""},positionTag:{type:String,value:"",observer:"_reload"},bannerType:{type:String,value:""},sportbookId:{type:String,value:""},event_status:{type:Number,value:0,notify:!0},pageTag:{type:String,value:"",observer:"_reload"},language:{type:String,value:"en"},loggedIn:{type:String,observer:"_loggedIn"},loaded:{type:Number,value:0,observer:"_loaded"},eventId:{type:String,value:""},eid:{type:String,value:""},tid:{type:String,value:""},width:{type:String,value:""},height:{type:String,value:""},activeBettingOffers:{type:Array,value:[],observer:"_activeBettingOffers"},slider_disable:{type:Array,value:[]},slider_disable_trigger:{type:String,value:"",observer:"_sliderDisableTrigger"},ws_session:{type:Object,value:null},hashdata:{type:String,value:""},last_hash:{type:Array,value:[]},textEvent:{type:String,value:""},textLiveEvent:{type:String,value:""},bannerId:{type:String,value:""},apiMethod:{type:String,value:""},emUserId:{type:String,value:""},emUserRoles:{type:Array,value:"",observer:"_userRoles"},emUserSession:{type:String,value:""},offerStatus:{type:String,value:"",observer:"_offerStatus"},translate:{type:Object,value:null,observer:"_reload"}}}_userRoles(newV,oldV){var self=this;if(!self.fromInclude){if("undefined"!==typeof newV&&"undefined"!==typeof oldV){if("true"==self.loggedIn&&newV.length!=oldV.length){setTimeout(function(){self.removeSession();self.startLoad()},500)}}if(null===self.emUserRoles||""===self.emUserRoles||"undefined"===self.emUserRoles){self.emUserRoles=[];self.setAttribute("em-user-roles",JSON.stringify(self.emUserRoles))}self.shadowRoot.querySelectorAll("#type_slider bannermatrix-banner").forEach(function(x){x.setAttribute("em-user-roles",JSON.stringify(self.emUserRoles))})}}_con(v,t){if("coupon"==t){if("1"==v){return""}else{var className="btnDisable";if("4"==v){className+=" btnRemoved"}else if("7"==v){className+=" btnSuspended"}return className}}else if("couponHide"==t){return!v?"cpItem-hide":""}}_con2(index,length,type){var className={score:"score_set_last",item:"item-last"};if("item"==type){if(length.length&&index==length[length.length-1]){return className[type]?className[type]:""}else{return""}}else{return index===length-1?className[type]?className[type]:"":""}}_isEqualTo(title,string){return title==string}_isEqualTo2(title1,string1,title2,string2){return title1==string1||title2==string2}_isEqualAndEqual(title1,string1,title2,string2){return title1==string1&&title2==string2}_notOrEqual(title1,string1,title2,string2){return title1!=string1||title2==string2}_hideSection(cValue,value){if("default"==cValue&&""==value||"background"==cValue&&"buttonNav"!=value||cValue===value){return!1}else{return!0}}_isPendingLayout1(id){return["1","7","8"].includes(id.toString())}_isSportForLayout2(id){return["1","8"].includes(id.toString())}_isDetailBottom(id){return["9"].includes(id.toString())}_isEqualOrIncident(title,string,incident_tournament){return title==string||"true"==incident_tournament}_showInterval(timecount){if(""!=timecount){return!1}return!0}_isMenuMobile1(content,title){if(""!=content||""!=title){return!0}return!1}_isMenuMobile2(content,title){if(""==content&&""==title){return!0}return!1}_reload(newV,oldV){var self=this;if(!self.fromInclude){if(self.pageTag&&self.positionTag){if("string"==typeof newV&&"undefined"!==typeof oldV&&newV&&oldV!=newV||"object"==typeof newV&&"object"==typeof oldV&&oldV&&newV&&Object.keys(oldV).length!=Object.keys(newV).length){self.resetWidget();self.readyBanner()}}if(null===self.translate||""===self.translate||"undefined"===self.translate){self.translate={};self.setAttribute("translate",JSON.stringify(self.translate))}self.shadowRoot.querySelectorAll("#type_slider bannermatrix-banner").forEach(function(x){x.setAttribute("translate",JSON.stringify(self.translate))})}}_loggedIn(newV,oldV){var self=this;if(!self.fromInclude){var lsLogin=self.lsGet("bmfe:login");if(("undefined"===typeof oldV||"undefined"===oldV||""===oldV)&&"undefined"!==typeof newV&&"undefined"!==newV&&""!==newV){self.loggedIn="true"!=newV?"false":"true"}else if("undefined"!==typeof oldV&&"undefined"!==oldV&&""!==oldV&&"undefined"!==typeof newV&&"undefined"!==newV&&""!==newV){if("true"!=oldV){oldV="false"}if("true"!=newV){newV="false"}if(oldV!=newV){self.loggedIn=newV;self.lsSet("bmfe:login",newV);self.set("text.status_id","");self.resetWidget();self.startLoad();if("true"==oldV&&"false"==newV){var lsBlockP=self.lsGet("bmfe:blockpopup","json"),iLogin=[],iLogout=lsBlockP.logout;iLogin=JSON.stringify(Array.from(new Set(iLogin)));iLogout=JSON.stringify(Array.from(new Set(iLogout)));self.lsSet("bmfe:blockpopup","{\"logout\":"+iLogout+", \"login\":"+iLogin+"}")}}}}}_activeBettingOffers(){var self=this;try{if(null===self.activeBettingOffers||""===self.activeBettingOffers||"undefined"===self.activeBettingOffers){self.activeBettingOffers=[];self.setAttribute("active-betting-offers",JSON.stringify(self.activeBettingOffers))}self.shadowRoot.querySelectorAll("#type_slider bannermatrix-banner").forEach(function(x){x.setAttribute("active-betting-offers",JSON.stringify(self.activeBettingOffers))});self.setActiveOdd()}catch(err){}}_loaded(newV,oldV){var self=this;if("undefined"!==typeof oldV){if(0==oldV&&1==newV){self.hideSkeleton()}if(1==oldV&&0==newV){self.showSkeleton()}}else{if(0==newV){var screenW=window.innerWidth;if(self.width){self.$.skeletonMain.style.width=self.width;screenW=self.width.replace("px","")}if(400>=screenW&&300<screenW&&0!=screenW){self.$.skeletonMain.classList.add("widget-mobile-xs");self.$.skeletonMain.classList.remove("widget-mobile-xxs")}else if(300>=screenW&&0!=screenW){self.$.skeletonMain.classList.add("widget-mobile-xs");self.$.skeletonMain.classList.add("widget-mobile-xxs")}else{self.$.skeletonMain.classList.remove("widget-mobile-xs");self.$.skeletonMain.classList.remove("widget-mobile-xxs")}if(576>screenW){self.$.skeletonMain.classList.add("widget-mobile");self.$.skeletonMain.classList.remove("widget-tablet");self.$.skeletonMain.classList.remove("widget-desktop")}else if(576<=screenW&&767>screenW){self.$.skeletonMain.classList.remove("widget-mobile");self.$.skeletonMain.classList.add("widget-tablet");self.$.skeletonMain.classList.remove("widget-desktop")}else{self.$.skeletonMain.classList.remove("widget-mobile");self.$.skeletonMain.classList.remove("widget-tablet");self.$.skeletonMain.classList.add("widget-desktop")}var i=0,wait=setInterval(function(){i++;if(null==self.widget_position_id){if(1e3<i){clearInterval(wait)}}else{clearInterval(wait);(async()=>{var check_first_banner="";if(0!=self.widget_position_id){var lsParam=self.positionTag+"-"+self.pageTag+"-"+self.loggedIn+"-"+self.eventId.toString(),ls=self.lsGet("bmfe:"+self.language+"-"+lsParam,"json");if("undefined"!==typeof ls.maindata&&ls.maindata.data.length){await Promise.all([ls.maindata.data.forEach((item,i)=>{if(""==check_first_banner){if(1==item.status_id||2==item.status_id){check_first_banner=item.banner_id+"-"+item.event_id+"-"+self.language;self.haveEventCache=!0;self.hideSkeleton();self.showLoading=!1;self.getEventCache(check_first_banner)}else{check_first_banner="nocache"}}})]).then(pData=>{if("nocache"==check_first_banner){self.setSkeleton()}})}else{self.setSkeleton()}}else{self.setSkeleton()}})();if(!self.fromInclude){var eventReady=new CustomEvent("BMFEready",{detail:{bannerId:self.bannerId,language:self.language,operatorId:self.operatorId,positionTag:self.positionTag,eventId:self.eventId,pageTag:self.pageTag,isLogin:self.loggedIn}});window.dispatchEvent(eventReady,{bubbles:!0,cancelable:!0})}}},15)}}}_sliderDisableTrigger(newV,oldV){var self=this;if(newV!=oldV){self.removeSliderNoOdds()}}_offerText(focus,scoreEventPart){var self=this;if(focus&&focus.sportId&&focus.metaData){if(focus.metaData.periodStatus){self.set("text.partName",focus.metaData.periodStatus)}else{self.set("text.partName","")}if(focus.metaData.t1MatchTime){var prefix="";if(self.widget_layout&&!["2","4","7","8"].includes(self.widget_layout.toString())){prefix=", "}var minute=focus.metaData.t1MatchTime.toString().replace(".0","");self.set("text.minute",prefix+minute+"'");self.minsec(minute)}self.filterEventPart("update",scoreEventPart,focus.sportId)}}_offerScores(focus){let scores=[];if(focus&&"live"==focus.state&&"active"==focus.status&&focus.metaData){if(focus.metaData.periods){scores=focus.metaData.periods}if(focus.metaData.emPeriods&&focus.metaData.emPeriods.length){scores=focus.metaData.emPeriods}}return scores}_offerStatus(newV,oldV){var self=this;if("update"==newV){setTimeout(function(){self.setAttribute("offer-status","")},2e3);if(newV!=oldV&&"offerlibrary"==self.apiMethod&&self.eid&&"undefined"!==typeof self.WEB_API_CACHE.offer_library_ready){const eventId=self.eid,focus=self.WEB_API_CACHE.offer_library.sport.matches.get(eventId);if(focus){const outcomes=focus.outcomes,eventScores=self._offerScores(focus);let scoreEventPart=[];(async()=>{await Promise.all([self.shadowRoot.querySelectorAll(".bgButton2").forEach(function(x){const index=outcomes.findIndex(v=>v.outcomeHash==x.getAttribute("data-offer"));var eId=x.getAttribute("id"),olddata=x.getAttribute("data-price"),newdata=outcomes[index].value.toString(),statusOdd=newdata>olddata?"up":newdata<olddata?"down":"";if(statusOdd){if(null!==self.shadowRoot.getElementById(eId)){var showprice=self.getNumber(newdata,2);x.querySelector(".odv").innerHTML=showprice;self.shadowRoot.getElementById(eId).setAttribute("data-price",outcomes[index].value);self.shadowRoot.getElementById(eId).classList.remove("btRed");self.shadowRoot.getElementById(eId).classList.remove("btGreen");self.shadowRoot.getElementById(eId).classList.add("up"==statusOdd?"btGreen":"btRed");self.shadowRoot.getElementById(eId).classList.add("ws"+eId);if(self.bettingClass[eId+self.widget_id]){clearTimeout(self.bettingClass[eId]);self.bettingClass[eId+self.widget_id]=null}self.bettingClass[eId+self.widget_id]=setTimeout(function(){if(null!==self.shadowRoot.getElementById(eId)){self.shadowRoot.querySelectorAll(".ws"+eId).forEach(function(z){z.classList.remove("up"==statusOdd?"btGreen":"btRed");z.classList.remove("ws"+eId)})}},5e3)}}}),eventScores.forEach((item,i)=>{if("undefined"!=typeof item.t1Scr&&"undefined"!=typeof item.t2Scr){scoreEventPart.push({eventPartKey:item.type,eventPartName:item.name,homeScore:item.t1Scr,awayScore:item.t2Scr})}})]).then(pData=>{if(scoreEventPart.length){self._offerText(focus,scoreEventPart)}})})()}}}}_wholeMatch(key,score_whole){if("WholeMatch"==key||"OrdinaryTime"==key&&"undefined"===typeof score_whole){return!0}return!1}isSliderBanner(){var self=this;if(0==self.widget_position_id&&!("streaming"==self.bannerType&&self.sportbookId)&&"iframe"!=self.bannerType){return!0}else{return!1}}isSpecialBanner(){var self=this;if("streaming"==self.bannerType&&self.sportbookId||"iframe"==self.bannerType){return!0}else{return!1}}linkBoth(){var self=this;if(self.slider_setting&&self.slider_setting.link&&"undefined"!==typeof self.slider_setting.link[self.language]&&self.slider_setting.link[self.language].link_both){return!0}else{return!1}}convertStatusURL(url){var self=this,newURL=url;try{var wDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0].web_data:void 0;if(0==self.widget_position_id&&""==self.bannerId||"undefined"!==typeof wDt&&3==wDt.type_id||2==wDt.type_id&&("undefined"===typeof wDt.tournament_event_id||0==wDt.tournament_event_id.length)||"undefined"===typeof wDt.event_id||"undefined"===typeof self.arrEvent[wDt.event_id]){return newURL}else{var wsdata=self.arrEvent[wDt.event_id],sportId=wsdata.sportId,sportName=wsdata.sportName,shortSportName=wsdata.shortSportName,venueName=wsdata.venueName,shortVenueName=wsdata.shortVenueName,shortParentName=wsdata.shortParentName;if(shortParentName){shortParentName=shortParentName.replaceAll(",","")}var name=wsdata.name;if(name){name=name.replaceAll(" - ","-")}var shortName=wsdata.shortName;if(shortName){shortName=shortName.replaceAll(" - ","-")}var id=wsdata.id,txtEvent=self.getTextEvent(1),txtLiveEvent=self.getTextEvent(2),checkUrl="/"+txtEvent+"/"+sportId+"/"+sportName+"/"+venueName+"/"+shortParentName+"/"+name+"/"+id+"/";checkUrl=checkUrl.replaceAll(" ","-").toLowerCase();var checkShortUrl="/"+txtEvent+"/"+sportId+"/"+shortSportName+"/"+shortVenueName+"/"+shortParentName+"/"+shortName+"/"+id+"/";checkShortUrl=checkShortUrl.replaceAll(" ","-").toLowerCase();var checkLiveUrl="/"+txtLiveEvent+"/"+sportId+"/"+sportName+"/"+venueName+"/"+shortParentName+"/"+name+"/"+id+"/";checkLiveUrl=checkLiveUrl.replaceAll(" ","-").toLowerCase();var checkShortLiveUrl="/"+txtLiveEvent+"/"+sportId+"/"+shortSportName+"/"+shortVenueName+"/"+shortParentName+"/"+shortName+"/"+id+"/";checkShortLiveUrl=checkShortLiveUrl.replaceAll(" ","-").toLowerCase();if(1==wsdata.statusId){if(url.includes(checkLiveUrl)){return newURL.replace(checkLiveUrl,checkUrl)}else if(url.includes(checkShortLiveUrl)){return newURL.replace(checkShortLiveUrl,checkShortUrl)}}else if(2==wsdata.statusId){if(url.includes(checkUrl)){return newURL.replace(checkUrl,checkLiveUrl)}else if(url.includes(checkShortUrl)){return newURL.replace(checkShortUrl,checkShortLiveUrl)}}return newURL}}catch(err){return newURL}}convertURL(url){var self=this,newURL="";if(0==url.indexOf("http")){newURL=url}else{var parentURL=window.location!=window.parent.location?document.referrer:document.location.href;if(parentURL){var domain=new URL(parentURL);if(domain.origin){if(0==url.indexOf("/")){newURL=domain.origin+""+url}else{newURL=domain.origin+"/"+url}}}}newURL=self.convertStatusURL(newURL);return newURL}hasWebP(){return new Promise(res=>{const webP=new Image;webP.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";webP.onload=webP.onerror=()=>{res(2===webP.height)}})}randomID(){for(var charSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",randomString="",i=0,randomPoz;15>i;i++){randomPoz=Math.floor(Math.random()*charSet.length);randomString+=charSet.substring(randomPoz,randomPoz+1)}return randomString}randomRGBA(){var o=Math.round,r=Math.random,s=255;return"rgba("+o(r()*s)+","+o(r()*s)+","+o(r()*s)+",1)"}setActiveOdd(){var self=this,list=self.shadowRoot.querySelectorAll(".bgButton2");if(list.length){let setDefault=!1;if(self.marketsColumn&&!self.marketsColumn.length){setDefault=!0}list.forEach((item,i)=>{var id=item.getAttribute("data-offer");self.shadowRoot.querySelectorAll(".bgButton[data-offer=\""+id+"\"]").forEach(function(x){if(self.activeBettingOffers.includes(id)){x.classList.add("activeButton")}else{x.classList.remove("activeButton")}if(setDefault&&item.id){self.marketsColumn.push({id:item.id.replace("outcome_",""),name:item.querySelector(".oddButtonName").innerHTML,value:0,class:"disabled"})}})})}}outcomeOrder(btID,role,props={},homeParticipantId="",awayParticipantId="",price=""){var order=999,ocOrder=[];if("undefined"!==typeof btID&&btID){if("undefined"===typeof role&&"undefined"!==typeof homeParticipantId&&"undefined"!==typeof awayParticipantId){role="none";if("undefined"!==typeof props.participantId1){if(props.participantId1==homeParticipantId){role="home"}else if(props.participantId1==awayParticipantId){role="away"}}}if(-1!=["8","69","280","693"].indexOf(btID)){ocOrder=["home","draw","away"]}else if(-1!=["339","348"].indexOf(btID)){ocOrder=["home","none","away"]}else if(-1!=["9"].indexOf(btID)){ocOrder=["home-draw","home-away","away-draw"]}else if(-1!=["10","15","17","39","48","60","62","70","71","104","112","120","135","138","182","191","228","293","318","367","369","380","384","466","694"].indexOf(btID)){ocOrder=["home","away"]}else if(-1!=["47","92","97","100","118","143","159","179","185","193","194","204","206","207","229","230","254","278","283","290","322","323","324","325","326","327","328","334","340","377","392","533","537","538","543","548","549","561","572","573"].indexOf(btID)){ocOrder=["over","under"]}else if(-1!=["66","76","140"].indexOf(btID)){ocOrder=["yes","no"]}else if(-1!=["35","153","276","329"].indexOf(btID)){ocOrder=["odd","even"]}else if(-1!=["45"].indexOf(btID)){ocOrder=["home1-0","draw0-0","away0-1","home2-0","draw1-1","away0-2","home3-0","draw2-2","away0-3","home4-0","draw3-3","away0-4","home5-0","draw4-4","away0-5","home6-0","draw5-5","away0-6","home7-0","draw6-6","away0-7","home8-0","draw7-7","away0-8","home9-0","draw8-8","away0-9","home10-0","draw9-9","away0-10","home11-0","draw10-10","away0-11"];if("undefined"!==typeof props.param1&&"undefined"!==typeof props.param2){role=role+""+props.param1.toString()+"-"+props.param2.toString()}}if("undefined"!==typeof role&&ocOrder.length){role=role.replace("_","-");var index=ocOrder.indexOf(role);if(-1!=index){order=index+1}}else if(-1!=["30"].indexOf(btID)){order=price}}return order}genCacheName(tid,id,eid,lang){var cName=id+"-"+eid+"-"+lang;if(4==tid){cName=id+"-recommend-"+lang}else if(6==tid){cName=id+"-popular-"+lang}else if(7==tid){cName=id+"-coupon-"+lang}else if(8==tid){cName=id+"-coupon-popular-"+lang}else if(9==tid){cName=id+"-coupon-betbuilder-"+lang}return cName}getEventCache(cacheName,root=!0){var self=this,screenW=window.innerWidth,screenH=window.innerHeight;if(self.bannerId&&self.parentNode){screenW=self.parentNode.offsetWidth;screenH=self.parentNode.offsetHeight}var eCache=self.getEventLs(cacheName);if(eCache){self.cacheLoading=!0;self.setTypeBanner();if(self.bannerId&&(0==screenW||0==screenH)&&root){var i=0,wait=setInterval(function(){i++;if(self.parentNode){screenW=self.parentNode.offsetWidth;screenH=self.parentNode.offsetHeight}if(30<i||0!=screenW&&0!=screenH){clearInterval(wait);self.getEventCache(cacheName,!1)}},20)}else{if("undefined"!==typeof eCache.image_banner_set){if(eCache.image_banner_set&&eCache.image_banner_set.video){self.setVideo(eCache.image_banner_set.video)}else{self.setImage(eCache.image_banner_set,screenW,screenH,!0)}}if("undefined"!==typeof eCache.background_color&&eCache.background_color){self.$.backgroundBanner.style.background=eCache.background_color}else{self.$.backgroundBanner.style.background=null}var bg_opacity=1;if("undefined"!==typeof eCache.background_image_transperent&&eCache.background_image_transperent){bg_opacity=eCache.background_image_transperent/100}self.$.backgroundBanner2.style.opacity=bg_opacity;if("undefined"!==typeof eCache.type_id&&eCache.type_id){self.tid=eCache.type_id.toString()}if("undefined"!==typeof eCache.widget_layout&&eCache.widget_layout){if(eCache.widget_layout!=self.widget_layout){self.customStyleSetLayoutLS(eCache.widget_layout)}self.widget_layout=eCache.widget_layout.toString()}if("undefined"!==typeof eCache.title&&eCache.title){self.set("text.title",self.genTranslate(eCache.title))}if("undefined"!==typeof eCache.content&&eCache.content){self.set("text.content",self.genTranslate(eCache.content))}if("undefined"!==typeof eCache.homeName&&eCache.homeName){self.set("text.homeName",eCache.homeName)}if("undefined"!==typeof eCache.awayName&&eCache.awayName){self.set("text.awayName",eCache.awayName)}if("undefined"!==typeof eCache.time&&eCache.time){self.set("text.time",eCache.time)}if("undefined"!==typeof eCache.eventId&&eCache.eventId){self.set("text.event_id",eCache.eventId)}if("undefined"!==typeof eCache.eventName&&eCache.eventName){self.set("text.event_name",eCache.eventName)}if("undefined"!==typeof eCache.statusId&&eCache.statusId){self.set("text.status_id",eCache.statusId)}if("undefined"!==typeof eCache.statusName&&eCache.statusName){self.set("text.status",eCache.statusName)}if("undefined"!==typeof eCache.partName&&eCache.partName){self.set("text.partName",eCache.partName)}if("undefined"!==typeof eCache.devices){self.$.slideSource.classList.remove("d_desktop");self.$.slideSource.classList.remove("d_tablet");self.$.slideSource.classList.remove("d_mobile");if("undefined"!==typeof eCache.devices.desktop&&eCache.devices.desktop){self.$.slideSource.classList.add("d_desktop")}if("undefined"!==typeof eCache.devices.tablet&&eCache.devices.tablet){self.$.slideSource.classList.add("d_tablet")}if("undefined"!==typeof eCache.devices.mobile&&eCache.devices.mobile){self.$.slideSource.classList.add("d_mobile")}self.$.slideSource.classList.add("fadebanner")}if("undefined"!==typeof eCache.sport_id&&eCache.sport_id){self.set("text.sportId",eCache.sport_id)}if("undefined"!==typeof eCache.sport_name&&eCache.sport_name){self.set("text.sportName",eCache.sport_name)}if("undefined"!==typeof eCache.tournament_id&&eCache.tournament_id){self.set("text.tournamentId",eCache.tournament_id)}if("undefined"!==typeof eCache.tournament_name&&eCache.tournament_name){self.set("text.tournamentName",eCache.tournament_name)}if("undefined"!==typeof eCache.location_id&&eCache.location_id){self.set("text.countryId",eCache.location_id)}if("undefined"!==typeof eCache.location_name&&eCache.location_name){self.set("text.countryName",eCache.location_name)}if("undefined"!==typeof eCache.action_outcome&&eCache.action_outcome){if("undefined"!==typeof eCache.type_id&&["7","8","9"].includes(eCache.type_id.toString())){self.setOfferList(JSON.parse(eCache.action_outcome),eCache.type_id)}else{self.$.slidebanner.innerHTML=eCache.action_outcome}self.setActiveOdd()}if("undefined"!==typeof eCache.marketname&&eCache.marketname){self.set("text.marketname",self.getText(eCache.marketname));self.set("text.labelName",eCache.labelName);self.set("text.labelStyle",eCache.labelStyle)}if("undefined"!==typeof eCache.generate_link&&eCache.generate_link&&"undefined"!==typeof eCache.eventLink&&eCache.eventLink){self.$.buttonNavLayout.classList.add("showcursor");var target_link=eCache.generate_target,btn="<div class=\"no_link_btn\"><br><button class=\"btLink btLink"+self.bannerId+"\" onclick=\"this.getRootNode().host.handleClick('"+eCache.eventLink+"', '"+target_link+"')\"></button></div>";self.$.bannerContentMain.classList.add("showcursor");self.$.buttondetail.innerHTML=btn;self.$.buttonNav_btn.innerHTML=btn;self.$.bannerContentMain.classList.add("linkBanner");self.$.bannerContentMain.classList.add("cacheLinkBanner")}if("undefined"!==typeof eCache.type_id&&"undefined"!==typeof self.height&&self.height&&["7","8","9"].includes(eCache.type_id.toString())){setTimeout(function(){var maxContentHeight=self.height.replace("px","")-self.shadowRoot.querySelector(".cpHeader").offsetHeight-self.shadowRoot.querySelector(".cpFooter").offsetHeight;self.shadowRoot.querySelector(".cpContent").style.maxHeight=maxContentHeight+"px"},30)}if("undefined"!==typeof eCache.marketsColumn&&eCache.marketsColumn&&eCache.marketsColumn.length){self.marketsColumn=eCache.marketsColumn.map(function(ocI){return{...ocI,class:"disabled"}})}self.onResize();self.cacheLoading=!1}}}setOfferList(list,tid,update=null){var self=this;if(Array.isArray(list)&&(update&&9!=tid||!update)){var change=!1,offerListOld=[...list],totalOdds=0,offerList=[],offerListIndex=[],oddsCA=[];self.set("offerList",[]);self.set("offerListIndex",[]);self.set("offerCheckedArray",[]);self.set("oddsCheckedArrayCount",0);(async()=>{await Promise.all([offerListOld.forEach((item,i)=>{if(update){if(item.id==update.id){if(item.isAvailable!=update.changedProperties.isAvailable||item.statusId!=update.changedProperties.statusId){change=!0}item.isAvailable=update.changedProperties.isAvailable?!0:!1;item.statusId=update.changedProperties.statusId}}else{item.odds=0}offerList.push(item);if(item.isAvailable){totalOdds=(0==totalOdds?1:totalOdds)*item.odds;oddsCA.push({eventId:item.MATCH.id,bettingOfferId:item.id,odd:item.odds});offerListIndex.push(item.id)}})]).then(cThen=>{self.set("offerList",offerList);self.set("offerListIndex",offerListIndex);self.set("offerCheckedArray",oddsCA);if(9==tid){if(!update){self.set("oddsCheckedArrayCount",0)}}else{self.set("oddsCheckedArrayCount",totalOdds)}if(update){setTimeout(function(){self.handleCouponCheckboxChange()},100)}if("8"==tid&&change&&!self.disableFallback){if("undefined"!==typeof self.subscribePopular.id&&self.subscribePopular.active){try{self.ws_session.unregister(self.subscribePopular)}catch(err){self.subscribePopular={}}}self.rmCacheE();self.resetWidget();self.startLoad()}})})()}}setSliderOption(cHeight,isSkeleton=!1,enable_loop){var self=this,height=cHeight+"px";if(0==cHeight){height="auto"}var perPage=1,perMove_desktop=1,perPage_tablet=1,perMove_tablet=1,perPage_mobile=1,perMove_mobile=1,setgap="0px",option={};if(isSkeleton){option={height:height,type:"slide",pagination:!1,cover:!1,focus:"left",arrows:!1,drag:!1}}else{option={height:height,type:"loop",pagination:!1,cover:!0,focus:"left",heightRatio:.5}}if(0==self.widget_position_id&&""==self.bannerId){if("undefined"!==typeof self.slider_layout){if("1"==self.slider_layout){}else if("2"==self.slider_layout){option.padding={right:"2rem"};if(!isSkeleton){option.heightRatio=.54}}else if("3"==self.slider_layout){option.padding={left:"2rem",right:"2rem"};if(!isSkeleton){option.heightRatio=.54}}else if("4"==self.slider_layout){perPage=self.slider_setting.slider_layout_multiple?self.slider_setting.slider_layout_multiple:"4";perMove_desktop=Math.floor(perPage);perPage_tablet=self.slider_setting.slider_layout_multiple_tablet?self.slider_setting.slider_layout_multiple_tablet:"3";if(3<perPage_tablet){perPage_tablet=3}perMove_tablet=Math.floor(perPage_tablet);perPage_mobile=self.slider_setting.slider_layout_multiple_tablet?self.slider_setting.slider_layout_multiple_mobile:"2";if(2<perPage_mobile){perPage_mobile=2}perMove_mobile=Math.floor(perPage_mobile);setgap=self.slider_setting.slider_layout_padding?self.slider_setting.slider_layout_padding:"0"+"px";if("undefined"!==typeof self.slider_setting.slider_layout_width&&0!=self.slider_setting.slider_layout_width){option.fixedWidth=self.slider_setting.slider_layout_width+"px";if(isSkeleton){option.type="loop"}}else{option.perPage=perMove_desktop;option.perMove=perMove_desktop;option.padding={right:self.sliderPadding(perPage)};option.breakpoints={1024:{perPage:perMove_tablet,perMove:perMove_tablet,padding:{right:self.sliderPadding(perPage_tablet)}},479:{perPage:perMove_mobile,perMove:perMove_mobile,padding:{right:self.sliderPadding(perPage_mobile)}}}}}}if(setgap){option.gap=setgap}else{option.gap=1}if(!isSkeleton){if("undefined"!==typeof self.slider_layout){self.$.type_slider.classList.add("slide_id_"+self.slider_layout)}else{self.$.type_slider.classList.add("slide_id_1")}self.$.type_slider.style.overflowY="auto";if("undefined"!==typeof self.height&&self.height){self.$.type_slider.style.height=self.height;self.$.skeletonMain.style.height=self.height;option.height=self.height}if(0==self.slider_setting.duration){option.autoplay=!1;option.speed=0}else{option.autoplay=self.slider_setting.slider_auto_slide;option.speed=1e3*self.slider_setting.animation_time;option.interval=1e3*self.slider_setting.duration;if(0>self.slider_setting.animation_time||2<self.slider_setting.animation_time){option.speed=2e3}}option.arrows=self.slider_layout_arrow;if(self.slider_layout_arrow&&null!=self.slider_layout_arrow){option.arrows=self.slider_layout_arrow}if(self.slider_setting.slider_layout_stop_end){option.rewind=!1}else{option.rewind=!0}if(1==self.slider_setting.transition_type){option.type="fade"}else{if(!option.rewind){option.type="slide"}else{if(enable_loop){option.type="loop"}else if("undefined"===typeof option.fixedWidth){option.type="slide";if("0%"!=self.sliderPadding(self.slider_setting.slider_layout_multiple)||"0%"!=self.sliderPadding(self.slider_setting.slider_layout_multiple_tablet)||"0%"!=self.sliderPadding(self.slider_setting.slider_layout_multiple_mobile)){option.type="loop"}else if(!self.slider_setting.slider_layout_arrow&&!self.slider_setting.slider_layout_bullets){option.type="loop"}}}}if(self.slider_setting.slider_layout_bullets){option.pagination=!0}else{option.pagination=!1}if("undefined"===typeof option.direction){option.direction="ltr"}}}return option}setSkeleton(){var self=this;if(self.bannerId){self.sliderSkelArray=[1]}self.loadedSkelOrDemoPage=!0;var cHeight="250";if("undefined"!==typeof self.height&&self.height){cHeight=self.height.replace("px","")}var option=self.setSliderOption(cHeight,!0);if(!self.demo){if(self.isSliderBanner()){if("block"!=self.$.skeletonMain.style.display){if(self.haveEventCache){}else{self.$.skeletonMain.style.display="block"}}}}try{self.shadowRoot.querySelector("#ul_slide_skeleton li:first-child").style.height=self.shadowRoot.querySelector("#type_slider_skeleton").clientHeight+"px"}catch(err){}self.primarySkeleton=new Splide(self.shadowRoot.querySelector("#primary-skeleton"),option).mount();if(!self.showLoading){self.hideSkeleton()}if(self.bannerId&&0==self.widget_position_id){self.$.bannermatrix.style.height="100%";var timeOut=30;if(0!=self.shadowRoot.querySelector("#skeletonMain").clientWidth&&0!=self.shadowRoot.querySelector("#skeletonMain").clientHeight){timeOut=0}var i=0,wait=setInterval(function(){i++;if(!self.haveEventCache&&(0==self.shadowRoot.querySelector("#skeletonMain").clientWidth||0==self.shadowRoot.querySelector("#skeletonMain").clientHeight)){if(500<i){clearInterval(wait)}}else{clearInterval(wait);var new_h=self.shadowRoot.querySelector("#skeletonMain").clientHeight,new_w=self.shadowRoot.querySelector("#skeletonMain").clientWidth;if(250>new_h&&""==self.height){new_h=250}try{if(null!=self.shadowRoot.querySelector("#ul_slide_skeleton li:first-child")){self.shadowRoot.querySelector("#ul_slide_skeleton li:first-child").style.width=new_w+"px";if(self.fromInclude){self.shadowRoot.querySelector("#ul_slide_skeleton li:first-child").style.height=new_h+"px";self.shadowRoot.querySelector("#ul_slide_skeleton").style.width="100%";self.shadowRoot.querySelector("#ul_slide_skeleton li:first-child").style.width="100%"}}self.primarySkeleton.on("active",function(e){if(null!=self.shadowRoot.querySelector("#ul_slide_skeleton li:first-child")){self.shadowRoot.querySelector("#ul_slide_skeleton li:first-child").style.width=new_w+"px";if(self.fromInclude){self.shadowRoot.querySelector("#ul_slide_skeleton li:first-child").style.height=new_h+"px"}}})}catch(err){}}},timeOut)}}resetWidget(){var self=this;self.set("text.minute","");self.set("text.timecount","");self.set("text.title","");self.set("text.content","");self.set("text.tournamentId","");self.set("text.tournamentName","");self.set("text.sportId","");self.set("text.sportName","");self.set("text.partName","");self.set("text.homeName","");self.set("text.awayName","");self.set("text.time","");self.set("eventScoreDetails ",[]);self.set("text.countryId","");self.set("text.countryName","");clearInterval(self.waitDuration);clearInterval(self.waitMinute);clearInterval(self.waitRepeat);clearInterval(self.waitChange);clearTimeout(self.waitTIncidentClose);clearTimeout(self.waitTShowName);clearTimeout(self.waitTDelayIncident);clearTimeout(self.waitTSliderCheck);self.$.slidebanner.innerHTML="";self.$.backgroundBanner.style.background=null;self.$.backgroundBanner2.style.backgroundImage=null;self.$.buttonNav_image.style.backgroundImage=null;self.$.backgroundBanner.setAttribute("data-bg-img-thumbnail",null);self.$.slideSource.classList.remove("d_desktop");self.$.slideSource.classList.remove("d_tablet");self.$.slideSource.classList.remove("d_mobile");self.$.type_slider.classList.remove("d_desktop");self.$.type_slider.classList.remove("d_tablet");self.$.type_slider.classList.remove("d_mobile");self.$.slideSource.classList.remove("fadebanner");self.shadowRoot.querySelectorAll(".nameMarketRender").forEach(function(x){x.classList.remove("opacity0")});self.last_score=null;self.last_yellow_card=null;self.last_red_card=null;self.last_corner=null;self.incident_market_id="";self.offerList=[];self.offerListIndex=[];self.marketsColumn=[];if(self.widget){if("undefined"!==typeof self.widget.content_arr){self.widget.content_arr=[]}if("undefined"!==typeof self.widget.content_data){self.widget.content_data=[]}}self.listInterval=null;if(self.ws_session){if("undefined"!==typeof self.subscribeCoupon.id&&self.subscribeCoupon.active){try{self.ws_session.unregister(self.subscribeCoupon)}catch(err){self.subscribeCoupon={}}}if("undefined"!==typeof self.subscribeCouponBBD.id&&self.subscribeCouponBBD.active){try{self.ws_session.unregister(self.subscribeCouponBBD)}catch(err){self.subscribeCouponBBD={}}}}self.resetMinsec()}getNumber(v,d){var self=this,separator=".";if(self.slider_setting&&self.slider_setting.extra_config&&self.slider_setting.extra_config.separator){separator=self.slider_setting.extra_config.separator}if("undefined"===typeof v){return""}else if(0===v){return"0.00".replace(".",separator)}var num=+Big(Math.floor(+Big(v).times(Math.pow(10,2)))).div(Math.pow(10,2));if("undefined"===typeof num){return""}if("undefined"===typeof v.toString().split(".")[1]){num=(Math.round(100*num)/100).toFixed(2)}else if("undefined"!==typeof num.toString().split(".")[1]&&2>num.toString().split(".")[1].length){num=(Math.round(100*num)/100).toFixed(2)}if("undefined"===typeof num.toString().split(".")[1]){num=v;if("undefined"!==typeof v.toString().split(".")[1]){if(1>=v.toString().split(".")[0]){num=v.toString().split(".")[0]+"."+v.toString().split(".")[1].substr(0,3)}else{num=v.toString().split(".")[0]+"."+v.toString().split(".")[1].substr(0,2)}}}return num.toString().replace(".",separator)}generateImage(imageArr,w,h){var self=this;if("undefined"===typeof imageArr||0==imageArr.length){return!1}var ratio=Math.fround(w/h).toFixed(2),image="",key="",arrRatio=[4.7,3.7,2.35,1.95,1.85,1.78,1.5,1.33,1.25,1],arrImage=[];arrImage[0]="undefined"!==typeof imageArr.image_4_7_1?imageArr.image_4_7_1:"";arrImage[1]="undefined"!==typeof imageArr.image_3_7_1?imageArr.image_3_7_1:"";arrImage[2]="undefined"!==typeof imageArr.image_2_35_1?imageArr.image_2_35_1:"";arrImage[3]="undefined"!==typeof imageArr.image_1_95_1?imageArr.image_1_95_1:"";arrImage[4]="undefined"!==typeof imageArr.image_1_85_1?imageArr.image_1_85_1:"";arrImage[5]="undefined"!==typeof imageArr.image_16_9?imageArr.image_16_9:"";arrImage[6]="undefined"!==typeof imageArr.image_3_2?imageArr.image_3_2:"";arrImage[7]="undefined"!==typeof imageArr.image_4_3?imageArr.image_4_3:"";arrImage[8]="undefined"!==typeof imageArr.image_5_4?imageArr.image_5_4:"";arrImage[9]="undefined"!==typeof imageArr.image_1_1?imageArr.image_1_1:"";if(ratio){arrRatio.forEach((item,i)=>{if(""==key){if(ratio>item){key=i?i-1:0;if(arrRatio[i+1]){var diff=item-arrRatio[i+1];if(ratio-item<diff/3){key++}}}}})}if(""==key){key=9}if(""!=arrImage[key]&&null!=arrImage[key]&&"NULL"!=arrImage[key]&&"null"!=arrImage[key]){image=arrImage[key]}else{for(var i=1;9>=i;i++){if(image){break}else{if(9>=key+i){if(""!=arrImage[key+i]&&null!=arrImage[key+i]&&"NULL"!=arrImage[key+i]&&"null"!=arrImage[key+i]){image=arrImage[key+i];break}}if(0<=key-i){if(""!=arrImage[key-i]&&null!=arrImage[key-i]&&"NULL"!=arrImage[key-i]&&"null"!=arrImage[key-i]){image=arrImage[key-i];break}}}}}if(imageArr.webp&&self.webp_support&&image&&".gif"!=image.toLowerCase().substr(-4)){image=image+".webp"}return image}setVideo(src){var self=this;if(src){self.$.backgroundBanner2.style.display="none";var sources=self.$.backgroundBannerVideoSrc.getElementsByTagName("source");if(sources.length){self.$.backgroundBannerVideoSrc.classList.remove("hide");sources[0].src=src;self.$.backgroundBannerVideoSrc.load()}}}setImage(data,screenW,screenH,showNav=!1){var self=this;if(data){if(3==self.tid&&"buttonNav"==self.useSection){self.$.backgroundBanner2.style.display="none"}else{self.$.backgroundBanner2.style.display="block"}var image=self.generateImage(data,screenW,screenH);if(image&&"null"!=image&&null!=image){self.$.backgroundBanner2.style.backgroundImage="url('"+image+"')";if(showNav){self.$.buttonNav_image.style.backgroundImage="url('"+image+"')"}}else if(self.slider_setting){image=self.generateImage(self.slider_setting,screenW,screenH);if(image&&"null"!=image&&null!=image){self.$.backgroundBanner2.style.backgroundImage="url('"+image+"')";if(showNav){self.$.buttonNav_image.style.backgroundImage="url('"+image+"')"}}}}}positions(name){var id=1;if(-1!=["navbar","center-navbar"].indexOf(name)){id=4}else if(-1!=["popup","center-popup"].indexOf(name)){id=2}else if(-1!=["bottom","center-bottom"].indexOf(name)){id=1}else if(-1!=["slider","center-main-slider"].indexOf(name)){id=0}else{id=3}return id}onResize(){var self=this,screenW=window.innerWidth,screenH=window.innerHeight,change="";if(480>screenW&&"mobile"!=self.nowScreen){change="mobile"}else if(481<=screenW&&1024>=screenW&&"tablet"!=self.nowScreen){change="tablet"}else if(1024<screenW&&"desktop"!=self.nowScreen){change="desktop"}if(self.waitTScreensize){clearTimeout(self.waitTScreensize);self.waitTScreensize={}}self.waitTScreensize=setTimeout(function(){if(null!=self.shadowRoot.querySelector("#ul_slide li:first-child")){screenW=self.shadowRoot.querySelector("#ul_slide li:first-child").offsetWidth;screenH=self.shadowRoot.querySelector("#ul_slide li:first-child").offsetHeight}else{screenW=self.$.backgroundBanner.offsetWidth;screenH=self.$.backgroundBanner.offsetHeight}if(400>=screenW&&300<screenW&&0!=screenW){self.$.backgroundBanner.classList.add("widget-mobile-xs");self.$.backgroundBanner.classList.remove("widget-mobile-xxs");if(self.$.buttondetail.innerHTML){self.$.backgroundBanner.classList.add("linkcursor")}else{self.$.backgroundBanner.classList.remove("linkcursor")}}else if(300>=screenW&&0!=screenW){self.$.backgroundBanner.classList.add("widget-mobile-xs");self.$.backgroundBanner.classList.add("widget-mobile-xxs");if(self.$.buttondetail.innerHTML){self.$.backgroundBanner.classList.add("linkcursor")}else{self.$.backgroundBanner.classList.remove("linkcursor")}}else{self.$.backgroundBanner.classList.remove("widget-mobile-xs");self.$.backgroundBanner.classList.remove("widget-mobile-xxs");self.$.backgroundBanner.classList.remove("linkcursor")}if("3"===self.tid&&self.linkBoth()){if(self.$.buttondetail.innerHTML){self.$.bannerContentMain.classList.add("showcursor")}else{self.$.bannerContentMain.classList.remove("showcursor")}}if(0!=screenW){if(576>screenW){self.$.backgroundBanner.classList.add("widget-mobile");self.$.backgroundBanner.classList.remove("widget-tablet");self.$.backgroundBanner.classList.remove("widget-desktop")}else if(576<=screenW&&767>screenW){self.$.backgroundBanner.classList.remove("widget-mobile");self.$.backgroundBanner.classList.add("widget-tablet");self.$.backgroundBanner.classList.remove("widget-desktop")}else{self.$.backgroundBanner.classList.remove("widget-mobile");self.$.backgroundBanner.classList.remove("widget-tablet");self.$.backgroundBanner.classList.add("widget-desktop")}}if(self.bannerId&&change){self.rmListener()}if(""==self.bannerId&&change){self.shadowRoot.querySelectorAll("#ul_slide li").forEach(function(x){try{x.querySelector("bannermatrix-banner").setAttribute("forceremove","true")}catch(err){}});self.shadowRoot.querySelectorAll(".splide__pagination").forEach(el=>el.remove());self.nowScreen=change;self.destroySlider();self.setSkeleton();self.resetWidget();self.startLoad()}else{if(0<screenW&&0<screenH){var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0;if("undefined"!==typeof eDt){var bg_color="";if(eDt.banner_data.length){bg_color=eDt.banner_data[0].background_color}if(""==bg_color&&self.slider_setting){bg_color=self.slider_setting.background_color}if(eDt.banner_data[0].banner_image&&eDt.banner_data[0].banner_image.video){self.setVideo(eDt.banner_data[0].banner_image.video)}else{self.setImage(eDt.banner_data[0].banner_image,screenW,screenH,!0)}if(eDt.web_data&&["7","8","9"].includes(eDt.web_data.type_id.toString())){try{var maxContentHeight=screenH-self.shadowRoot.querySelector(".cpHeader").offsetHeight-self.shadowRoot.querySelector(".cpFooter").offsetHeight;if("undefined"!==typeof self.height&&self.height){self.shadowRoot.querySelector(".cpContent").style.maxHeight=maxContentHeight+"px"}}catch(err){}}}else{if(self.shadowRoot.querySelectorAll("#ul_slide li.splide__slide").length){self.shadowRoot.querySelectorAll("#ul_slide li.splide__slide").forEach((item,i)=>{if(null==item.querySelector("bannermatrix-banner")){var arrImg=JSON.parse(item.getAttribute("data-bg-img-thumbnail"));if(arrImg&&arrImg.video){}else{var image=self.generateImage(arrImg,screenW,screenH);if(image&&"null"!=image&&null!=image){try{item.querySelector(".li_image").style.backgroundImage="url('"+image+"')"}catch(err){}}else if(self.slider_setting){image=self.generateImage(self.slider_setting,screenW,screenH);if(image&&"null"!=image&&null!=image){try{item.querySelector(".li_image").style.backgroundImage="url('"+image+"')"}catch(err){}}}var opa=1;try{if(item.getAttribute("data-bg-transperent")){opa=item.getAttribute("data-bg-transperent")/100}item.querySelector(".li_image").style.opacity=opa;item.style.background=item.getAttribute("data-bg-color")}catch(err){}}}})}}}if(""==self.bannerId){if(self.shadowRoot.querySelectorAll("#ul_slide li.splide__slide").length){self.shadowRoot.querySelectorAll("#ul_slide li.splide__slide").forEach((item,i)=>{var arrImg=JSON.parse(self.shadowRoot.querySelectorAll("#ul_slide li.splide__slide")[i].getAttribute("data-bg-img-thumbnail"));if(self.slider_layout_thumbnail){var image=self.generateImage(arrImg,screenW,screenH);if(image&&"null"!=image&&null!=image){self.shadowRoot.querySelectorAll("#ul_slide2 li.splide__slide")[i].querySelector("div").style.backgroundImage="url('"+image+"')"}else if(self.slider_setting){image=self.generateImage(self.slider_setting,screenW,screenH);if(image&&"null"!=image&&null!=image){self.shadowRoot.querySelectorAll("#ul_slide2 li.splide__slide")[i].querySelector("div").style.backgroundImage="url('"+image+"')"}}}})}}}},20)}messageReceive(e){var self=this;let data=e.data;if(data){let type=data.type,payload=data.payload;switch(type){case"BEFE:sliderRefresh":case"BMFE:sliderRefresh":self.reloadSlider();break;}}}rmListener(){var self=this;if("undefined"!==typeof self.resizeListener){window.removeEventListener("resize",self.resizeListener)}if("undefined"!==typeof self.messageListener){window.removeEventListener("message",self.messageListener)}if("undefined"!==typeof self.regMatchOddsListener){self.removeEventListener("topicListen:register",self.regMatchOddsListener)}if("undefined"!==typeof self.regScoresListener){self.removeEventListener("topicListen:register",self.regScoresListener)}if("undefined"!==typeof self.regPopularListener){self.removeEventListener("topicListen:register",self.regPopularListener)}if("undefined"!==typeof self.regCouponListener){self.removeEventListener("topicListen:register",self.regCouponListener)}if("undefined"!==typeof self.regCouponBBDListener){self.removeEventListener("topicListen:register",self.regCouponBBDListener)}if("undefined"!==typeof self.regRecMatchOddsListener){self.removeEventListener("topicListen:register",self.regRecMatchOddsListener)}if("undefined"!==typeof self.dumpMatchOddsListener){self.removeEventListener("topicListen:initialDump",self.dumpMatchOddsListener)}if("undefined"!==typeof self.dumpScoresListener){self.removeEventListener("topicListen:initialDump",self.dumpScoresListener)}if("undefined"!==typeof self.dumpPopularListener){self.removeEventListener("topicListen:initialDump",self.dumpPopularListener)}if("undefined"!==typeof self.dumpCouponListener){self.removeEventListener("topicListen:initialDump",self.dumpCouponListener)}if("undefined"!==typeof self.dumpCouponBBDListener){self.removeEventListener("topicListen:initialDump",self.dumpCouponBBDListener)}if("undefined"!==typeof self.dumpRecMatchOddsListener){self.removeEventListener("topicListen:initialDump",self.dumpRecMatchOddsListener)}if("undefined"!==typeof self.dumpTotalBetsListener){self.removeEventListener("topicListen:initialDump",self.dumpTotalBetsListener)}if("undefined"!==typeof self.dumpRecommendListener){self.removeEventListener("topicListen:initialDump",self.dumpRecommendListener)}if(self.ws_session){if("undefined"!==typeof self.subscribeOdds.id&&self.subscribeOdds.active){try{self.ws_session.unregister(self.subscribeOdds)}catch(err){self.subscribeOdds={}}}if("undefined"!==typeof self.subscribeScore.id&&self.subscribeScore.active){try{self.ws_session.unregister(self.subscribeScore)}catch(err){self.subscribeScore={}}}if("undefined"!==typeof self.subscribePopular.id&&self.subscribePopular.active){try{self.ws_session.unregister(self.subscribePopular)}catch(err){self.subscribePopular={}}}if("undefined"!==typeof self.subscribeCoupon.id&&self.subscribeCoupon.active){try{self.ws_session.unregister(self.subscribeCoupon)}catch(err){self.subscribeCoupon={}}}if("undefined"!==typeof self.subscribeCouponBBD.id&&self.subscribeCouponBBD.active){try{self.ws_session.unregister(self.subscribeCouponBBD)}catch(err){self.subscribeCouponBBD={}}}}}async callAjax(url="",type="GET",data={},headers={"Content-Type":"application/json"}){try{if(0==url.indexOf("http")){const response=await fetch(url,{method:type,mode:"cors",credentials:"same-origin",redirect:"follow",referrerPolicy:"no-referrer",headers:headers,body:"GET"==type?null:JSON.stringify(data)});return response.json()}else{return{successful:0}}}catch(err){return{successful:0}}}callOpenWs(){var self=this,nowTime=new Date,nextLoad=new Date(nowTime.getTime()+5e3),loadFirstws=!1;if("undefined"===typeof self.WEB_API_CACHE.autobahn_connect&&!self.fromIncludeWS){loadFirstws=!0;try{if("undefined"==typeof autobahn){return!1}var webApiConnection=new autobahn.Connection({url:self.webapiUrl,realm:self.webapiRealm,auto_reconnect:!1,reconnect_interval:0,max_retries:10});self.WEB_API_CACHE.autobahn_connect={min_next_load:nextLoad,cachedata:null};webApiConnection.onopen=function(session){self.ws_session=session;if(self.WEB_API_CACHE.autobahn_connect){self.WEB_API_CACHE.autobahn_connect.cachedata=session}};webApiConnection.onmessage=function(event){};webApiConnection.onclose=function(event){if("unreachable"==event){if(self.WEB_API_CACHE.autobahn_connect){self.WEB_API_CACHE.autobahn_connect.cachedata="unreachable"}}else if("lost"==event){delete self.ws_session;delete self.WEB_API_CACHE.autobahn_connect;setTimeout(function(){self.callOpenWs();self.resetWidget();self.startLoad()},1e3)}else{if(self.WEB_API_CACHE.autobahn_connect){self.WEB_API_CACHE.autobahn_connect.cachedata=null}}};webApiConnection.onerror=function(err){if(self.WEB_API_CACHE.autobahn_connect){self.WEB_API_CACHE.autobahn_connect.cachedata="error"}};webApiConnection.open()}catch(err){}}else{if(!loadFirstws){if("undefined"!==typeof self.WEB_API_CACHE.autobahn_connect){var i=0,wait=setInterval(function(){i++;if(self.WEB_API_CACHE.autobahn_connect){if(null==self.WEB_API_CACHE.autobahn_connect.cachedata){if(200<i){clearInterval(wait)}}else if("error"==self.WEB_API_CACHE.autobahn_connect.cachedata){self.WEB_API_CACHE.autobahn_connect.cachedata=null;clearInterval(wait)}else if("unreachable"==self.WEB_API_CACHE.autobahn_connect.cachedata){if(200<i){self.WEB_API_CACHE.autobahn_connect.cachedata=null;clearInterval(wait)}}else{self.ws_session=self.WEB_API_CACHE.autobahn_connect.cachedata;clearInterval(wait)}}else{if(200<i){clearInterval(wait)}}},300)}else if("undefined"===typeof self.WEB_API_CACHE.autobahn_connect&&!0==self.fromIncludeWS){self.fromIncludeWS=!1;self.callOpenWs()}}}}loadGoogleTagManager(){var self=this;if("undefined"===typeof self.WEB_API_CACHE.gtm_connect){self.WEB_API_CACHE.gtm_connect="loaded";var target=document.head||document.body,scriptTag=document.createElement("script"),inlineScript=document.createTextNode(`(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayerBanner','${self.googleTagManagerId}');`);scriptTag.appendChild(inlineScript);target.appendChild(scriptTag)}}loadAutobahn(){var self=this;if("undefined"!=self.webapiUrl&&self.webapiUrl&&"undefined"!=self.webapiRealm&&self.webapiRealm){if("undefined"===typeof autobahn){if("undefined"===typeof self.WEB_API_CACHE["autobahn.min.js"]){let myScript=document.createElement("script");myScript.setAttribute("src","https://bannermatrix.nwacdn.com/assets/widgets/assets/js/autobahn.min.js");let head=document.head;head.insertBefore(myScript,head.firstElementChild);self.WEB_API_CACHE["autobahn.min.js"]="loaded"}var i=0,wait=setInterval(function(){i++;if("undefined"!==typeof autobahn){clearInterval(wait);self.callOpenWs()}else{if(1e3<i){clearInterval(wait)}}},15)}else{self.callOpenWs()}}}loadOfferLib(){var self=this;if("offerlibrary"==self.apiMethod){if("undefined"===typeof OfferLib){if("undefined"===typeof self.WEB_API_CACHE["offerlib.bundle.js"]&&!self.fromInclude){let myScript=document.createElement("script");myScript.setAttribute("src","https://bannermatrix.nwacdn.com/assets/widgets/assets/js/offerlib0.0.3/bundle.js");let head=document.head;head.insertBefore(myScript,head.firstElementChild);self.WEB_API_CACHE["offerlib.bundle.js"]="loaded"}}}}showSkeleton(){var self=this;self.loaded=0;if(!self.demo&self.showLoading){if(self.isSliderBanner()){if("block"!=self.$.skeletonMain.style.display){if(self.haveEventCache){}else{self.$.skeletonMain.style.display="block"}}}}}hideSkeleton(){var self=this;self.loaded=1;self.$.skeletonMain.style.display="none"}removeDemo(){var self=this;if(self.demo){if(self.isSliderBanner()){if(null!=self.shadowRoot.getElementById("demotag")){self.shadowRoot.getElementById("demotag").remove()}}}}setDemo(position_tage,page_tag){var self=this;if(null!=self.shadowRoot.getElementById("demotag")){self.removeDemo()}try{self.$.slideSource.insertAdjacentHTML("afterend","<table id=\"demotag\"><tbody><tr><td style=\"text-align:center;\"><h3 style=\"margin-top: 0;\">Widget Info <span style=\"font-weight: normal;\">[demo: true]</span></h3><p style=\"margin: 0;\"><b>page_tag</b>: \""+page_tag+"\"</p> <p style=\"margin: 0;\"><b>position_tage</b>: \""+position_tage+"\"</p></td></tr></tbody></table>");if("undefined"!==typeof self.height&&self.height){self.shadowRoot.getElementById("demotag").style.height=self.height;self.$.skeletonMain.style.height=self.height;self.shadowRoot.getElementById("demotag").style.overflowY="auto"}}catch(err){setTimeout(function(){var textnode=document.createElement("table");textnode.id="demotag";textnode.innerHTML="<tbody><tr><td style=\"text-align:center;\"><h3 style=\"margin-top: 0;\">Widget Info <span style=\"font-weight: normal;\">[demo: true]</span></h3><p style=\"margin: 0;\"><b>page_tag</b>: \""+page_tag+"\"</p> <p style=\"margin: 0;\"><b>position_tage</b>: \""+position_tage+"\"</p></td></tr></tbody>";self.$.slideSource.after(textnode);if("undefined"!==typeof self.height&&self.height&&null!=self.shadowRoot.getElementById("demotag")){self.shadowRoot.getElementById("demotag").style.height=self.height;self.shadowRoot.getElementById("demotag").style.overflowY="auto"}},2e3)}}removeStream(click){var self=this;if(null!==self.shadowRoot.getElementById("streamtag")){self.$.slideSource.classList.remove("fadebanner");self.$.slideSource.classList.remove("d_desktop");self.$.slideSource.classList.remove("d_tablet");self.$.slideSource.classList.remove("d_mobile");self.shadowRoot.getElementById("streamtag").remove();self.sportbookIframe.contentWindow.postMessage({type:"OP:videoStreamingPause",payload:{pause:!1}},"*");if(click&&self.sportbook){self.sportbook.allowShow=!1}}}setStream(){var self=this;if(!self.floating_video){return!1}if(null!==self.shadowRoot.getElementById("streamtag")){return!1}if(!self.sportbook.allowShow){return!1}if(self.sportbook.stream.payload.streamUrl){var fullStreamUrl=self.sportbook.stream.payload.streamUrl;if(self.sportbook.stream.payload.requiresParent){fullStreamUrl=`${fullStreamUrl}&parent=${window.location.host}`;if(self.sportbook.stream.payload.baseUrl){fullStreamUrl=`${fullStreamUrl}&parent=${self.sportbook.stream.payload.baseUrl.hostname}`}else if(self.sportbook.stream.payload.parentHost){fullStreamUrl=`${fullStreamUrl}&parent=${self.sportbook.stream.payload.parentHost}`}}if("IFrame"===self.sportbook.stream.payload.renderType){try{self.$.bannerContentMain.insertAdjacentHTML("afterend",`<div id="streamtag"><div class="streamVideo"><iframe src=${fullStreamUrl} allow="autoplay"/></div></div>`)}catch(err){setTimeout(function(){var textnode=document.createElement("div");textnode.id="streamtag";textnode.innerHTML=`<div class="streamVideo"><iframe src=${fullStreamUrl} allow="autoplay"/></div>`;self.$.bannerContentMain.after(textnode)},2e3)}self.sportbookIframe.contentWindow.postMessage({type:"OP:videoStreamingPause",payload:{pause:!0}},"*")}self.$.slideSource.classList.add("fadebanner");self.$.slideSource.classList.add("d_desktop");self.$.slideSource.classList.add("d_tablet");self.$.slideSource.classList.add("d_mobile")}return!1}customStyleDone(data){var self=this;if("iframe"==self.bannerType){if(self.slider_setting&&self.slider_setting.iframe_banner&&self.eventId){var link=self.slider_setting.iframe_banner;link=link.replace("{eventId}",self.eventId);try{if(null===self.shadowRoot.getElementById("iframe")){self.$.bannerContentMain.insertAdjacentHTML("afterend",`<div id="iframe"><iframe src=${link} /></div>`)}}catch(err){}}}if(self.widget_position_id&&["1","2"].includes(self.widget_position_id.toString())){var tag=self.positionTag+"-"+self.pageTag,lsBlockPF=self.lsGet("bmfe:blockpopupForever","json");if("undefined"===typeof lsBlockPF.hash||lsBlockPF.hash!==data.data.close_forever_hash||"undefined"===typeof lsBlockPF.old_data||lsBlockPF.old_data.includes(tag)){var old_close=lsBlockPF.positions,rmIndex=old_close.indexOf(tag);if(-1!==rmIndex){old_close.splice(rmIndex,1)}self.lsSet("bmfe:blockpopupForever","{\"hash\":\""+self.slider_setting.close_forever_hash+"\", \"positions\":[], \"old_data\":"+JSON.stringify(old_close)+"}");self.style.display="block"}if("true"==self.loggedIn){}else{if(self.waitTCheckLoginP){clearTimeout(self.waitTCheckLoginP);self.waitTCheckLoginP={}}self.waitTCheckLoginP=setTimeout(function(){if("true"!=self.loggedIn){var lsBlockP=self.lsGet("bmfe:blockpopup","json");if("undefined"!==typeof lsBlockP.login&&lsBlockP.login.length){var iLogin=[],iLogout=lsBlockP.logout;iLogin=JSON.stringify(Array.from(new Set(iLogin)));iLogout=JSON.stringify(Array.from(new Set(iLogout)));self.lsSet("bmfe:blockpopup","{\"logout\":"+iLogout+", \"login\":"+iLogin+"}")}}},5e3)}}}customStyleCache(data){var self=this;if(data.successful){var dt=data.data;self.slider_setting=dt;self.slider_layout=dt.slider_layout;if("undefined"!==typeof dt.link&&"undefined"!==typeof dt.link[self.language]){self.root_auto_link=dt.link[self.language]}if("undefined"!==typeof dt.iconURL&&null!==dt.iconURL&&"null"!=dt.iconURL){self.FLAG_ENDPOINT=dt.iconURL;self.FLAG_EXT=".png";self.SPORT_ENDPOINT=dt.iconURL.replace("/flag/","/discipline/");self.SPORT_EXT=".svg"}if("undefined"!==typeof dt.icon&&null!==dt.icon&&"null"!=dt.icon&&dt.icon.flag&&dt.icon.discipline){let flag=dt.icon.flag.split("{{flag}}"),discipline=dt.icon.discipline.split("{{discipline}}");if(2==flag.length&&2==discipline.length){self.FLAG_ENDPOINT=flag[0];self.FLAG_EXT=flag[1];self.SPORT_ENDPOINT=discipline[0];self.SPORT_EXT=discipline[1]}}var screenW=window.innerWidth,screenH=window.innerHeight;if("undefined"!==typeof self.width&&self.width){screenW=self.width.replace("px","")}if("undefined"!==typeof self.height&&self.height){screenH=self.height.replace("px","")}if(self.slider_setting.background_image_loader){self.use_skeleton_img="true";self.default_skeleton=self.generateImage(self.slider_setting,screenW,screenH)}else{self.use_skeleton_img="false";self.default_skeleton=""}if(dt.slider_layout_arrow){self.slider_layout_arrow=dt.slider_layout_arrow;self.shadowRoot.querySelector(".splide__arrows").style.display="block"}else{self.shadowRoot.querySelector(".splide__arrows").style.display="none"}if(dt.slider_layout_thumbnail){self.slider_layout_thumbnail=dt.slider_layout_thumbnail}self.slider_time=dt.duration;self.$.custom_style.innerHTML="<style>"+dt.custom_css+"</style>";self.widget_position_id=self.positions(dt.position_type);self.disableCrop=self.slider_setting.disable_crop_background&&4!=self.widget_position_id?"disable_crop_background":"";if(dt.banner_layout){self.widget_layout=dt.banner_layout.toString();if(self.bannerId){var cacheName=self.genCacheName(self.tid,self.bannerId,self.eid,self.language),eCache=self.getEventLs(cacheName);if(eCache&&"undefined"!==typeof eCache.widget_layout&&eCache.widget_layout){self.widget_layout=eCache.widget_layout.toString()}}}if(self.bannerId){if("true"==self.getAttribute("has-bullet")){self.xClass1="has_bullet"}if("true"==self.getAttribute("auto-height")){self.xClass2="height-auto"}}if("streaming"==self.bannerType){if(dt.floating_video){self.floating_video=!0}else{self.floating_video=!1}}self.customStyleDone(data)}}customStyleSetLS(data){var self=this;if(data.successful){var dt=data.data,lsConfig=self.lsGet("bmfe:config","json");if(lsConfig){if("undefined"===typeof lsConfig.cache_local_data){lsConfig.cache_local_data=dt.cache}if("undefined"===typeof lsConfig.operatorId){lsConfig.operatorId=self.operatorId}if("undefined"===typeof lsConfig.positions){lsConfig.positions={}}if("undefined"===typeof lsConfig.ga){lsConfig.ga={}}if(lsConfig.operatorId!=self.operatorId||lsConfig.cache_local_data!=dt.cache&&lsConfig.cache_local_data<dt.cache){self.lsRemoveAll();lsConfig.cache_local_data=dt.cache;lsConfig.operatorId=self.operatorId;lsConfig.positions={};lsConfig.ga={};if(dt.extra_config&&dt.extra_config.ga){lsConfig.ga={key:dt.extra_config.ga?dt.extra_config.ga:"",consent:dt.extra_config.consent?!0:!1}}self.lsSet("bmfe:config",JSON.stringify(lsConfig));if(lsConfig.operatorId!=self.operatorId){var lsParam=self.positionTag+"-"+self.pageTag+"-"+self.loggedIn+"-"+self.eventId.toString();self.lsSet("bmfe:"+self.language+"-"+lsParam,"{}")}else if(lsConfig.cache_local_data!=dt.cache&&lsConfig.cache_local_data<dt.cache){self.startLoad()}}else{if("undefined"===typeof lsConfig.positions[self.positionTag]){lsConfig.positions[self.positionTag]={}}let styleCache=lsConfig.positions[self.positionTag].data;if(styleCache&&styleCache.last_update&&dt.last_update){if(styleCache.last_update<dt.last_update){lsConfig.positions[self.positionTag]=data}}else{lsConfig.positions[self.positionTag]=data}if("undefined"!==typeof styleCache&&"undefined"!==typeof styleCache.banner_layout&&styleCache.banner_layout!=dt.banner_layout){lsConfig.positions[self.positionTag].data.banner_layout=styleCache.banner_layout}self.lsSet("bmfe:config",JSON.stringify(lsConfig))}}}}customStyleSetLayoutLS(banner_layout){var self=this;if(banner_layout){var lsConfig=self.lsGet("bmfe:config","json");if(lsConfig){if("undefined"!==typeof lsConfig.positions&&"undefined"!==typeof lsConfig.positions[self.positionTag]&&!self.fromInclude){lsConfig.positions[self.positionTag].data.banner_layout=banner_layout;self.lsSet("bmfe:config",JSON.stringify(lsConfig))}}}}saveTags(tags){var self=this;if(tags&&"undefined"===typeof self.WEB_API_CACHE.checkPosition){self.WEB_API_CACHE.checkPosition=!0;tags.last_update=dayjs();self.lsSet("bmfe:tags",JSON.stringify(tags))}}customStyleCall(apiParam,url){var self=this,newR=!0,lsConfig=self.lsGet("bmfe:config","json");if("undefined"===typeof lsConfig.cache_local_data){lsConfig.cache_local_data=""}if("undefined"===typeof lsConfig.operatorId){lsConfig.operatorId=""}if("undefined"===typeof lsConfig.positions){lsConfig.positions={}}if("undefined"===typeof lsConfig.ga){lsConfig.ga={}}if("undefined"===typeof lsConfig.positions[self.positionTag]||"undefined"===typeof lsConfig.positions[self.positionTag].successful){lsConfig.positions[self.positionTag]={};self.lsSet("bmfe:config",JSON.stringify(lsConfig))}else{newR=!1;let styleCache=lsConfig.positions[self.positionTag];self.customStyleSetLS(styleCache);self.customStyleCache(styleCache)}try{self.callAjax(url,"GET",{}).then(res=>{self.WEB_API_CACHE[apiParam].cachedata=res;self.customStyleSetLS(res);if(newR){self.customStyleCache(res)}self.saveTags(res.data.tags)}).catch(err=>{})}catch(err){}}checkTags(){var self=this;if(self.isSpecialBanner()){return!0}var lsTags=self.lsGet("bmfe:tags","json");if("undefined"!==typeof lsTags.last_update&&(dayjs().isAfter(dayjs(lsTags.last_update).add(1,"day"))||lsTags.position.includes(self.positionTag)&&lsTags.page.includes(self.pageTag))){return!0}else if("undefined"===typeof lsTags.last_update){return!0}return!1}customStyle(){var self=this;if(self.operatorId&&self.positionTag&&self.checkTags()){var apiParam="/settings/widget/"+self.operatorId+"/"+self.positionTag,nowTime=new Date,nextLoad=new Date(nowTime.getTime()+5e3),load=!1;if("undefined"===typeof self.WEB_API_CACHE[apiParam]){self.WEB_API_CACHE[apiParam]={min_next_load:nextLoad,cachedata:{}};load=!0;self.customStyleCall(apiParam,self.WEB_API+apiParam)}if(nowTime>self.WEB_API_CACHE[apiParam].min_next_load){self.WEB_API_CACHE[apiParam].min_next_load=nextLoad;if("undefined"!=typeof self.WEB_API_CACHE[apiParam].cachedata.successful){self.customStyleCache(self.WEB_API_CACHE[apiParam].cachedata)}else{self.customStyleCall(apiParam,self.WEB_API+apiParam)}}else if(!load&&"undefined"!=typeof self.WEB_API_CACHE[apiParam].cachedata.successful){self.customStyleCache(self.WEB_API_CACHE[apiParam].cachedata)}else{if(!load){var lsConfig=self.lsGet("bmfe:config","json");if("undefined"===typeof lsConfig.positions){lsConfig.positions={}}if("undefined"!==typeof lsConfig.positions[self.positionTag]&&"undefined"!==typeof lsConfig.positions[self.positionTag].successful){self.customStyleCache(lsConfig.positions[self.positionTag])}else{var i=0,wait=setInterval(function(){i++;if("undefined"===typeof self.WEB_API_CACHE[apiParam].cachedata.successful){if(1e3<i){clearInterval(wait)}}else{self.customStyleCache(self.WEB_API_CACHE[apiParam].cachedata);clearInterval(wait)}},50)}}}}}filterEventPart(type,data,sportId){var self=this,newdata={score_set:[],score_current:[],score_whole:[],score_quarter:[]},eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0;if("undefined"===typeof eDt||"undefined"==typeof sportId){if("true"!=self.incident_tournament){return!1}}if("undefined"!==typeof eDt){if("1"==sportId){data.forEach((item,i)=>{if("1stHalfOrdinaryTime"==item.eventPartKey){newdata.score_set[1]=item}else if(self._wholeMatch(item.eventPartKey,newdata.score_whole[0])){newdata.score_whole[0]=item;if(null==self.last_score){self.last_score=JSON.stringify({awayScore:item.awayScore,homeScore:item.homeScore})}else{if(self.last_score!=JSON.stringify({awayScore:item.awayScore,homeScore:item.homeScore})){var oldscore=JSON.parse(self.last_score);if(null!=oldscore){if(item.homeScore!=oldscore.homeScore){self.marketIncident("home","1")}else{self.marketIncident("away","1")}}self.last_score=JSON.stringify({awayScore:item.awayScore,homeScore:item.homeScore})}}}})}else if(["3","128","141"].includes(sportId.toString())||["14","20","63","64","133"].includes(sportId.toString())){data.forEach((item,i)=>{if(-1!=item.id){if("1stSet"==item.eventPartKey){newdata.score_set[1]=item}else if("2ndSet"==item.eventPartKey){newdata.score_set[2]=item}else if("3rdSet"==item.eventPartKey){newdata.score_set[3]=item}else if("4thSet"==item.eventPartKey){newdata.score_set[4]=item}else if("5thSet"==item.eventPartKey){newdata.score_set[5]=item}else if(self._wholeMatch(item.eventPartKey,newdata.score_whole[0])){newdata.score_whole[0]=item}}if(["3","128","141"].includes(sportId.toString())&&!0==item.currentEventPart){if(50==item.awayScore){item.awayScore="A"}else if(50==item.homeScore){item.homeScore="A"}newdata.score_current[0]=item}})}else if("5"==sportId){data.forEach((item,i)=>{if("1stQuarter"==item.eventPartKey){newdata.score_set[1]=item}else if("2ndQuarter"==item.eventPartKey){newdata.score_set[2]=item}else if("3rdQuarter"==item.eventPartKey){newdata.score_set[3]=item}else if("4thQuarter"==item.eventPartKey){newdata.score_set[4]=item}else if(self._wholeMatch(item.eventPartKey,newdata.score_whole[0])){newdata.score_whole[0]=item}})}else if(["6","129"].includes(sportId.toString())){data.forEach((item,i)=>{if(-1!=item.id){if("1stPeriod"==item.eventPartKey){newdata.score_set[1]=item}else if("2ndPeriod"==item.eventPartKey){newdata.score_set[2]=item}else if("3rdPeriod"==item.eventPartKey){newdata.score_set[3]=item}else if("4thPeriod"==item.eventPartKey){newdata.score_set[4]=item}else if("5thPeriod"==item.eventPartKey){newdata.score_set[5]=item}else if(self._wholeMatch(item.eventPartKey,newdata.score_whole[0])){newdata.score_whole[0]=item}}})}else if(["7","28","39","155"].includes(sportId.toString())){data.forEach((item,i)=>{if(-1!=item.id){if("1stHalfOrdinaryTime"==item.eventPartKey){newdata.score_set[1]=item}else if("2ndHalfOrdinaryTime"==item.eventPartKey){newdata.score_set[2]=item}else if(self._wholeMatch(item.eventPartKey,newdata.score_whole[0])){newdata.score_whole[0]=item}}})}else if(["8","106"].includes(sportId.toString())){data.forEach((item,i)=>{if(-1!=item.id){if("1stQuarter"==item.eventPartKey){newdata.score_set[1]=item}else if("2ndQuarter"==item.eventPartKey){newdata.score_set[2]=item}else if("3rdQuarter"==item.eventPartKey){newdata.score_set[3]=item}else if("4thQuarter"==item.eventPartKey){newdata.score_set[4]=item}else if(self._wholeMatch(item.eventPartKey,newdata.score_whole[0])){newdata.score_whole[0]=item}}})}else if("9"==sportId){data.forEach((item,i)=>{if(-1!=item.id){if("1stInning"==item.eventPartKey){newdata.score_set[1]=item}else if("2ndInning"==item.eventPartKey){newdata.score_set[1]=item}else if("3rdInning"==item.eventPartKey){newdata.score_set[1]=item}else if("4thInning"==item.eventPartKey){newdata.score_set[1]=item}else if("5thInning"==item.eventPartKey){newdata.score_set[1]=item}else if("6thInning"==item.eventPartKey){newdata.score_set[1]=item}else if("7thInning"==item.eventPartKey){newdata.score_set[1]=item}else if("8thInning"==item.eventPartKey){newdata.score_set[1]=item}else if("9thInning"==item.eventPartKey){newdata.score_set[1]=item}else if(self._wholeMatch(item.eventPartKey,newdata.score_whole[0])){newdata.score_whole[0]=item}}})}else if("10"==sportId){data.forEach((item,i)=>{if(1361==item.eventPartId){newdata.score_set[1]=item}else if(1363==item.eventPartId){newdata.score_set[2]=item}else if(1364==item.eventPartId){newdata.score_set[3]=item}else if(1366==item.eventPartId){newdata.score_set[4]=item}else if(eDt.sport_data.currentEventPartId==item.eventPartId){newdata.score_current[0]=item}else if("90"==item.eventPartId){newdata.score_whole[0]=item}})}else if(["22","36","45","76","105","134"].includes(sportId.toString())){data.forEach((item,i)=>{if(-1!=item.id){if(self._wholeMatch(item.eventPartKey,newdata.score_whole[0])){newdata.score_whole[0]=item}}})}else if(["26","98","99","100"].includes(sportId.toString())){data.forEach((item,i)=>{if(self._wholeMatch(item.eventPartKey,newdata.score_whole[0])){newdata.score_whole[0]=item}})}else if("38"==sportId){data.forEach((item,i)=>{if(355==item.eventPartId){newdata.score_set[1]=item}else if(356==item.eventPartId){newdata.score_set[2]=item}else if(357==item.eventPartId){newdata.score_set[3]=item}else if(358==item.eventPartId){newdata.score_set[4]=item}else if("350"==item.eventPartId){newdata.score_whole[0]=item}})}else if("49"==sportId){data.forEach((item,i)=>{if(-1!=item.id){if("1stHalfOrdinaryTime"==item.eventPartKey){newdata.score_set[1]=item}else if(self._wholeMatch(item.eventPartKey,newdata.score_whole[0])){newdata.score_whole[0]=item}}})}else if("110"==sportId){data.forEach((item,i)=>{if("1511"==item.eventPartId){newdata.score_whole[0]=item}})}else if("121"==sportId){data.forEach((item,i)=>{if("1stHalfOrdinaryTime"==item.eventPartKey){newdata.score_set[1]=item}else if(self._wholeMatch(item.eventPartKey,newdata.score_whole[0])){newdata.score_whole[0]=item}})}else if("140"==sportId){data.forEach((item,i)=>{if("2477"==item.eventPartId){newdata.score_set[1]=item}else if("2479"==item.eventPartId){newdata.score_set[2]=item}else if("2475"==item.eventPartId){newdata.score_whole[0]=item}})}}self.set("eventScoreDetails",newdata);return newdata}removeSession(){var self=this,cache="/"+self.language+"/banners/list/"+self.operatorId+"/"+self.language+"/"+self.positionTag+"/"+self.pageTag+"/"+self.loggedIn+"/"+self.eventId.toString();if("undefined"!==typeof self.WEB_API_CACHE[cache]){delete self.WEB_API_CACHE[cache]}self.WEB_API_CACHE.rememberClick=[]}removeAccents(value){var self=this;if(value&&self.slider_setting&&self.slider_setting.extra_config&&self.slider_setting.extra_config.separator&&","==self.slider_setting.extra_config.separator){const a="\xE0\xE1\xE2\xE4\xE6\xE3\xE5\u0101\u0103\u0105\xE7\u0107\u010D\u0111\u010F\xE8\xE9\xEA\xEB\u0113\u0117\u0119\u011B\u011F\u01F5\u1E27\xEE\xEF\xED\u012B\u012F\xEC\u0131\u0130\u0142\u1E3F\xF1\u0144\u01F9\u0148\xF4\xF6\xF2\xF3\u0153\xF8\u014D\xF5\u0151\u1E55\u0155\u0159\xDF\u015B\u0161\u015F\u0219\u0165\u021B\xFB\xFC\xF9\xFA\u016B\u01D8\u016F\u0171\u0173\u1E83\u1E8D\xFF\xFD\u017E\u017A\u017C",b="aaaaaaaaaacccddeeeeeeeegghiiiiiiiilmnnnnoooooooooprrsssssttuuuuuuuuuwxyyzzz",p=new RegExp(a.split("").join("|"),"g");return value.toString().toLowerCase().replace(p,c=>b.charAt(a.indexOf(c)))}return value}checkSliderChangeCache(data){var self=this,lsParam=self.positionTag+"-"+self.pageTag+"-"+self.loggedIn+"-"+self.eventId.toString();if(data.successful){try{var lsSliderChange=self.lsGet("bmfe:"+self.language+"-"+lsParam);if(lsSliderChange){lsSliderChange=JSON.parse(lsSliderChange);var lastUpdate="undefined"!==typeof lsSliderChange.maindata?lsSliderChange.maindata.last_update:"";if(data.hash!=lsSliderChange.hash&&!self.waitCTimeout&&("undefined"===typeof lastUpdate||lastUpdate&&dayjs(data.last_update).isAfter(dayjs(lastUpdate)))){self.disableApiCallback=!1;self.resetWidget();self.lsDelete("bmfe:"+self.language+"-"+lsParam);self.showLoading=!0;self.arrEvent=[];self.showSkeleton();self.shadowRoot.querySelectorAll(".splide__pagination").forEach(el=>el.remove());self.removeSession();self.lsSet("bmfe:events","{}");self.set("text.status_id","");self.startLoad()}else{self.checkSliderChange()}}else{if(data.data.length){self.widget.content_arr=[];self.widget.content_data=[];self.resetWidget();self.removeSession();self.startLoad()}else{self.checkSliderChange()}}}catch(err){self.lsSet("bmfe:"+self.language+"-"+lsParam,"{}");self.showLoading=!0;self.showSkeleton();self.resetWidget();self.startLoad()}}}checkSliderChangeCall(apiParam,url,method){var self=this;self.callAjax(url,method,{}).then(res=>{if(res.successful){self.WEB_API_CACHE[apiParam].cachedata=res;self.checkSliderChangeCache(res)}else{setTimeout(function(){self.checkSliderChange()},1e3)}}).catch(err=>{setTimeout(function(){self.checkSliderChange()},1e3)})}checkSliderChange(){var self=this;if(self.bannerId&&self.fromInclude||self.slider_setting&&!self.slider_setting.slider_auto_refresh&&(0==self.widget_position_id&&""==self.bannerId||self.widget_position_id&&!["1","2"].includes(self.widget_position_id.toString()))){return!1}var countdownset=self.interval_main_time;if(5e3>countdownset){countdownset=5e3}if(self.waitTSliderCheck){clearTimeout(self.waitTSliderCheck);self.waitTSliderCheck={}}if(self.widget_position_id&&["1","2"].includes(self.widget_position_id.toString())){var unblock=!1,newBlockPL=[],lsBlockPL=self.lsGet("bmfe:blockpopupLimit","json");(async()=>{await Promise.all([lsBlockPL.forEach((item,i)=>{if(dayjs(dayjs()).isBefore(item.expireDate)){newBlockPL.push(item)}else{unblock=!0}})]).then(pData=>{if(unblock){self.lsSet("bmfe:blockpopupLimit",JSON.stringify(newBlockPL));self.resetWidget();var lsParam=self.positionTag+"-"+self.pageTag+"-"+self.loggedIn+"-"+self.eventId.toString();self.lsDelete("bmfe:"+self.language+"-"+lsParam);self.removeSession();self.startLoad()}})})()}self.waitTSliderCheck=setTimeout(function(){var paramLogin=self.loggedIn.toString();if("true"!=paramLogin){paramLogin="false"}var ajax1={method:"GET",url:"/banners/list/"+self.operatorId+"/"+self.language+"/"+self.positionTag+"/"+self.pageTag+"/"+paramLogin+"/"+self.eventId.toString()},apiParam="/"+self.language+ajax1.url,nowTime=new Date,nextLoad=new Date(nowTime.getTime()+5e3),loadFirst=!1;if("undefined"==typeof self.WEB_API_CACHE[apiParam]){self.WEB_API_CACHE[apiParam]={min_next_load:nextLoad,cachedata:{}};loadFirst=!0;self.checkSliderChangeCall(apiParam,self.WEB_API+ajax1.url,ajax1.method)}if(nowTime>self.WEB_API_CACHE[apiParam].min_next_load){self.WEB_API_CACHE[apiParam].min_next_load=nextLoad;self.WEB_API_CACHE[apiParam].cachedata={};self.checkSliderChangeCall(apiParam,self.WEB_API+ajax1.url,ajax1.method)}else{if(!loadFirst){var wait=setInterval(function(){if("undefined"!=typeof self.WEB_API_CACHE[apiParam]&&"undefined"!=typeof self.WEB_API_CACHE[apiParam].cachedata&&"undefined"==typeof self.WEB_API_CACHE[apiParam].cachedata.successful){}else if("undefined"==typeof self.WEB_API_CACHE[apiParam]||"undefined"==typeof self.WEB_API_CACHE[apiParam].cachedata){self.startLoad();clearInterval(wait)}else{self.checkSliderChangeCache(self.WEB_API_CACHE[apiParam].cachedata);clearInterval(wait)}},300)}}},countdownset)}bannerIdClick(bannerId,btnText){var self=this;if(null!=self.shadowRoot.querySelector("."+bannerId)&&(""==btnText||self.linkBoth())){self.shadowRoot.querySelector("."+bannerId).click()}else if("3"===self.tid&&"popupClick"===bannerId&&self.linkBoth()&&self.shadowRoot.querySelector("button.btLink")){self.shadowRoot.querySelector("button.btLink").click()}}bannerClick(event,bannerId){var self=this,eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0;if("undefined"!==typeof eDt&&null!=self.shadowRoot.querySelector(".btLink")&&"oddButton"!=event.target.className&&"oddButtonName"!=event.target.className&&"oddButtonValue"!=event.target.className&"odv"!=event.target.className&&!event.target.className.includes("bgButton2")&&(self.$.buttondetail.innerHTML&&(3!=eDt.web_data.type_id||"true"==self.incident_tournament||self.$.backgroundBanner.classList.contains("widget-mobile-xs")||self.$.buttondetail.innerHTML.includes("no_link_btn"))||event.target.className.includes("buttonNav"))){if("undefined"==typeof bannerId||"undefined"!=typeof bannerId&&null!=self.shadowRoot.querySelector(".btLink"+bannerId)){self.shadowRoot.querySelector(".btLink").click()}}else if(null!=event.target.querySelector(".no_link_btn")&&0==self.widget_position_id){event.target.querySelector(".no_link_btn > button").click()}else if(self.$.bannerContentMain.classList.contains("cacheLinkBanner")&&null!=self.shadowRoot.querySelector(".btLink"+self.bannerId)){self.shadowRoot.querySelector(".btLink"+self.bannerId).click()}else if("undefined"==typeof bannerId&&self.linkBoth()&&event.target.querySelector("button.btLink")){event.target.querySelector("button.btLink").click()}}sliderPadding(num){if(0==num%1){return"0%"}else{var newnum=100-100/num*Math.floor(num);return newnum+"%"}}renderRecommend(index,bannerId,marketIds){var self=this,milliseconds=new Date().getTime(),marketId=marketIds[index],match=self.listPopular.match[0],marketV="undefined"!==typeof self.listPopular.market[marketId]?self.listPopular.market[marketId]:"",market="undefined"!==typeof self.listPopular.marketId[marketId]?self.listPopular.marketId[marketId]:"",available=0,dataMarket={};if(marketV&&market){dataMarket={...marketV,bettingTypeId:market.bettingTypeId,bettingTypeName:market.bettingTypeName,eventId:market.eventId,eventPartId:market.eventPartId,eventPartName:market.eventPartName,name:market.name};available=dataMarket.selections.filter(function(item){return!0===item.available}).length}if("undefined"!==typeof marketIds[index]&&"3"!=match.statusId&&available){self.set("text.countryId",match.venueId);self.set("text.countryName",match.venueName);self.set("text.event_id",match.id);self.set("text.event_name",match.name);self.set("text.time",self.getDateFormat(match.startTime));self.set("text.homeName",match.homeParticipantName);self.set("text.awayName",match.awayParticipantName);self.set("text.sportId",match.sportId);self.set("text.sportName",match.sportName);self.set("text.status_id",match.statusId);self.set("text.status",match.statusName);self.set("text.marketname",self.getText(market.name));self.set("text.labelName","");self.set("text.labelStyle","");self.set("text.partName",market.eventPartName);self.set("text.tournamentId",match.parentId);if("undefined"!==typeof match.shortParentName){self.set("text.tournamentName",match.shortParentName)}else if("undefined"!==typeof match.parentName){self.set("text.tournamentName",match.parentName)}self.firstRender(milliseconds,[],"",marketId,dataMarket);self.hideSkeleton();self.$.slideSource.classList.add("fadebanner")}else if(marketIds.length-1>index){self.renderRecommend(index+1,bannerId,marketIds)}else{var cacheName=self.genCacheName(4,bannerId,match.id,self.language);self.disableRmR("",bannerId,cacheName)}}loadRecommendEvent(index,bannerId,data){var self=this;if(data&&"undefined"!==typeof data.recommendations_list[index]){var rDt=data.recommendations_list[index],eventId=rDt.eventId,cacheName=self.genCacheName(4,bannerId,eventId,self.language);if(eventId&&rDt.BetsRecommendationsList.length){var topic="/sports/"+self.operatorId+"/"+self.language+"/"+eventId+"/match-odds",betTypeEventParts=[];(async()=>{await Promise.all([rDt.BetsRecommendationsList.forEach((item,i)=>{if(item.bettingTypeId&&item.eventPartId){var key=item.bettingTypeId.toString()+"-"+item.eventPartId.toString();if(!betTypeEventParts.includes(key)){betTypeEventParts.push(key)}}})]).then(pData=>{if(betTypeEventParts.length){topic="/sports/"+self.operatorId+"/"+self.language+"/"+eventId+"/match-odds/"+betTypeEventParts.join(",")}var tmpTopic="/recommendation"+topic,isClone=self.parentNode.classList.contains("splide__slide--clone")&&self.fromInclude;if(isClone){if("undefined"!==typeof self.WEB_API_CACHE[tmpTopic]&&"undefined"!==typeof self.WEB_API_CACHE[tmpTopic].records){self.recMatchOddsRes(index,bannerId,data,{kwargs:self.WEB_API_CACHE[tmpTopic]})}else{if("undefined"!==typeof self.dumpRecMatchOddsListener){self.removeEventListener("topicListen:initialDump",self.dumpRecMatchOddsListener)}self.dumpRecMatchOddsListener=self.dumpRecMatchOdds.bind(self,tmpTopic,index,bannerId,data);self.addEventListener("topicListen:initialDump",self.dumpRecMatchOddsListener)}if("undefined"!==typeof self.regRecMatchOddsListener){self.removeEventListener("topicListen:register",self.regRecMatchOddsListener)}self.regRecMatchOddsListener=self.regRecMatchOdds.bind(self,tmpTopic);self.addEventListener("topicListen:register",self.regRecMatchOddsListener)}else{self.ws_session.register(topic,function(args,kwargs,details){self.wsChange(kwargs);self.customEventTopic("topic:register",tmpTopic,kwargs)}).then(function(regId){self.subscribeRecommend=regId;self.ws_session.call("/sports#initialDump",[],{topic:topic}).then(function(res){self.recMatchOddsRes(index,bannerId,data,res);self.customEventTopic("topic:initialDump",tmpTopic,res.kwargs)})})}})})()}else if(data.recommendations_list.length-1>index){self.loadRecommendEvent(index+1,bannerId,data)}else{self.disableRmR("",bannerId,cacheName)}}}regRecMatchOdds(topic,dataE){var self=this;if(dataE.detail&&dataE.detail.topic==topic){self.wsChange(dataE.detail.kwargs)}}dumpRecMatchOdds(topic,index,bannerId,data,dataE){var self=this;if(dataE.detail&&dataE.detail.topic==topic){self.recMatchOddsRes(index,bannerId,data,{kwargs:dataE.detail.kwargs})}}recMatchOddsRes(index,bannerId,data,res){var self=this;if(data&&"undefined"!==typeof data.recommendations_list[index]&&res&&res.kwargs){var rDt=data.recommendations_list[index],eventId=rDt.eventId,cacheName=self.genCacheName(4,bannerId,eventId,self.language);if(eventId&&rDt.BetsRecommendationsList.length){var marketIds=rDt.BetsRecommendationsList.map(item=>item.marketId.toString());if(res.kwargs.records.length){self.resetListPopular();var found=0;(async()=>{await Promise.all([res.kwargs.records.forEach((item,i)=>{self.genListPopular(item);if("MARKET"==item._type){if(marketIds.includes(item.id)){found++}}})]).then(pData=>{if(found){(async()=>{await Promise.all([self.listPopular.match.forEach((item2,i2)=>{self.listPopular.markets[item2.id].forEach((item3,i3)=>{var selections=self.listPopular.market[item3.id].selections;if(selections.length){selections=selections.sort((a,b)=>a.orderOutcome-b.orderOutcome);self.listPopular.markets[item2.id][i3].selections=selections}})})]).then(pData1=>{self.renderRecommend(0,bannerId,marketIds)})})()}else if(data.recommendations_list.length-1>index){if("undefined"!==typeof self.subscribeRecommend.id&&self.subscribeRecommend.active){try{self.ws_session.unregister(self.subscribeRecommend)}catch(err){self.subscribeRecommend={}}}self.loadRecommendEvent(index+1,bannerId,data)}else{self.disableRmR("",bannerId,cacheName)}})})()}else if(data.recommendations_list.length-1>index){if("undefined"!==typeof self.subscribeRecommend.id&&self.subscribeRecommend.active){try{self.ws_session.unregister(self.subscribeRecommend)}catch(err){self.subscribeRecommend={}}}self.loadRecommendEvent(index+1,bannerId,data)}else{self.disableRmR("",bannerId,cacheName)}}}}callRecommend(bannerId){var self=this;if(self.operatorId&&self.emUserId){var cache=null,lsConfig=self.lsGet("bmfe:config","json"),terminal_type=767<=window.innerWidth?"1":"2";if(lsConfig){if("undefined"===typeof lsConfig.recommendations){lsConfig.recommendations={}}if(lsConfig.recommendations.result&&lsConfig.recommendations.data.user_id==self.emUserId&&lsConfig.recommendations.data.terminal_type==terminal_type){if(dayjs(dayjs()).isBefore(lsConfig.recommendations.expireDate)){cache=lsConfig.recommendations.data}}}if(cache){self.loadRecommendEvent(0,bannerId,cache)}else{var topic="/banners/recommendations/"+self.operatorId+"/"+self.emUserId+"/false/"+terminal_type,isClone=self.parentNode.classList.contains("splide__slide--clone")&&self.fromInclude,cacheName=self.genCacheName(4,bannerId,0,self.language);if(isClone){if("undefined"!==typeof self.WEB_API_CACHE[topic]&&"undefined"!==typeof self.WEB_API_CACHE[topic].result){self.recommendRes(cacheName,bannerId,lsConfig,self.WEB_API_CACHE[topic])}else{if("undefined"!==typeof self.dumpRecommendListener){self.removeEventListener("topicListen:initialDump",self.dumpRecommendListener)}self.dumpRecommendListener=self.dumpRecommend.bind(self,topic,cacheName,bannerId,lsConfig);self.addEventListener("topicListen:initialDump",self.dumpRecommendListener)}}else{try{self.callAjax(self.WEB_API+"/banners/recommendations/"+self.operatorId+"/"+self.emUserId+"/false/"+terminal_type,"GET",{},{"Content-Type":"application/json",Authorization:self.emUserSession}).then(res=>{self.recommendRes(cacheName,bannerId,lsConfig,res);self.customEventTopic("topic:initialDump",topic,res)})}catch(err){}}}}}dumpRecommend(topic,cacheName,bannerId,lsConfig,dataE){var self=this;if(dataE.detail&&dataE.detail.topic==topic){self.recommendRes(cacheName,bannerId,lsConfig,dataE.detail.kwargs)}}recommendRes(cacheName,bannerId,lsConfig,res){var self=this;if(res&&"success"==res.result&&"undefined"!==typeof res.data.recommendations_list&&res.data.recommendations_list&&res.data.recommendations_list.length){res.expireDate=dayjs().add(2,"minute").toLocaleString("en-US");lsConfig.recommendations=res;self.lsSet("bmfe:config",JSON.stringify(lsConfig));self.loadRecommendEvent(0,bannerId,res.data)}else{self.disableRmR("",bannerId,cacheName)}}showSlides(){var self=this;if("undefined"===typeof self.widget.content_arr||self.widget.content_arr.length!=self.widget.content_data.length||0==self.slider_layout||("undefined"===typeof self.webapiUrl||""==self.webapiUrl||"undefined"===typeof self.webapiRealm||""==self.webapiRealm)&&"offerlibrary"!=self.apiMethod){if(self.waitTNoSlide1){clearTimeout(self.waitTNoSlide1);self.waitTNoSlide1={}}self.waitTNoSlide1=setTimeout(function(){self.showSlides()},100);return!1}var device=self.widget.device;if(device.desktop){self.$.type_slider.classList.add("d_desktop")}if(device.tablet){self.$.type_slider.classList.add("d_tablet")}if(device.mobile){self.$.type_slider.classList.add("d_mobile")}if("undefined"!==typeof self.width&&self.width){self.$.type_slider.style.width=self.width}(async()=>{var count_draw=0,data_1="",data_2="",enable_loop=!0,type_list=[];await Promise.all([self.widget.content_arr.forEach((item,i)=>{var type=8==item.type_id||9==item.type_id?7:item.type_id;if(!type_list.includes(type)){type_list.push(type)}if("undefined"===typeof self.widget.content_data[i]){}else{count_draw++}})]).then(pData=>{if(1==type_list.length&&["7"].includes(type_list[0].toString())){self.autoHeight=!0}if(count_draw!=self.widget.content_arr.length){if(self.waitTNoSlide2){clearTimeout(self.waitTNoSlide2);self.waitTNoSlide2={}}self.waitTNoSlide2=setTimeout(function(){self.showSlides()},100)}else{(async()=>{await Promise.all([self.widget.content_data.forEach((item,i)=>{var imageBgs="",contentArray=Object.values(item.banner_translate),lang_show="en",content=item.banner_translate,content_lang={};if("undefined"===typeof content[self.language]&&"undefined"===typeof content[lang_show]){content_lang=contentArray[0]}else{if("undefined"!==typeof content[self.language]){content_lang=content[self.language]}else{if("undefined"===typeof content[lang_show]){content_lang=contentArray[0]}else{content_lang=content[lang_show]}}}var slide_title="",btnav_title="",slide_content="",slide_link="";if("undefined"!==typeof content_lang){if(content_lang.title){slide_title="<div class=\"contentMain\"><span class=\"eventtitle\">"+self.genTranslate(content_lang.title)+"</span></div>";btnav_title="<div class=\"buttonNav_title\">"+self.genTranslate(content_lang.title)+"</div>"}if(content_lang.content){slide_content="<div class=\"contentMain\"><span class=\"eventcontent\">"+self.genTranslate(content_lang.content)+"</span></div>"}if(null==content_lang.link){content_lang.link=""}slide_link=content_lang.link}var btn="",target_link="_self",show_buttonnav_cursor="";if(slide_link){show_buttonnav_cursor="showcursor";var btn_text="";if(content_lang.button_text){btn_text=content_lang.button_text}if(null!=content_lang.target_link&&content_lang.target_link){target_link=content_lang.target_link}var wDt=item;btn="<button class=\"bgButton btLink btLink"+item.banner_id+"\" onclick=\"this.getRootNode().host.handleClick('"+self.convertURL(slide_link)+"', '"+target_link+"', '"+wDt.banner_id+"', '"+self.positionTag+"', '"+self.pageTag+"', '"+wDt.sport_id+"', '"+wDt.location_id+"', '"+wDt.tournament_id+"', '"+wDt.event_id+"')\">"+btn_text+"</button>";if(""==btn_text){btn="<div class=\"no_link_btn\">"+btn+"</div>"}self.$.bannerContentMain.classList.add("linkBanner")}else{self.$.bannerContentMain.classList.remove("linkBanner")}var render_slide="";if("desktop"==self.nowScreen&&item.devices.desktop){render_slide="desktop"}if("tablet"==self.nowScreen&&item.devices.tablet){render_slide="tablet"}if("mobile"==self.nowScreen&&item.devices.mobile){render_slide="mobile"}var slideheight=self.height;if(""==slideheight){if(!["7","8","9"].includes(item.type_id.toString())||["7","8","9"].includes(item.type_id.toString())&&!self.autoHeight&&("undefined"==typeof self.height||""==self.height||self.$.type_slider.style.minHeight)){slideheight="250px";if(["7","8","9"].includes(item.type_id.toString())){self.height=slideheight}}}self.$.type_slider.style.minHeight=slideheight;if(render_slide){if(5==item.type_id){item.type_id=1}if(null==item.tournament_id&&2==item.type_id||["1","4","6","7","8","9"].includes(item.type_id.toString())){let iframeTargetId=self.iframeTarget;if("undefined"==iframeTargetId||"undefined"===typeof iframeTargetId){iframeTargetId=""}let activeBet=self.activeBettingOffers;if(!self.activeBettingOffers||"undefined"==self.activeBettingOffers||0==self.activeBettingOffers.length){activeBet=[]}let userRoles=self.emUserRoles;if(!self.emUserRoles||"undefined"==self.emUserRoles||0==self.emUserRoles.length){userRoles=[]}if("3"!=item.status_id){enable_loop=!1;const translate=self.translate&&"object"===typeof self.translate?JSON.stringify(self.translate):JSON.stringify(null);data_1=data_1+"<li li-parent=\"true\" li-type-id=\""+item.type_id+"\" li-id=\""+item.banner_id+"\" class=\"splide__slide\" id=\"primary-slider-slide0"+i+"\" aria-hidden=\"false\" tabindex=\"0\" data-bg-img-thumbnail='"+JSON.stringify(item.banner_image)+"' data-bg-color='"+item.background_color+"' style='background-color:"+(item.background_color?item.background_color:null)+";'><bannermatrix-banner language=\""+self.language+"\" logged-in=\""+self.loggedIn+"\" banner-id=\""+item.banner_id+"\" width=\""+self.width+"\" height=\""+self.height+"\" operator-id=\""+self.operatorId+"\" position-tag=\""+self.positionTag+"\" page-tag=\""+self.pageTag+"\" iframe-target=\""+iframeTargetId+"\" active-betting-offers='"+JSON.stringify(activeBet)+"' eid=\""+item.event_id+"\" tid=\""+item.type_id+"\" event-id=\""+self.eventId+"\" from-include=\"true\" has-bullet=\""+(self.slider_setting?self.slider_setting.slider_layout_bullets:"")+"\" webapi-url=\""+self.webapiUrl+"\" webapi-realm=\""+self.webapiRealm+"\" em-user-id=\""+self.emUserId+"\" em-user-roles='"+JSON.stringify(userRoles)+"' em-user-session=\""+self.emUserSession+"\"  api-method=\""+self.apiMethod+"\" auto-height=\""+self.autoHeight+"\" offer-status=\"\" translate='"+translate+"'></bannermatrix-banner></li>"}}else{var showcursor="";if(""==btn_text||self.linkBoth()){showcursor="showcursor"}var firstStyle="",secondStyle="";if(item.banner_image&&item.banner_image.video){secondStyle="<div class=\"backgroundBannerVideo\"><video autoplay loop muted playsinline poster=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=\"><source src=\""+item.banner_image.video+"\" type=\"video/mp4\"></video></div>"}else{var image=self.generateImage(item.banner_image,window.innerWidth,window.innerHeight);if(image&&"null"!=image&&null!=image){firstStyle="background-image: url("+image+");";if(item.background_image_transperent){firstStyle+="opacity: "+item.background_image_transperent/100+";"}}else if(self.slider_setting){image=self.generateImage(self.slider_setting,window.innerWidth,window.innerHeight);if(image&&"null"!=image&&null!=image){firstStyle="background-image: url("+image+");";if(item.background_image_transperent){firstStyle+="opacity: "+item.background_image_transperent/100+";"}}}}var bg_color=item.background_color;if(""==bg_color&&self.slider_setting){bg_color=self.slider_setting.background_color}if(bg_color){imageBgs+="background-color:"+bg_color+";"}if(6==item.banner_layout){data_1=data_1+"                          <li onclick=\"this.getRootNode().host.bannerClick(event, "+item.banner_id+")\" li-parent=\"false\" li-type-id=\""+item.type_id+"\" li-id=\""+item.banner_id+"\" style=\""+imageBgs+"\" class=\"buttonNavLi splide__slide "+showcursor+"\" id=\"primary-slider-slide0"+i+"\" aria-hidden=\"false\" data-bg-img-thumbnail='"+JSON.stringify(item.banner_image)+"' data-bg-color='"+item.background_color+"' data-bg-transperent='"+item.background_image_transperent+"' tabindex=\"0\">                                <section class=\"buttonNavSection\">                                  <div class=\"buttonNavLayout "+show_buttonnav_cursor+"\">                                    <div class=\"buttonNav_image\" style=\""+firstStyle+"\"></div>                                    <div class=\"buttonNav_btn\">"+btn+"</div>                                    "+btnav_title+"                                  </div>                                </section>                              </li>                          "}else{data_1=data_1+"                              <li onclick=\"this.getRootNode().host.bannerClick(event)\" li-parent=\"false\" li-type-id=\""+item.type_id+"\" li-id=\""+item.banner_id+"\" style=\""+imageBgs+"\" class=\"splide__slide "+showcursor+"\" id=\"primary-slider-slide0"+i+"\" aria-hidden=\"false\" data-bg-img-thumbnail='"+JSON.stringify(item.banner_image)+"' data-bg-color='"+item.background_color+"' data-bg-transperent='"+item.background_image_transperent+"' tabindex=\"0\">                                <div class=\"li_image "+self.disableCrop+"\" style=\""+firstStyle+"\"></div>"+secondStyle+"                                <div class=\"overlaybanner borderradius0\">                                        <div class=\"bannerContent\">                                          <div class=\"container sliderBanner\">                                              <div class=\"bg-content\">                                                <div class=\"body pendingBody\">                                                    <div onclick=\"this.getRootNode().host.bannerIdClick('btLink"+item.banner_id+"','"+btn_text+"')\">                                                    "+slide_content+"                                                    "+slide_title+"                                                    </div>                                                    <div id=\"groupslidebanner\">                                                      <div class=\"detail\" id=\"detail\">                                                        <div>"+btn+"</div>                                                      </div>                                                    </div>                                                </div>                                              </div>                                              <div class=\"cleardiv\"></div>                                            </div>                                        </div>                                  </div>                              </li>                          "}}data_2=data_2+"                        <li class=\"splide__slide\" aria-hidden=\"false\" tabindex=\"0\" id=\"secondary-slider-slide0"+i+"\" data-bg-img-thumbnail=\"\"><div class=\"thumbstyle\" style=\""+imageBgs+"\"></div></li>                      "}})]).then(pData1=>{self.$.ul_slide.innerHTML=data_1;self.$.ul_slide2.innerHTML=data_2;if(data_1){if(self.waitTNoSlide3){clearTimeout(self.waitTNoSlide3);self.waitTNoSlide3={}}self.waitTNoSlide3=setTimeout(function(){self.sliderCheckRemove();if(!self.showLoading){if("block"==self.$.skeletonMain.style.display){self.hideSkeleton()}self.$.type_slider.classList.add("fadebanner")}else{if("block"==self.$.skeletonMain.style.display){self.hideSkeleton();self.$.type_slider.classList.add("fadebanner")}else{var i=0,wait=setInterval(function(){i++;if("block"==self.$.skeletonMain.style.display){clearInterval(wait);self.hideSkeleton();self.$.type_slider.classList.add("fadebanner")}if(100<i){clearInterval(wait)}},50)}}var cHeight=150;if(100<self.$.type_slider.clientHeight){cHeight=self.$.type_slider.clientHeight}if(self.autoHeight){cHeight=0}var option=self.setSliderOption(cHeight,!1,enable_loop);if("undefined"!==typeof self.primarySlider){self.primarySlider.destroy();delete self.primarySlider}self.showSlider();if(!self.slider_layout_thumbnail){self.primarySlider=new Splide(self.shadowRoot.querySelector("#primary-slider"),option);self.eventOfSlider();self.primarySlider.mount()}else{option.pagination=!1;var slidewidth="100%",width="auto",fixedWidth="100px",thumbcolumn="60px",direction="ltr",thumb_pos="bottom";if(5==self.slider_layout){thumb_pos="left"}if("left"==thumb_pos){direction="ttb";slidewidth="80%";fixedWidth="auto";width="19.5%";thumbcolumn=option.height;option.width=slidewidth}else if("right"==thumb_pos){direction="ttb";slidewidth="80%";fixedWidth="auto";width="19.5%";thumbcolumn=option.height;option.width=slidewidth;self.shadowRoot.querySelector("#secondary-slider").classList.add("thumbRight");self.shadowRoot.querySelector("#ul_slide2").style.width="100%"}else if("bottom"==thumb_pos&&height){if("undefined"!==typeof self.height&&self.height){option.height=option.height.toString().replace("px","")-60}}option.type="fade";option.drag=!0;option.padding={left:"0rem",right:"0rem"};self.primarySlider=new Splide(self.shadowRoot.querySelector("#primary-slider"),option);var bp={};if(1==self.slider_layout){bp={600:{fixedWidth:66,height:40}}}var option2={direction:direction,fixedWidth:fixedWidth,width:width,rewind:!0,fixedHeight:60,height:thumbcolumn,gap:10,cover:!0,isNavigation:!0,focus:"left",arrows:!1,pagination:!1,breakpoints:bp,heightRatio:.5};self.secondarySlider=new Splide(self.shadowRoot.querySelector("#secondary-slider"),option2);self.primarySlider.sync(self.secondarySlider);self.primarySlider.mount();self.secondarySlider.mount()}self.removeDemo();self.onResize()},50)}else{self.hideSkeleton()}})})()}})})()}showSlider(){var self=this;self.shadowRoot.querySelector("#primary-slider").classList.add("skeletonMain");self.shadowRoot.querySelector("#primary-slider").style.border="none";self.shadowRoot.querySelector("#primary-slider").style.display="block";if(5==self.slider_layout){self.shadowRoot.querySelector("#secondary-slider").classList.add("thumbLeft");self.shadowRoot.querySelector("#primary-slider").style.paddingLeft="20%";self.shadowRoot.querySelector(".splide__arrows").style.width="80%";self.shadowRoot.querySelector(".splide__arrows").style.height="100%";self.shadowRoot.querySelector(".splide__arrows").style.position="absolute";self.shadowRoot.querySelector("#ul_slide2").style.width="100%"}}hideSlider(){var self=this;self.shadowRoot.querySelector("#primary-slider").classList.remove("skeletonMain");self.shadowRoot.querySelector("#primary-slider").style.display="none";if(5==self.slider_layout){self.shadowRoot.querySelector("#secondary-slider").classList.remove("thumbLeft")}}eventOfSlider(){var self=this;self.waitSliderRepeat={};self.primarySlider.on("visible",function(data){var bannerId=data.slide.getAttribute("li-id"),sendGA=self._sendGA(bannerId);if(sendGA&&window.dataLayerBanner){var dataGA4={event:"Views",operator_id:self.operatorId,banner_id:bannerId,banner_language:self.language,banner_page:self.pageTag,banner_position:self.positionTag,banner_type:data.slide.getAttribute("li-type-id"),em_id:"true"==self.loggedIn&&self.emUserId&&"undefined"!=self.emUserId?btoa(self.emUserId):"",sport_id:"",sport_name:"",country_id:"",country_name:"",tournament_id:"",tournament_name:"",market_id:"",market_name:"",market_short_id:"",event_id:"",event_match_name:"",outcome_id:"",outcome_key:"",outcome_name:""};if("true"===data.slide.getAttribute("li-parent")){var child=data.slide.querySelector("bannermatrix-banner");if(["7","8","9"].includes(data.slide.getAttribute("li-type-id").toString())){try{var timeout=0;if(!child.offerList){timeout=1e3}if(self.waitSliderRepeat[bannerId]){clearInterval(self.waitSliderRepeat[bannerId]);self.waitSliderRepeat[bannerId]={}}var i=1;self.waitSliderRepeat[bannerId]=setInterval(()=>{i++;if(child.offerList){child.offerList.forEach(function(value,key){var dataGA4loop={...dataGA4,sport_id:value.MATCH.sportId,sport_name:value.MATCH.sportName,country_id:value.MATCH.venueId,country_name:value.MATCH.venueName,tournament_id:value.MATCH.parentId,tournament_name:value.MATCH.parentName,market_id:value.MARKET.id,market_name:value.MARKET.name,market_short_id:value.MARKET.bettingTypeId+"_"+value.MARKET.eventPartId,event_id:value.MATCH.id,event_match_name:value.MATCH.name};self.ga4Push(dataGA4loop)});clearInterval(self.waitSliderRepeat[bannerId])}if(10<=i){clearInterval(self.waitSliderRepeat[bannerId])}},timeout)}catch(err){}}else{try{dataGA4.sport_id=child.text.sportId;dataGA4.sport_name=child.text.sportName;dataGA4.country_id=child.text.countryId;dataGA4.country_name=child.text.countryName;dataGA4.tournament_id=child.text.tournamentId;dataGA4.tournament_name=child.text.tournamentName;dataGA4.market_id=child.text.marketid;dataGA4.market_name=child.text.marketname;dataGA4.market_short_id=child.text.marketShortId;dataGA4.event_id=child.text.event_id;dataGA4.event_match_name=child.text.event_name;if(dataGA4.sport_name&&dataGA4.country_name&&dataGA4.tournament_name&&dataGA4.market_id&&dataGA4.market_name&&dataGA4.event_match_name){self.ga4Push(dataGA4)}else{if(self.waitSliderRepeat[bannerId]){clearInterval(self.waitSliderRepeat[bannerId]);self.waitSliderRepeat[bannerId]={}}var i=1;self.waitSliderRepeat[bannerId]=setInterval(function(){i++;dataGA4.sport_id=child.text.sportId;dataGA4.sport_name=child.text.sportName;dataGA4.country_id=child.text.countryId;dataGA4.country_name=child.text.countryName;dataGA4.tournament_id=child.text.tournamentId;dataGA4.tournament_name=child.text.tournamentName;dataGA4.market_id=child.text.marketid;dataGA4.market_name=child.text.marketname;dataGA4.market_short_id=child.text.marketShortId;dataGA4.event_id=child.text.event_id;dataGA4.event_match_name=child.text.event_name;if(dataGA4.sport_name&&dataGA4.country_name&&dataGA4.tournament_name&&dataGA4.market_id&&dataGA4.market_name&&dataGA4.event_match_name){clearInterval(self.waitSliderRepeat[bannerId]);self.ga4Push(dataGA4)}if(10<=i){clearInterval(self.waitSliderRepeat[bannerId])}},1e3)}}catch(err){}}}else{if("2"==data.slide.getAttribute("li-type-id")){var lsParam=self.positionTag+"-"+self.pageTag+"-"+self.loggedIn+"-"+self.eventId.toString(),ls=self.lsGet("bmfe:"+self.language+"-"+lsParam);ls=JSON.parse(ls);if("undefined"!==typeof ls[bannerId]&&ls[bannerId].data){dataGA4.country_id=ls[bannerId].data.location_id;dataGA4.country_name=ls[bannerId].data.location_name;dataGA4.sport_id=ls[bannerId].data.sport_id;dataGA4.sport_name=ls[bannerId].data.sport_name;dataGA4.tournament_id=ls[bannerId].data.tournament_id;dataGA4.tournament_name=ls[bannerId].data.tournament_name}}self.ga4Push(dataGA4)}}});self.primarySlider.on("mounted",function(data){self.shadowRoot.querySelectorAll("bannermatrix-banner").forEach(function(value,key){var isClone=value.parentNode.classList.contains("splide__slide--clone");if(!isClone){value.addEventListener("topic:register",data=>{self.customEventItem("topicListen:register",data.detail)});value.addEventListener("topic:initialDump",data=>{self.customEventItem("topicListen:initialDump",data.detail)})}})})}reloadSlider(){var self=this;self.destroySlider();self.showSlider();if("undefined"!==typeof self.primarySlider){self.eventOfSlider();if("undefined"!==typeof self.secondarySlider){self.primarySlider.sync(self.secondarySlider);self.primarySlider.mount();self.secondarySlider.mount()}else{self.primarySlider.mount()}}}destroySlider(){var self=this;self.hideSlider();if("undefined"!==typeof self.primarySlider){self.primarySlider.destroy();if("undefined"!==typeof self.secondarySlider){self.secondarySlider.destroy()}}}sliderCheckRemove(){var self=this;if(self.waitSliderRm){clearInterval(self.waitSliderRm);self.waitSliderRm={}}self.waitSliderRm=setInterval(function(){self.removeSliderNoOdds()},1e3)}removeSliderNoOdds(){var self=this;if(""==self.bannerId){if(self.slider_disable.length){(async()=>{var list_remove=[];await Promise.all([self.shadowRoot.querySelectorAll("#ul_slide li:not(.splide__slide--clone)").forEach(function(value,key){if(-1!==self.slider_disable.indexOf(value.getAttribute("li-id"))){try{list_remove.push(key)}catch(err){}}})]).then(pData=>{if(list_remove.length){try{var remove=list_remove.reverse();remove.forEach(function(value,key){self.primarySlider.remove(value);if("undefined"!==typeof self.secondarySlider){self.secondarySlider.remove(value)}});if(""==self.$.ul_slide.innerHTML){self.resetWidget()}self.reloadSlider()}catch(err){}}})})()}}}startLoadCacheAction(data){var self=this,data_hash=data.hash,lsParam=self.positionTag+"-"+self.pageTag+"-"+self.loggedIn+"-"+self.eventId.toString(),screenW=window.innerWidth,dataOverride=[];(async()=>{await Promise.all([data.data.forEach(function(value,key){if(480>screenW&&value.devices.mobile){dataOverride.push(value)}else if(481<=screenW&&1024>=screenW&&value.devices.tablet){dataOverride.push(value)}else if(1024<screenW&&value.devices.desktop){dataOverride.push(value)}})]).then(pData=>{data.data=dataOverride;if(null===data.data||0==data.data.length||[]==data.data){self.hideSkeleton();if(self.waitTNoRecords){clearTimeout(self.waitTNoRecords);self.waitTNoRecords={}}self.waitTNoRecords=setTimeout(function(){self.startLoad()},14e3);return!1}if(self.positionTag&&0==self.widget_position_id&&"undefined"!==typeof data.data&&data.data.length){var slider_change=!1,ls=self.lsGet("bmfe:"+self.language+"-"+lsParam),i=0,wait=setInterval(function(){ls=self.lsGet("bmfe:"+self.language+"-"+lsParam);if(!ls){i++;if(500<i){clearInterval(wait)}}else{clearInterval(wait);ls=JSON.parse(ls);if("undefined"===typeof ls.hash||ls.hash!=data_hash){slider_change=!0}if(slider_change&&"undefined"!==typeof ls.hash){}else{(async()=>{self.widget.content_arr=[];self.widget.content_data=[];self.widget.device="";var waitNewCall=!1;await Promise.all([data.data.forEach(function(value,key){if(""==self.widget.device){self.widget.device=value.devices}if(2==value.type_id&&"undefined"!==typeof ls[value.banner_id]&&ls[value.banner_id].successful&&("undefined"===typeof ls[value.banner_id].data.tournament_event_id||0==ls[value.banner_id].data.tournament_event_id.length)){value.type_id=3}self.widget.content_arr.push(value)}),self.widget.content_arr.forEach(function(value2,key2){var apiParam="/"+self.language+"/banners/widget/"+self.operatorId+"/"+value2.banner_id+"/"+self.positionTag+"/"+self.eventId.toString(),nowTime=new Date,nextLoad=new Date(nowTime.getTime()+1e4);if(!slider_change&&"undefined"!==typeof ls[value2.banner_id]&&ls[value2.banner_id].successful){if("undefined"===typeof self.WEB_API_CACHE[apiParam]){self.WEB_API_CACHE[apiParam]={min_next_load:nextLoad,cachedata:{}}}self.WEB_API_CACHE[apiParam].min_next_load=nextLoad;self.WEB_API_CACHE[apiParam].cachedata=ls[value2.banner_id];self.WEB_API_CACHE[apiParam].cachedata.successful=1;self.widget.content_data[key2]=ls[value2.banner_id].data}else{waitNewCall=!0}})]).then(pData=>{if("undefined"!==typeof self.widget.content_arr&&self.widget.content_arr.length){if(waitNewCall){self.lsDelete("bmfe:"+self.language+"-"+lsParam);self.resetWidget();self.shadowRoot.querySelectorAll(".splide__pagination").forEach(el=>el.remove());self.removeSession();self.startLoad()}else{self.showSlides();self.checkSliderChange()}}else{self.checkSliderChange()}})})()}}},50);return!1}else{var filter_data=[],popup_change=!1,ls=self.lsGet("bmfe:"+self.language+"-"+lsParam),i=0,wait=setInterval(function(){ls=self.lsGet("bmfe:"+self.language+"-"+lsParam);if(!ls){i++;if(500<i){clearInterval(wait)}}else{clearInterval(wait);ls=JSON.parse(ls);if("undefined"===typeof ls.hash||ls.hash!=data_hash){popup_change=!0}(async()=>{self.widget.content_arr=[];self.widget.content_data=[];self.widget.device="";var data_filter=[];await Promise.all([data.data.forEach(function(value,key){data_filter.push(value);if(""==self.widget.device){self.widget.device=value.devices}if(2==value.type_id&&"undefined"!==typeof ls[value.banner_id]&&ls[value.banner_id].successful&&("undefined"===typeof ls[value.banner_id].data.tournament_event_id||0==ls[value.banner_id].data.tournament_event_id.length)){value.type_id=3}if(-1==self.slider_disable.indexOf(value.banner_id.toString())){filter_data.push(value)}self.widget.content_arr.push(value)})]).then(pData=>{if(filter_data.length){var fDt=filter_data[0];self.hashdata=fDt.hash;self.widget={events_list:[]};self.widget.events_list[0]={web_data:fDt,banner_data:data_filter};if(self.last_hash[self.widget_id].length&&self.last_hash[self.widget_id].includes(fDt.hash)){if(self.waitTPush){clearTimeout(self.waitTPush);self.waitTPush={}}self.waitTPush=setTimeout(function(){self.startLoad()},1e4);return!1}if(2==fDt.type_id&&0==fDt.interval_status){fDt.type_id=3}if(3==fDt.type_id){self.$.overlaybanner.classList.add("promotionBanner");self.$.groupslidebanner.classList.add("promotionBanner");self.getBannerData()}else{self.$.overlaybanner.classList.remove("promotionBanner");self.$.groupslidebanner.classList.remove("promotionBanner");self.showSkeleton();self.getBannerData()}}else{self.hideSkeleton();setTimeout(function(){self.checkSliderChange()},1e3)}})})()}},50);return!1}})})()}startLoadCache(data){var self=this;if(self.widget_position_id&&["1","2"].includes(self.widget_position_id.toString())){var tag=self.positionTag+"-"+self.pageTag,lsBlockPF=self.lsGet("bmfe:blockpopupForever","json");if("undefined"!==typeof lsBlockPF.positions&&lsBlockPF.positions.length&&lsBlockPF.positions.includes(tag)){self.style.display="none";self.checkSliderChange();return!1}}if(data.successful){var paramLogin=self.loggedIn,lsParam=self.positionTag+"-"+self.pageTag+"-"+paramLogin+"-"+self.eventId.toString();if(0==data.data.length){self.lsDelete("bmfe:"+self.language+"-"+lsParam);self.hideSkeleton();self.checkSliderChange();return!1}var dt=data.data[0];if("offerlibrary"==self.apiMethod){var timeOut=100,i=0,wait=setInterval(function(){if("undefined"!==typeof self.WEB_API_CACHE["offerlib.bundle.js"]){clearInterval(wait);if("undefined"===typeof self.WEB_API_CACHE.offer_library&&self.offerlibUrl){let array_event=[];(async()=>{await Promise.all([data.data.forEach((item,i)=>{if(null!=item.event_id&&item.event_id&&0!=item.event_id){array_event.push(item.event_id)}})]).then(pData=>{try{self.WEB_API_CACHE.offer_library=new OfferLib.OfferLib({offerUrl:self.offerlibUrl,langCode:self.offerlibLang?self.offerlibLang:"en-GB",version:2,useSse:!0});if(array_event.length){(async()=>{try{await self.WEB_API_CACHE.offer_library.sport.create();await self.WEB_API_CACHE.offer_library.sport.selectMatches(array_event);self.WEB_API_CACHE.offer_library.sport.on("updatematch",match=>{self.shadowRoot.querySelectorAll("#type_slider bannermatrix-banner").forEach(function(x){if(match&&x.getAttribute("eid")==match.matchId){x.setAttribute("offer-status","update")}})});self.WEB_API_CACHE.offer_library_ready=!0}catch(err){}})()}}catch(err){}})})()}if(0==self.widget_position_id){self.startLoadCacheAction(data)}else{var timeOut=100;if("offerlibrary"==self.apiMethod&&"undefined"!==typeof self.WEB_API_CACHE.offer_library_ready||["3","6"].includes(dt.type_id.toString())||2==dt.type_id&&("undefined"==typeof dt.tournament_event_id||0==dt.tournament_event_id.length)){timeOut=20}var j=0,waitIn=setInterval(function(){if("offerlibrary"==self.apiMethod&&"undefined"!==typeof self.WEB_API_CACHE.offer_library_ready||["3","6"].includes(dt.type_id.toString())||2==dt.type_id&&("undefined"==typeof dt.tournament_event_id||0==dt.tournament_event_id.length)){clearInterval(waitIn);if(data.data.length){if(["3","6"].includes(dt.type_id.toString())||2==dt.type_id&&("undefined"==typeof dt.tournament_event_id||0==dt.tournament_event_id.length)){self.startLoadCacheAction(data)}else{var start_hash=data.hash;lsParam=self.positionTag+"-"+self.pageTag+"-"+paramLogin+"-"+self.eventId.toString();var ls=self.lsGet("bmfe:"+self.language+"-"+lsParam,"json");if("undefined"===typeof ls.hash||start_hash==ls.hash){var newData=[];(async()=>{await Promise.all([data.data.forEach((item3,i3)=>{if(null!=item3.event_id&&item3.event_id&&0!=item3.event_id){let focus=self.WEB_API_CACHE.offer_library.sport.matches.get(item3.event_id);if(focus&&"prematch"==focus.state){newData.push(item3)}}else{newData.push(item3)}})]).then(pData1=>{var lsNew=self.lsGet("bmfe:"+self.language+"-"+lsParam,"json");if("undefined"!==typeof lsNew.maindata){lsNew.maindata.data=newData;(async()=>{if(newData.length){await Promise.all([newData.forEach((item,i)=>{lsNew[item.banner_id]={data:item,successful:1}})]).then(pData2=>{self.lsSet("bmfe:"+self.language+"-"+lsParam,JSON.stringify(lsNew))})}else{self.lsSet("bmfe:"+self.language+"-"+lsParam,JSON.stringify(lsNew))}})();data.data=newData;if(paramLogin==self.loggedIn){self.startLoadCacheAction(data)}}else{self.widget={events_list:[]};self.resetWidget();self.startLoad();return!1}})})()}}}}else{j++;if(100<j){clearInterval(waitIn)}}},timeOut)}}else{i++;if(100<i){clearInterval(wait)}}},timeOut)}else{if(0==self.widget_position_id){self.startLoadCacheAction(data)}else{let checkData=!1;if(["3","4","6","7","8","9"].includes(dt.type_id.toString())||2==dt.type_id&&("undefined"==typeof dt.tournament_event_id||0==dt.tournament_event_id.length)){checkData=!0}var timeOut=100;if(null!=self.ws_session||checkData){timeOut=20}var i=0,wait=setInterval(function(){if(null!=self.ws_session||checkData){clearInterval(wait);if(data.data.length){if(checkData){self.startLoadCacheAction(data)}else{var array_event=[];(async()=>{await Promise.all([data.data.forEach((item,i)=>{if(null!=item.event_id&&item.event_id&&0!=item.event_id){array_event.push(item.event_id)}})]).then(pData=>{var start_hash=data.hash;self.ws_session.call("/sports#event",[],{lang:self.language,eventIds:array_event,dataWithoutOdds:!1}).then(function(res){lsParam=self.positionTag+"-"+self.pageTag+"-"+paramLogin+"-"+self.eventId.toString();var ls=self.lsGet("bmfe:"+self.language+"-"+lsParam,"json");if("undefined"===typeof ls.hash||start_hash==ls.hash){if(res.kwargs.records.length){var newData=[];(async()=>{await Promise.all([res.kwargs.records.forEach((item2,i2)=>{self.arrEvent[item2.id]=item2}),data.data.forEach((item3,i3)=>{if(null!=item3.event_id&&item3.event_id&&0!=item3.event_id){if("undefined"!==typeof self.arrEvent[item3.event_id]){if(1==self.arrEvent[item3.event_id].statusId||2==self.arrEvent[item3.event_id].statusId){item3.status_id=self.arrEvent[item3.event_id].statusId;newData.push(item3)}}}else{newData.push(item3)}})]).then(pData1=>{var lsNew=self.lsGet("bmfe:"+self.language+"-"+lsParam,"json");if("undefined"!==typeof lsNew.maindata){lsNew.maindata.data=newData;(async()=>{if(newData.length){await Promise.all([newData.forEach((item,i)=>{lsNew[item.banner_id]={data:item,successful:1}})]).then(pData2=>{self.lsSet("bmfe:"+self.language+"-"+lsParam,JSON.stringify(lsNew))})}else{self.lsSet("bmfe:"+self.language+"-"+lsParam,JSON.stringify(lsNew))}})();data.data=newData;if(paramLogin==self.loggedIn){self.startLoadCacheAction(data)}}else{self.widget={events_list:[]};self.resetWidget();self.startLoad();return!1}})})()}else{if(1<data.data.length){delete data.data[0];var newD=[];(async()=>{await Promise.all([data.data.forEach((item,i)=>{newD.push(item)})]).then(pData1=>{data.data=newD;var sendData=data;self.startLoadCacheFilter(sendData)})})()}}}})})})()}}}else{i++;if(200<i){clearInterval(wait)}}},timeOut)}}}}intersect(a,b){for(var d={},results=[],i=0;i<b.length;i++){d[b[i]]=!0}for(var j=0;j<a.length;j++){if(d[a[j]]){results.push(a[j])}}return results}startLoadCacheFilter(data){var self=this;if("false"==self.loggedIn){self.startLoadCache(data)}else{var newData=[];(async()=>{await Promise.all([data.data.forEach((item,i)=>{if(0==item.user_group.length||self.intersect(self.emUserRoles,item.user_group).length){newData.push(item)}})]).then(pData=>{data.data=newData;self.startLoadCache(data)})})()}}startLoadCloseFilter(data){var self=this,lsBlockP=self.lsGet("bmfe:blockpopup","json");if(data.successful&&data.data.length&&"undefined"!==typeof lsBlockP.login){(async()=>{var iLogin=lsBlockP.login,iLogout=lsBlockP.logout,unblock=!1,newBlockPL=[],lsBlockPL=self.lsGet("bmfe:blockpopupLimit","json"),arr_new=[],limitBlock=[];await Promise.all([lsBlockPL.forEach((item,i)=>{if(dayjs(dayjs()).isBefore(item.expireDate)){newBlockPL.push(item);limitBlock.push(item.hash)}else{unblock=!0}}),data.data.forEach((item,i)=>{if(-1==limitBlock.indexOf(self.language+"-"+self.positionTag)){if("true"==self.loggedIn){if(-1==iLogin.indexOf(item.hash)){arr_new.push(item)}}else{if(-1==iLogout.indexOf(item.hash)){arr_new.push(item)}}}})]).then(pData=>{if(unblock){self.lsSet("bmfe:blockpopupLimit",JSON.stringify(newBlockPL));self.resetWidget();var lsParam=self.positionTag+"-"+self.pageTag+"-"+self.loggedIn+"-"+self.eventId.toString();self.lsDelete("bmfe:"+self.language+"-"+lsParam);self.removeSession();self.startLoad()}else{data.data=arr_new;self.startLoadCacheFilter(data)}})})()}else{self.startLoadCacheFilter(data)}}startLoadCall(apiParam,url,method){var self=this,paramLogin=self.loggedIn.toString();if("true"!=paramLogin){paramLogin="false"}var showCall=!0,lsParam=self.positionTag+"-"+self.pageTag+"-"+paramLogin+"-"+self.eventId.toString(),ls=self.lsGet("bmfe:"+self.language+"-"+lsParam,"json");if("undefined"!==typeof ls.maindata){try{var data=ls.maindata;self.WEB_API_CACHE[apiParam].cachedata=data;showCall=!1;if(self.widget_position_id&&["1","2"].includes(self.widget_position_id.toString())){self.startLoadCloseFilter(data)}else{self.startLoadCacheFilter(data)}var oldhash=ls.hash||"",lastUpdate=ls.maindata.last_update}catch(err){self.lsDelete("bmfe:"+self.language+"-"+lsParam)}}self.callAjax(url,method,{}).then(res=>{if(res.successful){if("undefined"!==typeof oldhash&&oldhash!=res.hash&&("undefined"===typeof lastUpdate||lastUpdate&&dayjs(res.last_update).isAfter(dayjs(lastUpdate)))){self.disableApiCallback=!1;self.lsSet("bmfe:events","{}");self.set("text.status_id","");self.widget.content_arr=[];self.widget.content_data=[];self.lsSet("bmfe:"+self.language+"-"+lsParam,"{}");self.resetWidget();self.removeSession();self.startLoad()}else{let newRes={data:[],last_update:res.last_update,hash:res.hash,successful:res.successful};self.position_hash=newRes.hash;(async()=>{await Promise.all([res.data.forEach((item,i)=>{let skip=!1;if("offerlibrary"==self.apiMethod){skip=!0;if(["1","2","3"].includes(item.type_id.toString())){skip=!1}}if(!skip){newRes.data.push(item)}})]).then(pData1=>{var setData={},saveLocal=!1;ls=self.lsGet("bmfe:"+self.language+"-"+lsParam,"json");if(0===Object.keys(ls).length||"undefined"===typeof ls.maindata){setData.maindata=newRes;setData.hash=newRes.hash;saveLocal=!0}(async()=>{if(newRes.data.length){await Promise.all([newRes.data.forEach((item,i)=>{setData[item.banner_id]={data:item,successful:newRes.successful}})]).then(pData=>{if(saveLocal){self.lsSet("bmfe:"+self.language+"-"+lsParam,JSON.stringify(setData))}if(showCall){self.WEB_API_CACHE[apiParam].cachedata=newRes;if(self.widget_position_id&&["1","2"].includes(self.widget_position_id.toString())){self.startLoadCloseFilter(newRes)}else{self.startLoadCacheFilter(newRes)}}})}else{self.hideSkeleton();if(saveLocal){self.lsSet("bmfe:"+self.language+"-"+lsParam,JSON.stringify(setData))}}})()})})()}}}).catch(err=>{})}startLoad(){var self=this;self.widget={events_list:[]};if(self.bannerId){self.getBannerData();return!1}else{var paramLogin=self.loggedIn.toString();if("true"!=paramLogin){paramLogin="false"}var ajax1={method:"GET",url:"/banners/list/"+self.operatorId+"/"+self.language+"/"+self.positionTag+"/"+self.pageTag+"/"+paramLogin+"/"+self.eventId.toString()},apiParam="/"+self.language+ajax1.url,nowTime=new Date,nextLoad=new Date(nowTime.getTime()+5e3),loadFirst=!1;if("undefined"==typeof self.WEB_API_CACHE[apiParam]||"undefined"!==typeof self.WEB_API_CACHE[apiParam]&&"undefined"===typeof self.WEB_API_CACHE[apiParam].cachedata){self.WEB_API_CACHE[apiParam]={min_next_load:nextLoad,cachedata:{}};loadFirst=!0;self.startLoadCall(apiParam,self.WEB_API+ajax1.url,ajax1.method)}if(nowTime>self.WEB_API_CACHE[apiParam].min_next_load){self.WEB_API_CACHE[apiParam].min_next_load=nextLoad;self.startLoadCall(apiParam,self.WEB_API+ajax1.url,ajax1.method)}else if(!loadFirst&&"undefined"!==typeof self.WEB_API_CACHE[apiParam].cachedata.successful){self.startLoadCacheFilter(self.WEB_API_CACHE[apiParam].cachedata)}else{if(!loadFirst){var i=0,wait=setInterval(function(){i++;if("undefined"===typeof self.WEB_API_CACHE[apiParam].cachedata.successful){if(200<i){clearInterval(wait)}}else{self.startLoadCacheFilter(self.WEB_API_CACHE[apiParam].cachedata);clearInterval(wait)}},300)}}}}getDateFormat(dateget){var self=this,format={defaultDateTime:"DD-MM-YYYY HH:mm",defaultDate:"DD-MM-YYYY",defaultTime:"HH:mm",shortDateTime:"DD/MM HH:mm"};if(self.slider_setting&&self.slider_setting.extra_config&&self.slider_setting.extra_config.format){format=self.slider_setting.extra_config.format}var dateFormat=dayjs(dateget).format(format.defaultDateTime).toLocaleString("en-US");if(self.slider_setting){if(1==self.slider_setting.banner_date){var dateToday=dayjs().format(format.defaultDate).toLocaleString("en-US"),dateTomorrow=dayjs().add(1,"day").format(format.defaultDate).toLocaleString("en-US"),dateCheck=dayjs(dateget).format(format.defaultDate).toLocaleString("en-US"),tDt=self.slider_setting.translate_date;if(dateCheck==dateTomorrow){var txtTomorrow="Tomorrow";if("undefined"!=typeof tDt[self.language]&&"undefined"!=typeof tDt[self.language][1]){txtTomorrow=tDt[self.language][1]}dateFormat=txtTomorrow+" "+dayjs(dateget).format(format.defaultTime).toLocaleString("en-US")}else if(dateCheck==dateToday){var txtToday="Today";if("undefined"!=typeof tDt[self.language]&&"undefined"!=typeof tDt[self.language][0]){txtToday=tDt[self.language][0]}dateFormat=txtToday+" "+dayjs(dateget).format(format.defaultTime).toLocaleString("en-US")}else{dateFormat=dayjs(dateget).format(format.shortDateTime).toLocaleString("en-US")}}else if(2==self.slider_setting.banner_date){dateFormat=dayjs(dateget).format(format.shortDateTime).toLocaleString("en-US")}else if(3==self.slider_setting.banner_date){dateFormat=dayjs(dateget).format(format.defaultDateTime).toLocaleString("en-US")}}return dateFormat}async getEventDetail(eventId){var self=this;if("undefined"==typeof self.ws_event[eventId]&&"undefined"!=typeof self.arrEvent[eventId]){self.ws_event[eventId]=self.arrEvent[eventId]}var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0;if("undefined"!=typeof self.ws_event[eventId]&&self.ws_event[eventId]){if("undefined"!==typeof eDt&&"undefined"!==typeof eDt.web_data&&"undefined"!==typeof eDt.web_data.tournament_id){if("undefined"!==typeof self.ws_event[eventId].parentId){self.set("text.tournamentId",self.ws_event[eventId].parentId)}if("undefined"!==typeof self.ws_event[eventId].shortParentName){self.set("text.tournamentName",self.ws_event[eventId].shortParentName)}else if("undefined"!==typeof self.ws_event[eventId].parentName){self.set("text.tournamentName",self.ws_event[eventId].parentName)}}if(self.widget_position_id&&["1","2"].includes(self.widget_position_id.toString())&&"undefined"!==typeof eDt&&"undefined"!==typeof eDt.web_data&&"undefined"!==typeof eDt.web_data.type_id&&3==eDt.web_data.type_id&&"undefined"!==typeof eDt.web_data.event_id&&"0"==eDt.web_data.event_id){}else{self.set("text.sportId","");self.set("text.sportName","")}if("undefined"!==typeof eDt&&"undefined"!==typeof self.ws_event[eventId].sportId){self.set("text.sportId",self.ws_event[eventId].sportId);self.set("text.sportName",self.ws_event[eventId].sportName)}if("undefined"!==typeof self.ws_event[eventId].homeParticipantName){self.set("text.homeName",self.ws_event[eventId].homeParticipantName);self.set("text.awayName",self.ws_event[eventId].awayParticipantName)}self.set("text.time",self.getDateFormat(self.ws_event[eventId].startTime));self.set("text.status","("+self.ws_event[eventId].statusName+")");self.set("text.status_id",self.ws_event[eventId].statusId)}if("undefined"!==typeof eDt&&eDt.banner_data.length){var bg_color=eDt.banner_data[0].background_color;if(""==bg_color&&self.slider_setting){bg_color=self.slider_setting.background_color}self.$.backgroundBanner.style.background=bg_color;var bg_opacity=1;if(eDt.banner_data[0].background_image_transperent){bg_opacity=eDt.banner_data[0].background_image_transperent/100}else if(self.slider_setting&&self.slider_setting.background_image_transperent){bg_opacity=self.slider_setting.background_image_transperent/100}if(0==bg_opacity||""==bg_opacity){.01==bg_opacity}self.$.backgroundBanner2.style.opacity=bg_opacity}self.onResize()}setTypeBanner(){var self=this;if(self.positionTag&&(3==self.widget_position_id||4==self.widget_position_id)||self.bannerId){self.$.backgroundBanner.classList.add("type_banner_default");self.$.backgroundBanner.classList.remove("type_banner_bottom");self.$.backgroundBanner.classList.remove("type_banner_popup");self.$.backgroundBanner.classList.remove("type_stream_popup");self.disableCloseButton="true";if("undefined"!==typeof self.width&&this.width){if(0==self.widget_position_id&&self.fromInclude){}else{self.$.backgroundBanner.style.width=this.width;self.$.backgroundBanner.style.overflowX="auto"}}if("undefined"!==typeof self.height&&self.height){self.$.backgroundBanner.style.height=self.height;self.$.skeletonMain.style.height=self.height;self.$.backgroundBanner.style.overflowY="auto"}}else if(2==self.widget_position_id){self.$.backgroundBanner.classList.remove("type_banner_default");self.$.backgroundBanner.classList.remove("type_banner_bottom");self.$.backgroundBanner.classList.add("type_banner_popup");self.$.backgroundBanner.classList.remove("type_stream_popup");self.$.skeletonMain.style.height="auto"}else if("streaming"==self.bannerType&&self.sportbookId){self.$.backgroundBanner.classList.remove("type_banner_default");self.$.backgroundBanner.classList.remove("type_banner_bottom");self.$.backgroundBanner.classList.remove("type_banner_popup");self.$.backgroundBanner.classList.add("type_stream_popup");self.$.skeletonMain.style.height="auto"}else if("iframe"==self.bannerType){self.$.backgroundBanner.classList.remove("type_banner_default");self.$.backgroundBanner.classList.remove("type_banner_bottom");self.$.backgroundBanner.classList.remove("type_banner_popup");self.$.backgroundBanner.classList.remove("type_stream_popup");self.$.skeletonMain.style.height=0}else{self.$.backgroundBanner.classList.remove("type_banner_default");self.$.backgroundBanner.classList.add("type_banner_bottom");self.$.backgroundBanner.classList.remove("type_banner_popup");self.$.backgroundBanner.classList.remove("type_stream_popup");self.$.skeletonMain.style.height="auto"}}renderBanner(){var self=this,eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0;if("undefined"===typeof eDt||"undefined"!==typeof eDt&&"undefined"===typeof eDt.web_data){self.showLoading=!0;self.showSkeleton();self.resetWidget();self.startLoad();return!1}self.setTypeBanner();self.onResize();self.set("text.title","");self.set("text.content","");self.showEventDetail()}showEventDetail(){var self=this,eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,wDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.web_data?eDt.web_data:{};if("undefined"!==typeof eDt){if("undefined"!==typeof eDt.web_data&&!["3","4","7","8","9"].includes(eDt.web_data.type_id.toString())){self.$.buttondetail.innerHTML=""}var bg_opacity=1,bg_color=eDt.banner_data[0].background_color;if(""==bg_color&&self.slider_setting){bg_color=self.slider_setting.background_color}var i=0,wait=setInterval(function(){var screenW=self.$.backgroundBanner.offsetWidth,screenH=self.$.backgroundBanner.offsetHeight;if(0<screenW){clearInterval(wait);if(eDt.banner_data[0].banner_image&&eDt.banner_data[0].banner_image.video){self.setVideo(eDt.banner_data[0].banner_image.video)}else{self.setImage(eDt.banner_data[0].banner_image,screenW,screenH)}}i++;if(200<i){clearInterval(wait)}},20);if(6==eDt.web_data.banner_layout){self.$.backgroundBanner.style.background="transparent"}else{self.$.backgroundBanner.style.background=bg_color}if(eDt.banner_data[0].background_image_transperent){bg_opacity=eDt.banner_data[0].background_image_transperent/100}else if(self.slider_setting&&self.slider_setting.background_image_transperent){bg_opacity=self.slider_setting.background_image_transperent/100}if(0==bg_opacity||""==bg_opacity){.01==bg_opacity}self.$.backgroundBanner2.style.opacity=bg_opacity;if(["3","4","6","7","8","9"].includes(eDt.web_data.type_id.toString())||eDt.banner_data[0].markets.length||eDt.banner_data[0].markets_live.length||eDt.banner_data[0].markets_interval.length){var contentArray=Object.values(eDt.banner_data[0].banner_translate),content=eDt.banner_data[0].banner_translate,content_lang={},lang_show="en";if("undefined"===typeof content[self.language]&&"undefined"===typeof content[lang_show]){content_lang=contentArray[0]}else{if("undefined"!==typeof content[self.language]){content_lang=content[self.language]}else{if("undefined"===typeof content[lang_show]){content_lang=contentArray[0]}else{content_lang=content[lang_show]}}}if(3==eDt.web_data.type_id){if("undefined"===typeof content_lang){content_lang=contentArray[0]}try{self.set("text.title",self.genTranslate(content_lang.title));self.set("text.content",self.genTranslate(content_lang.content));self.backupMarketName="";self.set("text.marketname","");self.set("text.labelName","");self.set("text.labelStyle","")}catch(err){}}else{try{self.set("text.title",self.genTranslate(content_lang.title));self.set("text.content",self.genTranslate(content_lang.content))}catch(err){}}try{if(!self.haveEventCache){self.set("text.time",content_lang.content)}self.set("text.status","");var btn="",target_link="_self";if(null==content_lang.link){content_lang.link=""}if(content_lang.link&&!eDt.web_data.generate_link){self.$.buttonNavLayout.classList.add("showcursor");var btn_text="";if(content_lang.button_text){btn_text=content_lang.button_text}if(null!=content_lang.target_link&&content_lang.target_link){target_link=content_lang.target_link}btn="<br><button class=\"btLink\" onclick=\"this.getRootNode().host.handleClick('"+self.convertURL(content_lang.link)+"', '"+target_link+"', '"+wDt.banner_id+"', '"+self.positionTag+"', '"+self.pageTag+"', '"+wDt.sport_id+"', '"+wDt.location_id+"', '"+wDt.tournament_id+"', '"+wDt.event_id+"')\">"+btn_text+"</button>";if(""==btn_text){btn="<div class=\"no_link_btn\">"+btn+"</div>";self.$.bannerContentMain.classList.add("showcursor")}else if("3"===self.tid&&self.linkBoth()){self.$.bannerContentMain.classList.add("showcursor")}else{self.$.bannerContentMain.classList.remove("showcursor")}self.$.buttondetail.innerHTML=btn;self.$.buttonNav_btn.innerHTML=btn;self.$.bannerContentMain.classList.add("linkBanner");if(self.bannerId&&0==eDt.web_data.event_id){self.$.overlaybanner.classList.add("promotionBanner");self.$.groupslidebanner.classList.add("promotionBanner")}}else{self.$.buttondetail.innerHTML="";self.$.bannerContentMain.classList.remove("linkBanner");self.$.buttonNavLayout.classList.remove("showcursor");self.$.buttonNav_btn.innerHTML=""}}catch(err){}if(!self.haveEventCache){if("undefined"!==typeof eDt.web_data&&3==eDt.web_data.type_id||2==eDt.web_data.type_id&&("undefined"===typeof eDt.web_data.tournament_event_id||0==eDt.web_data.tournament_event_id.length)||"undefined"===typeof eDt.web_data.event_id){self.$.slidebanner.innerHTML=""}}if(3==eDt.web_data.type_id){if(self.widget_position_id&&["1","2"].includes(self.widget_position_id.toString())&&3==eDt.web_data.type_id&&"0"==eDt.web_data.event_id&&1==eDt.web_data.incident_status){}else{self.$.slideSource.classList.add("fadebanner");var sendGA=self._sendGA(wDt.banner_id);if(sendGA&&"2"==self.tid){var dataTournamentGA4={event:"Views",operator_id:self.operatorId,banner_id:wDt.banner_id,banner_language:self.language,banner_page:self.pageTag,banner_position:self.positionTag,banner_type:2,em_id:"true"==self.loggedIn&&self.emUserId&&"undefined"!=self.emUserId?btoa(self.emUserId):"",sport_id:wDt.sport_id,sport_name:wDt.sport_name,country_id:wDt.location_id,country_name:wDt.location_name,tournament_id:wDt.tournament_id,tournament_name:wDt.tournament_name,market_id:"",market_name:"",market_short_id:"",event_id:"",event_match_name:"",outcome_id:"",outcome_key:"",outcome_name:""};self.ga4Push(dataTournamentGA4)}}self.hideSkeleton()}if("undefined"!==typeof eDt.web_data.devices&&"undefined"!==eDt.web_data.devices){var device=eDt.web_data.devices;if(device.desktop){self.$.slideSource.classList.add("d_desktop")}if(device.tablet){self.$.slideSource.classList.add("d_tablet")}if(device.mobile){self.$.slideSource.classList.add("d_mobile")}}if(null!=self.shadowRoot.getElementById("demotag")&&3==eDt.web_data.type_id){self.removeDemo()}self.checkSliderChange()}}}async checkMarket(liveStatus,marketSelectedIds,isIncidentMarket=!1){var self=this;return new Promise(resolve=>{if("LIVE"==liveStatus||"NOT_LIVE"==liveStatus){if("undefined"!==typeof marketSelectedIds&&marketSelectedIds.length){var data=[];if(self.listPopular&&self.listPopular.market){marketSelectedIds.forEach(function(value,key){if(self.listPopular&&"undefined"!==typeof self.listPopular.market[value]){var found=!1;self.listPopular.market[value].selections.forEach(function(value2,key2){if(value2.outcomeId&&"undefined"!==typeof self.listPopular.outcome[value2.outcomeId]){value2=self.listPopular.outcome[value2.outcomeId]}if(isIncidentMarket){if(value2.available&&1==value2.statusId){found=!0}}else{if(value2.available){found=!0}}});if(found){data.push(self.listPopular.market[value])}}});if(data){var res={successful:1,data};resolve(res)}else{resolve({successful:0})}}else{resolve({successful:0})}}else{resolve({successful:0})}}else{resolve({successful:0})}})}handleClick(url,type,bannerId,position,page,sport_id,country_id,tournament_id,event_id){var self=this;self.recordClick(bannerId,position,page,sport_id,country_id,tournament_id,event_id,"");window.open(url,type)}recordClick(bannerId,position,page,sport_id,country_id,tournament_id,event_id,bet_id,market_short_id,detailBtn){var self=this,type="oddsClick";if("null"===sport_id){type="promotionClick"}else if("null"==event_id&&"null"==tournament_id&&"undefined"===typeof bet_id){type="popularClick"}else if("0"==event_id&&tournament_id&&("undefined"===typeof bet_id||""===bet_id)){type="tournamentClick"}else if(event_id&&"0"!=event_id&&"null"!=event_id&&"undefined"===typeof bet_id){type="eventClick"}var spot=bannerId+"-"+position+"-"+page+"-"+type;if("undefined"===typeof self.WEB_API_CACHE.rememberClick){self.WEB_API_CACHE.rememberClick=[]}try{var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0].web_data:void 0;if(0==event_id){event_id=""}if("null"==sport_id){sport_id=""}if("null"==country_id){country_id=""}if("null"==tournament_id){tournament_id=""}if("null"==event_id){event_id=""}if(!self.WEB_API_CACHE.rememberClick.includes(spot)&&bannerId){self.WEB_API_CACHE.rememberClick.push(spot);self.callAjax(self.WEB_API+"/reports/click/"+self.operatorId,"PUT",{banner_id:bannerId,position:position,page:page,sport_id:sport_id,country_id:country_id,tournament_id:tournament_id,event_id:event_id}).then(res=>{}).catch(err=>{})}if(window.dataLayerBanner){var mappingBanner=self.widget&&self.widget.content_data?self.widget.content_data.reduce((res,item)=>{res[item.banner_id]=item;return res},{}):[],dataGA4={event:"Clicks",operator_id:self.operatorId,banner_id:bannerId,banner_language:self.language,banner_page:page,banner_position:position,banner_type:eDt?eDt.type_id:self.widget.content_data&&mappingBanner&&mappingBanner[bannerId]?mappingBanner[bannerId].type_id:"",em_id:"true"==self.loggedIn&&self.emUserId&&"undefined"!=self.emUserId?btoa(self.emUserId):"",event_id:self.text.event_id,event_match_name:self.text.event_name,sport_id:self.text.sportId,sport_name:self.text.sportName,country_id:self.text.countryId,country_name:self.text.countryName,tournament_id:self.text.tournamentId,tournament_name:self.text.tournamentName,market_id:"",market_name:"",market_short_id:"",outcome_id:"",outcome_key:"",outcome_name:""};if("oddsClick"===type){dataGA4.market_id=detailBtn?detailBtn.getAttribute("data-market"):"";dataGA4.market_name=self.text.marketname;dataGA4.market_short_id=market_short_id?market_short_id:"";dataGA4.outcome_id=bet_id;dataGA4.outcome_key=detailBtn?detailBtn.getAttribute("data-role"):"";dataGA4.outcome_name=detailBtn?detailBtn.getAttribute("data-outcome-name"):""}else if("tournamentClick"==type){var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0;if("undefined"!==typeof eDt&&"undefined"!==typeof eDt.web_data){dataGA4.banner_type=2;dataGA4.country_id=eDt.web_data.location_id;dataGA4.country_name=eDt.web_data.location_name;dataGA4.sport_id=eDt.web_data.sport_id;dataGA4.sport_name=eDt.web_data.sport_name;dataGA4.tournament_id=eDt.web_data.tournament_id;dataGA4.tournament_name=eDt.web_data.tournament_name}else if(self.widget.content_data&&mappingBanner&&mappingBanner[bannerId]){dataGA4.country_id=mappingBanner[bannerId].location_id;dataGA4.country_name=mappingBanner[bannerId].location_name;dataGA4.sport_id=mappingBanner[bannerId].sport_id;dataGA4.sport_name=mappingBanner[bannerId].sport_name;dataGA4.tournament_id=mappingBanner[bannerId].tournament_id;dataGA4.tournament_name=mappingBanner[bannerId].tournament_name}}self.ga4Push(dataGA4)}}catch(err){}}ga4Push(data,loop=0){var self=this;if(self.googleTagManagerId){if(!window.dataLayerBanner){if(20>loop){setTimeout(function(){loop++;self.ga4Push(data,loop)},500)}}else{var ga4Param=self.widget_id+"-"+data.banner_id+"-"+data.event_id+"-"+data.market_short_id;if("undefined"===typeof self.GA4_PUSH_CACHE){self.GA4_PUSH_CACHE=[]}if(window.dataLayerBanner&&("Clicks"===data.event||"Views"===data.event&&!self.GA4_PUSH_CACHE.includes(ga4Param))){window.dataLayerBanner.push(function(){this.reset()});window.dataLayerBanner.push(data);if("Views"===data.event){self.GA4_PUSH_CACHE.push(ga4Param)}}}}}_sendGA(bannerId){var self=this,sendGA=!1;if(bannerId){var lsParam=self.positionTag+"-"+self.pageTag+"-"+self.loggedIn+"-"+self.eventId.toString(),ls=self.lsGet("bmfe:"+self.language+"-"+lsParam,"json");try{if(Object.keys(ls).length){if("undefined"!==typeof ls[bannerId]&&ls[bannerId].data){if(!ls[bannerId].data.ga||ls[bannerId].data.ga&&dayjs(dayjs()).isAfter(ls[bannerId].data.ga)){sendGA=!0;ls[bannerId].data.ga=dayjs().endOf("day").toLocaleString("en-US");self.lsSet("bmfe:"+self.language+"-"+lsParam,JSON.stringify(ls))}}}}catch(err){}}return sendGA}handleOdd(detail,event,bannerId,position,page,sport_id,country_id,tournament_id,event_id,bet_id,market_id){var self=this,oldActiveBettingOffers=self.activeBettingOffers;if("undefined"!==typeof detail.getAttribute("data-event")&&"undefined"!==typeof detail.getAttribute("data-offer")){let iframe0=window.document.getElementById(self.iframeTarget);if(null===iframe0){var eventClick=new CustomEvent("onOddsClick",{detail:{eventId:detail.getAttribute("data-event"),bettingOfferId:detail.getAttribute("data-offer"),odd:"undefined"!==typeof detail.getAttribute("data-price")?detail.getAttribute("data-price"):""}});window.dispatchEvent(eventClick,{bubbles:!0,cancelable:!0})}else{iframe0.contentWindow.postMessage({type:"OMFE:addSelectionToBetslip",payload:{eventId:detail.getAttribute("data-event"),bettingOfferId:detail.getAttribute("data-offer"),odd:"undefined"!==typeof detail.getAttribute("data-price")?detail.getAttribute("data-price"):""}},"*")}}if("undefined"!==typeof detail.getAttribute("data-event")&&"undefined"!==typeof bet_id){if(!oldActiveBettingOffers.includes(bet_id)){self.recordClick(bannerId,position,page,sport_id,country_id,tournament_id,event_id,bet_id,market_id,detail)}}event.stopPropagation();if("mobile"==self.nowScreen&&self.widget_position_id&&["1","2"].includes(self.widget_position_id.toString())&&self.slider_setting.close_bottom_mobile){self.closePanel("0")}}closeSelectPopup(){var self=this;self.showSelectPopup="false"}selectClosePanel(){var self=this;if("streaming"==self.bannerType&&self.sportbookId){self.removeStream(!0);return!1}if(self.widget_position_id&&["1","2"].includes(self.widget_position_id.toString())){if("undefined"!==typeof self.slider_setting.close_forever&&self.slider_setting.close_forever){self.closeForever()}else{if(self.slider_setting.close_option){self.showSelectPopup="true"}else{self.showSelectPopup="false";self.closePanel("0")}}}else{self.showSelectPopup="false"}return!1}closeForever(){var self=this,tag=self.positionTag+"-"+self.pageTag,lsBlockPF=self.lsGet("bmfe:blockpopupForever","json");if("undefined"!==typeof lsBlockPF.positions){lsBlockPF.positions.push(tag);lsBlockPF.positions=[...new Set(lsBlockPF.positions)];self.lsSet("bmfe:blockpopupForever",JSON.stringify(lsBlockPF))}self.style.display="none";self.resetWidget()}closePanel(duration){var self=this;self.use_timeout=0;self.closeSelectPopup();var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0;if("undefined"===typeof eDt||"undefined"!==typeof eDt&&"undefined"===typeof eDt.web_data){self.style.display="none";self.resetWidget();return!1}var wDt=eDt.web_data,bannerId=self.bannerId?self.bannerId:wDt.banner_id,eid=self.eid?self.eid:wDt.event_id,cacheName=self.genCacheName(wDt.type_id,bannerId,eid,self.language),ls=self.lsGet("bmfe:events","json");if("undefined"!==typeof ls[cacheName]&&6!==wDt.type_id){delete ls[cacheName]}self.lsSet("bmfe:events",JSON.stringify(ls));self.set("text.status_id","");var thisHash=wDt.hash;self.resetWidget();self.last_hash[self.widget_id].push(wDt.hash);if(self.widget_position_id&&["1","2"].includes(self.widget_position_id.toString())){if("0"==duration){var lsBlockP=self.lsGet("bmfe:blockpopup","json"),iLogin=lsBlockP.login,iLogout=lsBlockP.logout;if(100<iLogin.length){iLogin.splice(0,1)}if(100<iLogout.length){iLogout.splice(0,1)}if("true"==self.loggedIn){iLogin.push(thisHash)}else{iLogout.push(thisHash)}iLogin=JSON.stringify(Array.from(new Set(iLogin)));iLogout=JSON.stringify(Array.from(new Set(iLogout)));self.lsSet("bmfe:blockpopup","{\"logout\":"+iLogout+", \"login\":"+iLogin+"}");self.startLoad()}else{var lsBlockPL=self.lsGet("bmfe:blockpopupLimit","json"),expireDate="";if("1d"==duration){expireDate=dayjs().add(1,"day").toLocaleString("en-US")}else if("7d"==duration){expireDate=dayjs().add(7,"day").toLocaleString("en-US")}else if("30d"==duration){expireDate=dayjs().add(30,"day").toLocaleString("en-US")}if(expireDate){if(null!=lsBlockPL&&"undefined"!==typeof lsBlockPL){(async()=>{var newBlockPL=[];await Promise.all([lsBlockPL.forEach((item,i)=>{if(dayjs(dayjs()).isBefore(item.expireDate)){newBlockPL.push(item)}})]).then(pData=>{newBlockPL.push({hash:self.language+"-"+self.positionTag,expireDate:expireDate});self.lsSet("bmfe:blockpopupLimit",JSON.stringify(newBlockPL));self.startLoad()})})()}}else{self.startLoad()}}}}getEventLs(cacheName){var self=this,ls=self.lsGet("bmfe:events","json");return"undefined"!==typeof ls[cacheName]?ls[cacheName]:null}setEventLs(key,type,data,update=!1){if(!data){return!1}var self=this,lsEvents=self.lsGet("bmfe:events","json");if("undefined"===typeof lsEvents[key]){lsEvents[key]={}}var arr=[];if("action_outcome"==type){arr=["type_id","widget_layout","image_banner_set","background_image_transperent","background_color","content","title","homeName","awayName","time","eventId","eventName","statusId","statusName","partName","bettingTypeId","action_outcome","devices","location_id","location_name","sport_id","sport_name","tournament_id","tournament_name","marketname","marketsColumn","labelName","labelStyle"]}else if("partName"==type){arr=["partName"]}else if("eventLink"==type){arr=["partName","generate_target","eventLink"]}if(arr.length){(async()=>{await Promise.all([arr.forEach((item,i)=>{if(update){lsEvents[key][item]=data[item]?data[item]:lsEvents[key][item]}else{lsEvents[key][item]=data[item]}})]).then(pData=>{if("action_outcome"==type){if("undefined"!==typeof self.arrEvent[data.eventId]&&"undefined"!==typeof self.arrEvent[data.eventId].venueName){lsEvents[key].location_id=self.arrEvent[data.eventId].venueId;lsEvents[key].location_name=self.arrEvent[data.eventId].venueName}}self.lsSet("bmfe:events",JSON.stringify(lsEvents))})})()}}firstRender(milliseconds,outcomeArr,action_outcome,select_market,data){var self=this,bettingTypeId=data.bettingTypeId,eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,wDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.web_data?eDt.web_data:{},bDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.banner_data?eDt.banner_data[0]:{},cacheOutcome="",bt_disable=[];if(1==self.text.status_id&&"undefined"!==typeof bDt.markets_outcome_disable[data.id]){bt_disable=bDt.markets_outcome_disable[data.id]}if(2==self.text.status_id&&"undefined"!==typeof bDt.markets_live_outcome_disable[data.id]){bt_disable=bDt.markets_live_outcome_disable[data.id]}(async()=>{var market_id=data.bettingTypeId+"_"+data.eventPartId;await Promise.all([data.selections.forEach((item,i)=>{if(item.id&&-1==bt_disable.indexOf(item.id)&&("undefined"===typeof item.disable||"undefined"!==typeof item.disable&&!item.disable)){var name=self.getText(item.translationKey),showprice=self.getNumber(item.price,2),showpriceA=showprice,btnDisable="",reSportId=wDt.sport_id,reLocationId=wDt.location_id,reEventId=wDt.event_id,reTournamentId=wDt.tournament_id;if(4==wDt.type_id||6==wDt.type_id){if("undefined"!==typeof self.listPopular.event[item.eventId]){reSportId=self.listPopular.event[item.eventId].sport_id;reLocationId=self.listPopular.event[item.eventId].location_id;reEventId=item.eventId;reTournamentId=self.listPopular.event[item.eventId].parentId}}var active=!1;if(item.available&&1==item.statusId&&"undefined"!==typeof item.price&&"undefined"!==typeof showprice&&"undefined"!==showprice&&showprice){if("2"==self.text.status_id||"3"==self.text.status_id){showprice="&nbsp;"}active=!0}else{if(item.statusId&&["4","7"].includes(item.statusId.toString())||""==showprice){if(""==showprice||"7"!=item.statusId){showprice="&nbsp;"}if("4"==item.statusId){btnDisable=" btnRemoved"}else if("7"==item.statusId){btnDisable=" btnSuspended"}}showpriceA=showprice}var btn="<button class=\"bgButton bgButton2\" id=\"outcome_"+item.outcomeId+"\" onclick=\"this.getRootNode().host.handleOdd(this,event,'"+wDt.banner_id+"', '"+self.positionTag+"', '"+self.pageTag+"', '"+reSportId+"', '"+reLocationId+"', '"+reTournamentId+"', '"+reEventId+"', '"+item.outcomeId+"', '"+market_id+"')\" data-event=\""+item.eventId+"\" data-offer=\""+item.id+"\" data-bettypeid=\""+item.bettingTypeId+"\" data-price=\""+item.price+"\" data-timestamp=\""+milliseconds+"\" data-role=\""+item.role+"\" data-outcome-name=\""+item.translationKey+"\" data-market=\""+data.id+"\"><div class=\"oddButton\"><div class=\"oddButtonName\">"+name+"</div><div class=\"oddButtonValue\"><span class=\"odv\" id=\""+item.outcomeId+"\">"+showpriceA+"</span></div></div></button>",disBtn="<button disabled class=\"bgButton bgButton2 btnDisable"+btnDisable+"\" id=\"outcome_"+item.outcomeId+"\" onclick=\"this.getRootNode().host.handleOdd(this,event,'"+wDt.banner_id+"', '"+self.positionTag+"', '"+self.pageTag+"', '"+reSportId+"', '"+reLocationId+"', '"+reTournamentId+"', '"+reEventId+"', '"+item.outcomeId+"', '"+market_id+"')\" data-event=\""+item.eventId+"\" data-offer=\""+item.id+"\" data-bettypeid=\""+item.bettingTypeId+"\" data-price=\""+item.price+"\" data-timestamp=\""+milliseconds+"\" data-role=\""+item.role+"\" data-outcome-name=\""+item.translationKey+"\" data-market=\""+data.id+"\"><div class=\"oddButton\"><div class=\"oddButtonName\">"+name+"</div><div class=\"oddButtonValue\"><span class=\"odv\" id=\""+item.outcomeId+"\">"+showprice+"</span></div></div></button>";if(active){action_outcome+=btn}else{action_outcome+=disBtn}cacheOutcome+=disBtn}})]).then(pData=>{self.loadingFallback=!1;self.$.slidebanner.innerHTML=action_outcome;if(self.tid&&!["4","6"].includes(self.tid.toString())){self.set("text.event_id",wDt.event_id);self.set("text.event_name",wDt.event_name);self.set("text.status_id",wDt.status_id)}var bannerId=self.bannerId?self.bannerId:wDt.banner_id,eid=self.eid?self.eid:wDt.event_id,cacheName=self.genCacheName(wDt.type_id,bannerId,eid,self.language);if(""===self.bannerId&&0!=self.widget_position_id){self.tid=wDt.type_id;var sendGA=self._sendGA(wDt.banner_id);if(sendGA){var dataPopupGA4={event:"Views",operator_id:self.operatorId,banner_id:wDt.banner_id,banner_language:self.language,banner_page:self.pageTag,banner_position:self.positionTag,banner_type:wDt.type_id,em_id:"true"==self.loggedIn&&self.emUserId&&"undefined"!=self.emUserId?btoa(self.emUserId):"",sport_id:self.text.sportId,sport_name:self.text.sportName,country_id:self.text.countryId,country_name:self.text.countryName,tournament_id:self.text.tournamentId,tournament_name:self.text.tournamentName,market_id:data.id,market_name:data.name,market_short_id:data.bettingTypeId+"_"+data.eventPartId,event_id:("6"==self.tid?self.text.event_id:wDt.event_id)||self.text.event_id,event_match_name:("6"==self.tid?self.text.event_name:wDt.event_name)||self.text.event_name,outcome_id:"",outcome_key:"",outcome_name:""};self.ga4Push(dataPopupGA4)}}self.setActiveOdd();if("9"==self.widget_layout){if(self.marketsColumn&&self.marketsColumn.length){let ocID=self.marketsColumn.map(ocI=>ocI.id);var topic="/sports#totalBetsForOutcomes",tmpTopic=topic+"/"+ocID.join("/"),isClone=self.parentNode.classList.contains("splide__slide--clone")&&self.fromInclude;if(isClone){if("undefined"!==typeof self.WEB_API_CACHE[tmpTopic]&&"undefined"!==typeof self.WEB_API_CACHE[tmpTopic].response){self.totalBetRes(cacheName,{kwargs:self.WEB_API_CACHE[tmpTopic]})}else{if("undefined"!==typeof self.dumpTotalBetsListener){self.removeEventListener("topicListen:initialDump",self.dumpTotalBetsListener)}self.dumpTotalBetsListener=self.dumpTotalBets.bind(self,tmpTopic,cacheName);self.addEventListener("topicListen:initialDump",self.dumpTotalBetsListener)}}else{self.ws_session.call(topic,[],{outcomeIds:ocID}).then(function(res){if(res){self.totalBetRes(cacheName,res);self.customEventTopic("topic:initialDump",tmpTopic,res.kwargs)}})}}}self.set("text.marketid",data.id);self.set("text.marketname",data.name);self.set("text.marketShortId",data.bettingTypeId+"_"+data.eventPartId);self.setEventLs(cacheName,"action_outcome",{widget_layout:self.widget_layout,image_banner_set:bDt.banner_image,background_image_transperent:bDt.background_image_transperent,background_color:bDt.background_color,content:self.text.content,title:self.text.title,homeName:self.text.homeName,awayName:self.text.awayName,time:self.text.time,eventId:("6"==self.tid?self.text.event_id:wDt.event_id)||self.text.event_id,eventName:("6"==self.tid?self.text.event_name:wDt.event_name)||self.text.event_name,statusId:("6"==self.tid?self.text.status_id:wDt.status_id)||self.text.status_id,statusName:self.text.status,partName:self.text.partName,devices:wDt.devices,location_id:wDt.location_id||self.text.countryId,location_name:wDt.location_name||self.text.countryId,sport_id:self.text.sportId,sport_name:self.text.sportName,tournament_id:self.text.tournamentId,tournament_name:self.text.tournamentName,action_outcome:cacheOutcome,marketname:self.text.marketname,labelName:self.text.labelName,labelStyle:self.text.labelStyle,bettingTypeId:bettingTypeId,type_id:bDt.type_id});if(1==bDt.display_time_status){if(0<bDt.display_time){self.widgetTimeout=bDt.display_time;self.checkTimeout(bDt.banner_id)}}self.onResize()})})()}dumpTotalBets(topic,cacheName,dataE){var self=this;if(dataE.detail&&dataE.detail.topic==topic){self.totalBetRes(cacheName,{kwargs:dataE.detail.kwargs})}}totalBetRes(cacheName,res){var self=this;if(res&&res.kwargs&&res.kwargs.response){self.marketsColumn=self.marketsColumn.map(function(ocI){return{...ocI,value:res.kwargs.response[ocI.id]&&res.kwargs.response[ocI.id].percentage?res.kwargs.response[ocI.id].percentage:0,class:""}});self.setEventLs(cacheName,"action_outcome",{marketsColumn:self.marketsColumn},!0)}}checkTimeout(bannerId){var self=this;if(0>=self.widgetTimeout){return!1}self.waitCTimeout=!0;self.waitTRun=setTimeout(function(){self.waitCTimeout=!1;self.set("text.status_id","");self.disableBanner("",bannerId);var lsParam=self.positionTag+"-"+self.pageTag+"-"+self.loggedIn+"-"+self.eventId.toString();self.lsDelete("bmfe:"+self.language+"-"+lsParam);self.resetWidget();self.startLoad()},1e3*self.widgetTimeout)}wsChange(kwargs){var self=this;if(kwargs&&kwargs.records){if("UPDATE"==kwargs.messageType&&kwargs.records.length){var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,wDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.web_data?eDt.web_data:{},tid=wDt.type_id?wDt.type_id.toString():"",bannerId=self.bannerId?self.bannerId:wDt.banner_id,eid=self.eid?self.eid:wDt.event_id,cacheName=self.genCacheName(wDt.type_id,bannerId,eid,self.language);kwargs.records.forEach(function(value,key){if("EVENT_INFO"==value.entityType){if("UPDATE"==value.changeType&&"undefined"!==typeof value.changedProperties){if(value.id==self.text.time_id){if("undefined"!==typeof value.changedProperties.paramFloat1){var prefix="";if(self.widget_layout&&!["2","4","7","8"].includes(self.widget_layout.toString())){prefix=", "}var minute=value.changedProperties.paramFloat1.toString().replace(".0","");self.set("text.minute",prefix+minute+"'");self.minsec(minute)}else if("undefined"===typeof value.changedProperties.paramFloat1&&"undefined"!==typeof value.changedProperties.paramFloat2){}else{self.set("text.minute","");self.resetMinsec()}}}}else if("MATCH"==value.entityType){if("UPDATE"==value.changeType&&"undefined"!==typeof value.changedProperties){if(!["7","8","9"].includes(tid)){if("undefined"!==typeof value.changedProperties.startTime){self.set("text.time",self.getDateFormat(value.changedProperties.startTime))}}if("undefined"!=typeof value.changedProperties.currentPartId&&"undefined"!=typeof value.changedProperties.currentPartName){var tDt=value.changedProperties;self.breakTime=tDt.currentPartId;self.set("text.partName",tDt.currentPartName);self.setEventLs(cacheName,"partName",{partName:tDt.currentPartName})}if(value.id&&"undefined"!=typeof value.changedProperties.statusId){if("2"==value.changedProperties.statusId){if("6"==self.tid){self.disableFallback=!0;setTimeout(function(){self.rmCacheE();self.resetWidget();self.startLoad();return!1},1e4)}else{setTimeout(function(){try{delete self.ws_event[value.id];self.widget.events_list[0].banner_data[0].status_id=2}catch(err){}self.set("text.event_id",value.id);self.set("text.status_id","2");if("undefined"!==typeof self.subscribeWsMinute.id&&self.subscribeWsMinute.active){try{self.ws_session.unregister(self.subscribeWsMinute)}catch(err){self.subscribeWsMinute={}}}if("undefined"!==typeof self.subscribeOdds.id&&self.subscribeOdds.active){try{self.ws_session.unregister(self.subscribeOdds)}catch(err){self.subscribeOdds={}}}if("undefined"!==typeof self.subscribeScore.id&&self.subscribeScore.active){try{self.ws_session.unregister(self.subscribeScore)}catch(err){self.subscribeScore={}}}self.resetWidget();self.startLoad();return!1},1e4)}}else if("3"==value.changedProperties.statusId){try{delete self.ws_event[value.id];self.widget.events_list[0].banner_data[0].status_id=3}catch(err){}self.set("text.status_id","");self.disableRmR("",bannerId,"");self.startLoad();return!1}}}else if("DELETE"==value.changeType){if(!["7","8","9"].includes(tid)){if(value.id==self.text.event_id){if("6"==self.tid){if("undefined"!==typeof self.subscribePopular.id&&self.subscribePopular.active){try{self.ws_session.unregister(self.subscribePopular)}catch(err){self.subscribePopular={}}}self.rmCacheE()}else{self.rmCacheEByName(cacheName)}self.resetWidget();self.startLoad()}}}}else if("BETTING_OFFER"==value.entityType&&"UPDATE"==value.changeType){if("undefined"!==typeof value.changedProperties.statusId){self.updateListPopular("BETTING_OFFER",value.id,value.changedProperties.statusId,"statusId")}if("undefined"!==typeof value.changedProperties.odds){self.updateListPopular("BETTING_OFFER",value.id,value.changedProperties.odds,"odds");if(null!=self.listInterval&&self.listInterval.data.length){self.listInterval.data.forEach(function(item,i){item.selections.forEach(function(item2,i2){if(item2.id==value.id){try{self.listInterval.data[i].selections[i2].price=value.changedProperties.odds}catch(err){}}})})}if(["7","8","9"].includes(tid)&&self.offerList){self.offerList.forEach((item,i)=>{if(item.id==value.id){try{self.offerList[i].odds=value.changedProperties.odds}catch(err){}}})}(async()=>{await Promise.all([self.shadowRoot.querySelectorAll(".bgButton2").forEach(function(x){if(x.getAttribute("data-offer")==value.id){var eId=x.getAttribute("id"),olddata=x.getAttribute("data-price"),newdata=value.changedProperties.odds,statusOdd=newdata>olddata?"up":newdata<olddata?"down":"";if(statusOdd){if(null!==self.shadowRoot.getElementById(eId)){var showprice=self.getNumber(newdata,2);if(value.changedProperties.statusId&&["4","7"].includes(value.changedProperties.statusId.toString())||""==showprice){if(""==showprice||"7"!=value.changedProperties.statusId){showprice="&nbsp;"}}x.querySelector(".odv").innerHTML=showprice;self.shadowRoot.getElementById(eId).setAttribute("data-price",value.changedProperties.odds);self.shadowRoot.getElementById(eId).setAttribute("data-timestamp",value.changedProperties.lastChangedTime);self.shadowRoot.getElementById(eId).classList.remove("btRed");self.shadowRoot.getElementById(eId).classList.remove("btGreen");self.shadowRoot.getElementById(eId).classList.add("up"==statusOdd?"btGreen":"btRed");self.shadowRoot.getElementById(eId).classList.add("ws"+eId);if(self.bettingClass[eId+self.widget_id]){clearTimeout(self.bettingClass[eId]);self.bettingClass[eId+self.widget_id]=null}self.bettingClass[eId+self.widget_id]=setTimeout(function(){if(null!==self.shadowRoot.getElementById(eId)){self.shadowRoot.querySelectorAll(".ws"+eId).forEach(function(z){z.classList.remove("up"==statusOdd?"btGreen":"btRed");z.classList.remove("ws"+eId)})}},5e3);var couponId="offer_"+value.id;if(["7","8","9"].includes(tid)&&null!==self.shadowRoot.getElementById(couponId)){self.shadowRoot.getElementById(couponId).setAttribute("data-odds",value.changedProperties.odds);self.handleCouponCheckboxChange()}}}}})]).then(pData=>{})})()}if("undefined"!==typeof value.changedProperties.isLive&&value.changedProperties.isLive&&["7","8","9"].includes(tid.toString())){if(9!=tid){var cacheName=self.genCacheName(tid,wDt.banner_id,"",self.language);self.disableRmR("",wDt.banner_id,cacheName);if(self.widget_position_id&&["1","2","3"].includes(self.widget_position_id.toString())){self.startLoad()}}}if("undefined"!==typeof value.changedProperties.isAvailable){self.updateListPopular("BETTING_OFFER",value.id,value.changedProperties.isAvailable,"isAvailable");if(null!=self.listInterval&&self.listInterval.data.length){self.listInterval.data.forEach(function(item,i){item.selections.forEach(function(item2,i2){if(item2.id==value.id){try{self.listInterval.data[i].selections[i2].available=value.changedProperties.isAvailable}catch(err){}}})})}if(["7","8","9"].includes(tid)){self.setOfferList(self.offerList,tid,value)}else{if(value.changedProperties.isAvailable){(async()=>{await Promise.all([self.shadowRoot.querySelectorAll(".bgButton2").forEach(function(x){if(x.getAttribute("data-offer")==value.id){if("1"==value.changedProperties.statusId){x.classList.remove("btnDisable");x.classList.remove("btnRemoved");x.classList.remove("btnSuspended");x.removeAttribute("disabled")}else{x.classList.add("btnDisable");if("4"==value.changedProperties.statusId){x.classList.add("btnRemoved")}else if("7"==value.changedProperties.statusId){x.classList.add("btnSuspended")}x.setAttribute("disabled","")}}})]).then(pData=>{})})()}else{(async()=>{await Promise.all([self.shadowRoot.querySelectorAll(".bgButton2").forEach(function(x){if(x.getAttribute("data-offer")==value.id){if(value.changedProperties.statusId&&["4","7"].includes(value.changedProperties.statusId.toString())){if("7"!=value.changedProperties.statusId){x.querySelector(".odv").innerHTML="&nbsp;"}if("4"==value.changedProperties.statusId){x.classList.add("btnRemoved")}else if("7"==value.changedProperties.statusId){x.classList.add("btnSuspended")}}x.classList.add("btnDisable");x.setAttribute("disabled","")}})]).then(pData=>{var open=0,close=0;(async()=>{await Promise.all([self.shadowRoot.querySelectorAll(".bgButton2").forEach(function(x){if(x.classList.contains("btnDisable")){close++}else{open++}})]).then(pData1=>{if(0==open&&"undefined"!==typeof eDt&&"undefined"!==typeof eDt.banner_data&&!self.loadingFallback){self.loadingFallback=!0;if("6"!=tid){var bDt=eDt.banner_data[0],status="",market=[];if(1==bDt.status_id){status="NOT_LIVE";market=bDt.markets}else if(2==bDt.status_id){status="LIVE";market=bDt.markets_live}var eventFilter=self.checkMarket(status,market,!1);eventFilter.then(data_fallback=>{if(data_fallback.successful){if("undefined"===typeof data_fallback.data[0]){var iLoop=0;if(self.waitFallback){clearInterval(self.waitFallback);self.waitFallback={}}self.waitFallback=setInterval(function(){iLoop++;var eventFilter_wait=self.checkMarket(status,market,!1);eventFilter_wait.then(data_fallback_wait=>{if(data_fallback_wait.successful&&data_fallback_wait.data.length){self.fallbackAction(bDt.event_id,data_fallback_wait);clearInterval(self.waitFallback)}else{if(30<=iLoop){var lsParam=self.positionTag+"-"+self.pageTag+"-"+self.loggedIn+"-"+self.eventId.toString();self.lsDelete("bmfe:"+self.language+"-"+lsParam);self.disableRmR("",self.bannerId,"");self.startLoad();clearInterval(self.waitFallback)}}}).catch(err=>{if(30<=iLoop){clearInterval(self.waitFallback)}})},1e4);self.$.slideSource.classList.add("fadebanner");self.getEventDetail(eventId)}else{self.fallbackAction(bDt.event_id,data_fallback)}}}).catch(err=>{})}else{if(!self.disableFallback){if("undefined"!==typeof self.subscribePopular.id&&self.subscribePopular.active){try{self.ws_session.unregister(self.subscribePopular)}catch(err){self.subscribePopular={}}}self.rmCacheE();self.resetWidget();self.startLoad()}}}})})()})})()}}}}})}}}wsScoreChange(sportId,kwargs){var self=this;if(kwargs&&kwargs.records&&kwargs.records.length){var filterScore=[];(async()=>{await Promise.all([kwargs.records.forEach((item,i)=>{if("1"==item.eventInfoTypeId){filterScore.push(item)}else if("2"==item.eventInfoTypeId){if(self.last_yellow_card!=JSON.stringify({awayScore:item.awayScore,homeScore:item.homeScore})){var oldyellowcard=JSON.parse(self.last_yellow_card);if(null!=oldyellowcard){if(item.homeScore!=oldyellowcard.homeScore){self.marketIncident("home","2")}else{self.marketIncident("away","2")}}self.last_yellow_card=JSON.stringify({awayScore:item.awayScore,homeScore:item.homeScore})}}else if("4"==item.eventInfoTypeId){if(self.last_red_card!=JSON.stringify({awayScore:item.awayScore,homeScore:item.homeScore})){var oldredcard=JSON.parse(self.last_red_card);if(null!=oldredcard){if(item.homeScore!=oldredcard.homeScore){self.marketIncident("home","3")}else{self.marketIncident("away","3")}}self.last_red_card=JSON.stringify({awayScore:item.awayScore,homeScore:item.homeScore})}}else if("9"==item.eventInfoTypeId){if(self.last_corner!=JSON.stringify({awayScore:item.awayScore,homeScore:item.homeScore})){var oldcorner=JSON.parse(self.last_corner);if(null!=oldcorner){if(item.homeScore!=oldcorner.homeScore){self.marketIncident("home","4")}else{self.marketIncident("away","4")}}self.last_corner=JSON.stringify({awayScore:item.awayScore,homeScore:item.homeScore})}}})]).then(pData=>{self.filterEventPart("update",filterScore,sportId)})})()}}callWsScore(eventId,sportId){var self=this;if("offerlibrary"==self.apiMethod){}else{if("2"==self.text.status_id){var topic="/sports/"+self.operatorId+"/"+self.language+"/"+eventId+"/eventPartScores/large";if(-1!=["5","49"].indexOf(sportId.toString())){topic="/sports/"+self.operatorId+"/"+self.language+"/"+eventId+"/eventPartScores/highlighted"}var isClone=self.parentNode.classList.contains("splide__slide--clone")&&self.fromInclude;if(isClone){if("undefined"!==typeof self.WEB_API_CACHE[topic]&&"undefined"!==typeof self.WEB_API_CACHE[topic].records){self.scoresRes(sportId,{kwargs:self.WEB_API_CACHE[topic]})}else{if("undefined"!==typeof self.dumpScoresListener){self.removeEventListener("topicListen:initialDump",self.dumpScoresListener)}self.dumpScoresListener=self.dumpScores.bind(self,topic,sportId);self.addEventListener("topicListen:initialDump",self.dumpScoresListener)}if("undefined"!==typeof self.regScoresListener){self.removeEventListener("topicListen:register",self.regScoresListener)}self.regScoresListener=self.regScores.bind(self,topic,sportId);self.addEventListener("topicListen:register",self.regScoresListener)}else{if("undefined"!==typeof self.subscribeScore.id&&self.subscribeScore.active){try{self.ws_session.unregister(self.subscribeScore)}catch(err){self.subscribeScore={}}}self.ws_session.register(topic,function(args,kwargs,details){self.wsScoreChange(sportId,kwargs);self.customEventTopic("topic:register",topic,kwargs)}).then(function(regId){self.subscribeScore=regId;self.ws_session.call("/sports#initialDump",[],{topic:topic}).then(function(res){self.scoresRes(sportId,res);self.customEventTopic("topic:initialDump",topic,res.kwargs)})})}}}}regScores(topic,sportId,dataE){var self=this;if(dataE.detail&&dataE.detail.topic==topic){self.wsScoreChange(sportId,dataE.detail.kwargs)}}dumpScores(topic,sportId,dataE){var self=this;if(dataE.detail&&dataE.detail.topic==topic){self.scoresRes(sportId,{kwargs:dataE.detail.kwargs})}}scoresRes(sportId,res){var self=this;if(res&&res.kwargs&&res.kwargs.records&&res.kwargs.records.length){var filterScore=[];(async()=>{await Promise.all([res.kwargs.records.forEach((item,i)=>{if("1"==item.eventInfoTypeId){filterScore.push(item)}else if("2"==item.eventInfoTypeId){if(null==self.last_yellow_card){self.last_yellow_card=JSON.stringify({awayScore:item.awayScore,homeScore:item.homeScore})}}else if("4"==item.eventInfoTypeId){if(null==self.last_red_card){self.last_red_card=JSON.stringify({awayScore:item.awayScore,homeScore:item.homeScore})}}else if("9"==item.eventInfoTypeId){if(null==self.last_corner){self.last_corner=JSON.stringify({awayScore:item.awayScore,homeScore:item.homeScore})}}})]).then(pData=>{self.filterEventPart("show",filterScore,sportId)})})()}}fallbackAction(eventId,data_event){var self=this;self.ws_event[eventId]=data_event;var dt=data_event.data[0];self.backupMarketName=dt.name;self.set("text.marketname",self.getText(dt.name));self.set("text.labelName","");self.set("text.labelStyle","");var select_market=dt.id,milliseconds=new Date().getTime();self.firstRender(milliseconds,[],"",select_market,dt)}resetIncident(){var self=this;self.incident_market_id="";self.incident_event_id="";clearTimeout(self.waitTIncidentClose);clearTimeout(self.waitTShowName);clearTimeout(self.waitTDelayIncident);clearInterval(self.waitRepeat);self.waitTIncidentClose={};self.waitTShowName={};self.set("text.marketname",self.getText(self.backupMarketName));self.set("text.labelName","");self.set("text.labelStyle","");self.$.incident_button.style.display="none";self.$.incident_button.innerHTML="";self.$.slidebanner.style.display="flex";var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,bDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.banner_data?eDt.banner_data[0]:{};if(2==bDt.status_id&&0==bDt.markets_live.length&&1==bDt.incident_status&&self.widget_position_id&&["1","2"].includes(self.widget_position_id.toString())){self.$.slideSource.classList.remove("fadebanner")}}renderIncidentAction(data,dataMarketList,team_type,incident_type){var self=this;if(data.successful){var action_outcome="",milliseconds=new Date().getTime(),display_time=1e3*3600;if("undefined"!==typeof dataMarketList.display_time&&dataMarketList.display_time&&"0"!=dataMarketList.display_time){display_time=1e3*dataMarketList.display_time}var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,wDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.web_data?eDt.web_data:{},dt=data.data[0],market_id=dt.bettingTypeId+"_"+dt.eventPartId;(async()=>{await Promise.all([dt.selections.forEach((item,i)=>{var name=self.getText(item.translationKey),showprice=self.getNumber(item.price,2),btnDisable="",active=!1;if(item.available&&"1"==item.statusId&&"undefined"!=typeof item.price&&"undefined"!==typeof showprice&&"undefined"!==showprice&&showprice){active=!0}else{if(item.statusId&&["4","7"].includes(item.statusId.toString())||""==showprice){if(""==showprice||"7"!=item.statusId){showprice="&nbsp;"}if("4"==item.statusId){btnDisable=" btnRemoved"}else if("7"==item.statusId){btnDisable=" btnSuspended"}}}var btn="<button"+(active?"":" disabled")+" class=\"bgButtonIncident bgButton2"+(active?"":" btnDisable"+btnDisable)+"\" id=\"outcome_incident_"+item.outcomeId+"\" onclick=\"this.getRootNode().host.handleOdd(this,event,'"+wDt.banner_id+"', '"+self.positionTag+"', '"+self.pageTag+"', '"+wDt.sport_id+"', '"+wDt.location_id+"', '"+wDt.tournament_id+"', '"+wDt.event_id+"', '"+item.outcomeId+"', '"+market_id+"')\" data-event=\""+item.eventId+"\" data-offer=\""+item.id+"\" data-bettypeid=\""+item.bettingTypeId+"\" data-price=\""+item.price+"\" data-timestamp=\""+milliseconds+"\" data-role=\""+item.role+"\"><div class=\"oddButton\"><div class=\"oddButtonName\">"+name+"</div> <div class=\"oddButtonValue\"><span class=\"odv\" id=\"odv_incident_"+item.outcomeId+"\">"+showprice+"</span></div></div></button>";action_outcome+=btn})]).then(pData=>{var action_name="",team_name="";if("undefined"!=typeof self.ws_event[wDt.event_id]){if("home"==team_type){team_name=self.ws_event[wDt.event_id].homeShortParticipantName}else if("away"==team_type){team_name=self.ws_event[wDt.event_id].awayShortParticipantName}}if("undefined"!=typeof self.slider_setting.translate_incident[self.language]){if("1"==incident_type){action_name=team_name+" "+self.slider_setting.translate_incident[self.language][0]}else if("2"==incident_type){action_name=team_name+" "+self.slider_setting.translate_incident[self.language][1]}else if("3"==incident_type){action_name=team_name+" "+self.slider_setting.translate_incident[self.language][2]}else if("4"==incident_type){action_name=team_name+" "+self.slider_setting.translate_incident[self.language][3]}}else if("undefined"==typeof self.slider_setting.translate_incident[self.language]&&"undefined"!=typeof self.slider_setting.translate_incident.en){if("1"==incident_type){action_name=team_name+" "+self.slider_setting.translate_incident.en[0]}else if("2"==incident_type){action_name=team_name+" "+self.slider_setting.translate_incident.en[1]}else if("3"==incident_type){action_name=team_name+" "+self.slider_setting.translate_incident.en[2]}else if("4"==incident_type){action_name=team_name+" "+self.slider_setting.translate_incident.en[3]}}else{if("1"==incident_type){action_name=team_name+" scores goal!"}else if("2"==incident_type){action_name=team_name+" booked yellow card!"}else if("3"==incident_type){action_name=team_name+" booked red card!"}else if("4"==incident_type){action_name=team_name+" awarded corner!"}}self.shadowRoot.querySelectorAll(".nameMarketRender").forEach(function(x){x.classList.add("opacity0")});self.set("text.marketname",self.getText(data.data[0].name));self.set("text.labelName","");self.set("text.labelStyle","");self.$.incident_button.innerHTML="<div class=\"show_action_incident\">"+action_name+"</div>";self.$.slidebanner.style.display="none";self.$.incident_button.style.display="flex";if(2==eDt.banner_data[0].status_id&&0==eDt.banner_data[0].markets_live.length&&1==eDt.banner_data[0].incident_status&&self.widget_position_id&&["1","2"].includes(self.widget_position_id.toString())){self.$.slideSource.classList.add("fadebanner");self.onResize()}if(self.waitTShowName){clearTimeout(self.waitTShowName);self.waitTShowName={}}self.waitTShowName=setTimeout(function(){self.shadowRoot.querySelectorAll(".nameMarketRender").forEach(function(x){x.classList.remove("opacity0")});self.$.incident_button.innerHTML=action_outcome;self.setActiveOdd();if(self.waitTIncidentClose){clearTimeout(self.waitTIncidentClose);self.waitTIncidentClose={}}self.waitTIncidentClose=setTimeout(function(){self.resetIncident()},display_time)},3e3)})})()}}repeatIncident(dataMarketList,query_status,eventId,query_market,team_type,incident_type){var self=this;if(self.waitRepeat){clearInterval(self.waitRepeat);self.waitRepeat={}}var i=1;self.waitRepeat=setInterval(function(){i++;var eventFilter=self.checkMarket(status,market,!0);eventFilter.then(data_fallback=>{if(data_fallback.successful){if("undefined"==typeof data_fallback.data[0]){if(36<=i){clearInterval(self.waitRepeat)}}else{clearInterval(self.waitRepeat);self.renderIncidentAction(data_fallback,dataMarketList,team_type,incident_type)}}else{if(36<=i){clearInterval(self.waitRepeat)}}}).catch(err=>{if(6<=i){clearInterval(self.waitRepeat)}})},5e3)}renderIncident(dataMarketList,team_type,incident_type){var self=this,eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,bDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.banner_data?eDt.banner_data[0]:{},eventId=eDt.web_data.event_id,status="LIVE",market=dataMarketList.marketList,eventFilter=self.checkMarket(status,market,!0);eventFilter.then(data_fallback=>{if(data_fallback.successful){if("undefined"==typeof data_fallback.data[0]){self.repeatIncident(dataMarketList,status,eventId,market,team_type,incident_type)}else{self.renderIncidentAction(data_fallback,dataMarketList,team_type,incident_type)}}else{self.ws_event[eventId]=null;self.hideSkeleton()}}).catch(err=>{self.repeatIncident(dataMarketList,status,eventId,market,team_type,incident_type)})}marketIncident(team_type,incident_type){var self=this;if(self.waitTDelayIncident){clearTimeout(self.waitTDelayIncident);self.waitTDelayIncident={}}self.waitTDelayIncident=setTimeout(function(){var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0;if("undefined"===typeof eDt||""==self.bannerId&&("undefined"===typeof eDt.web_data||"undefined"===typeof eDt.web_data.markets_incident||"undefined"!==typeof eDt.web_data.markets_incident&&0==eDt.web_data.markets_incident.length)){self.resetIncident()}else{var incident_json=eDt.web_data.markets_incident;(async()=>{var promises=[];await Promise.all([incident_json.forEach((item,i)=>{if(item.team_type.toLowerCase()==team_type.toLowerCase()){promises.push(item)}})]).then(pData=>{if(promises.length&&promises[0].data.length){var promises2=[];(async()=>{await Promise.all([promises[0].data.forEach((item,i)=>{if(incident_type==item.incident_id){promises2.push(item)}})]).then(pData=>{if(promises2.length&&promises2[0].pages.length){if("undefined"===typeof promises2[0].marketList){promises2[0].marketList=[]}promises2[0].pages.forEach((item2,i2)=>{promises2[0].marketList.push(item2.marketId)});self.renderIncident(promises2[0],team_type,incident_type)}})})()}})})()}},1e4)}getTextEvent(statusId){var txt=this.textEvent,txt_event=2==statusId?this.slider_setting.text_live_event:this.slider_setting.text_event;if(""==txt){txt=txt_event[this.language]?txt_event[this.language]:txt_event.en}return txt}getText(text){var self=this,separator="";if(self.slider_setting&&self.slider_setting.extra_config&&self.slider_setting.extra_config.separator){separator=self.slider_setting.extra_config.separator}if(text&&separator){return text.toString().replace(/([0-9])[.]([0-9])/g,`$1${separator}$2`)}else{return text}}translateText(){var self=this;if(self.slider_setting&&self.slider_setting.translate){if("undefined"!=typeof self.slider_setting.translate[self.language]){var allow=["liveText","couponSelect","couponTotal","couponAdd","couponAddBetslip"];allow.forEach(function(value,key){if(self.slider_setting.translate[self.language][value]){self.set(`text.${value}`,self.slider_setting.translate[self.language][value])}})}}}stripLink(url){var newUrl=url.replaceAll(".","").replaceAll(":","-").replaceAll(",","").replaceAll([" - "],"-").replaceAll(" ","-");newUrl=newUrl.replaceAll("/","-");newUrl=newUrl.replaceAll("--","-").toLowerCase();newUrl=newUrl.replaceAll("'","-");newUrl=newUrl.replaceAll("(","").replaceAll(")","");return newUrl}genLink(link,match){var self=this;if(link&&match){Object.keys(match).forEach(key=>{if(match[key]&&["string","number"].includes(typeof match[key])){link=link.replaceAll("${"+key+"}",self.stripLink(match[key].toString()))}});if(-1!=link.indexOf("${")){link=link.replaceAll("${shortSportName}","${sportName}");link=link.replaceAll("${shortVenueName}","${venueName}");link=link.replaceAll("${shortParentName}","${parentName}");link=link.replaceAll("${shortName}","${name}");Object.keys(match).forEach(key=>{if(match[key]&&["string","number"].includes(typeof match[key])){link=link.replaceAll("${"+key+"}",self.stripLink(match[key].toString()))}})}}return self.genLinkDomain(self.removeAccents(link))}genLinkDomain(link){var parentURL=window.location!=window.parent.location?document.referrer:document.location.hostname;parentURL=parentURL.replace(/http(s)?(:)?(\/\/)?|(\/\/)?\//g,"");link=link.replaceAll("${domain}",parentURL);return link}autoLink(match){var self=this,target_link="_top";if("undefined"!==typeof self.root_auto_link.target_link){target_link=self.root_auto_link.target_link}var param="/${sportId}/${shortSportName}/${shortVenueName}/${shortParentName}/${shortName}/${id}/";param=self.genLink(param,match);var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,wDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.web_data?eDt.web_data:{},bannerId=self.bannerId?self.bannerId:wDt.banner_id,eid=self.eid?self.eid:wDt.event_id,cacheName=self.genCacheName(wDt.type_id,bannerId,eid,self.language);if(""==self.root_auto_link||2==match.statusId&&""==self.root_auto_link.link_live||1==match.statusId&&""==self.root_auto_link.link){self.setEventLs(cacheName,"eventLink",{generate_link:!1,generate_target:target_link,eventLink:""});return!1}try{var link="";if(2==match.statusId){link=self.root_auto_link.link_live}else if(1==match.statusId){link=self.root_auto_link.link}link=("/"==link.substr(-1)?link.slice(0,-1):link)+param;link=self.genLinkDomain(link)}catch(err){return!1}self.setEventLs(cacheName,"eventLink",{generate_link:wDt.generate_link,generate_target:target_link,eventLink:wDt?link:""});self.$.buttonNavLayout.classList.add("showcursor");var btn_text="",btn="<div class=\"no_link_btn\"><br><button class=\"btLink btLink"+bannerId+"\" onclick=\"this.getRootNode().host.handleClick('"+link+"', '"+target_link+"', '"+wDt.banner_id+"', '"+self.positionTag+"', '"+self.pageTag+"', '"+wDt.sport_id+"', '"+wDt.location_id+"', '"+wDt.tournament_id+"', '"+wDt.event_id+"')\">"+btn_text+"</button></div>";self.$.bannerContentMain.classList.add("showcursor");self.$.buttondetail.innerHTML=btn;self.$.buttonNav_btn.innerHTML=btn;self.$.bannerContentMain.classList.add("linkBanner");self.$.bannerContentMain.classList.remove("cacheLinkBanner")}genTranslate(text){var self=this;if(text&&self.translate&&"object"===typeof self.translate){Object.keys(self.translate).forEach(key=>{text=text.replaceAll("${"+key+"}",self.translate[key])})}return text}getSportDataAction(eventId,data_event){var self=this,eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,bDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.banner_data?eDt.banner_data[0]:{};self.ws_event[eventId]=data_event;self.widget.events_list[0].banner_data[0].status_id=self.arrEvent[eventId].statusId;self.backupMarketName=data_event.data[0].name;self.set("text.marketname",self.getText(data_event.data[0].name));self.set("text.labelName","");self.set("text.labelStyle","");if("undefined"!==typeof self.arrEvent[eventId]&&"undefined"!==typeof self.arrEvent[eventId].venueName){self.set("text.countryId",self.arrEvent[eventId].venueId);self.set("text.countryName",self.arrEvent[eventId].venueName)}var data_event_data=data_event.data[0],select_market=data_event_data.id,milliseconds=new Date().getTime();self.firstRender(milliseconds,[],"",select_market,data_event_data);if("undefined"!==typeof self.subscribeOdds.id&&self.subscribeOdds.active){try{self.ws_session.unregister(self.subscribeOdds)}catch(err){self.subscribeOdds={}}}var topic=self.genMatchOdds(eventId,bDt);self.ws_session.register(topic,function(args,kwargs,details){self.wsChange(kwargs)}).then(function(regId){self.subscribeOdds=regId;self.ws_session.call("/sports#initialDump",[],{topic:topic}).then(function(res){if(res.kwargs.records.length||"undefined"!=typeof self.arrEvent[eventId].id){self.hideSkeleton();self.removeDemo();self.set("text.tournamentId","");self.set("text.tournamentName","");self.$.slideSource.classList.add("fadebanner");if(0==res.kwargs.records.length){self.ws_event[eventId]=self.arrEvent[eventId]}else{self.ws_event[eventId]=res.kwargs.records[0]}self.getEventDetail(eventId);try{if(6==eDt.web_data.type_id){self.callWsScore(eventId,eDt.web_data.sport_id)}if(eDt.web_data.generate_link){self.autoLink(self.ws_event[eventId])}}catch(err){}}else{self.ws_event[eventId]=null;self.disableBanner(eventId,self.bannerId)}})})}numberMinute(textMinute){if(""==textMinute){return""}return parseInt(textMinute.toString().replace(", ","").replace("'",""))}minsec(mins){var self=this;if(self.waitMinsec){clearInterval(self.waitMinsec);self.waitMinsec={}}var i=0,min=parseInt(mins),sec=i%60,minA=Math.floor(i/60),minD=(min+minA).toString()+":"+("0"+sec).slice(-2);self.set("text.minsec",minD);if("621"!=self.breakTime){self.waitMinsec=setInterval(function(){if("621"==self.breakTime){self.resetMinsec(minD)}else{i++;sec=i%60;minA=Math.floor(i/60);self.set("text.minsec",(min+minA).toString()+":"+("0"+sec).slice(-2))}},1e3)}}resetMinsec(mins=""){var self=this;self.set("text.minsec",mins);if(self.waitMinsec){clearInterval(self.waitMinsec);self.waitMinsec={}}setTimeout(function(){self.set("text.minsec",mins)},1e3)}countdownInterval(eventId,time_change){var self=this;if(self.waitDuration){clearInterval(self.waitDuration);self.waitDuration={}}var i=0;self.waitDuration=setInterval(function(){i++;if(0==i%time_change){i=0;self.renderOddsInterval(eventId,time_change)}self.set("text.timecount",time_change-i)},1e3)}async filterMarketInterval(eventId){var self=this;return new Promise(resolve=>{var listMarketInterval=[],eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,firstMarket=eDt.web_data.markets_interval[0],secondMarket=eDt.web_data.markets_interval[1];if("5"==self.arrEvent[eventId].currentPartId){listMarketInterval=firstMarket}else if("6"==self.arrEvent[eventId].currentPartId||"621"==self.arrEvent[eventId].currentPartId){listMarketInterval=secondMarket}if(listMarketInterval&&listMarketInterval.data.length){listMarketInterval.data.forEach(function(value,key){if(value.start<=self.numberMinute(self.text.minute)&&value.end>self.numberMinute(self.text.minute)){resolve(value)}});resolve([])}else{resolve([])}})}renderOddsInterval(eventId,time_change){var self=this,markets=self.filterMarketInterval(eventId);markets.then(data_markets=>{if(null==self.marketTimeline||null!=self.marketTimeline&&(self.marketTimeline.start!=data_markets.start||self.marketTimeline.end!=data_markets.end)){self.marketTimeline=data_markets;var list_market_rotate=[];(async()=>{await Promise.all([data_markets.pages.forEach((item,i)=>{list_market_rotate.push(item.marketId)})]).then(pData=>{var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,bDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.banner_data?eDt.banner_data[0]:{},status="LIVE",market=list_market_rotate,eventFilter=self.checkMarket(status,market,!1);eventFilter.then(data_fallback=>{if(data_fallback.successful){self.listInterval=data_fallback;var iLoop=0;self.backupMarketName=self.listInterval.data[iLoop].name;self.set("text.marketname",self.getText(self.listInterval.data[iLoop].name));self.set("text.labelName","");self.set("text.labelStyle","");var select_market=self.listInterval.data[iLoop].id,milliseconds=new Date().getTime();self.firstRender(milliseconds,[],"",select_market,self.listInterval.data[iLoop]);if(self.waitChange){clearInterval(self.waitChange);self.waitChange={}}self.waitChange=setInterval(function(){if(self.text.timecount==time_change){iLoop++;if("undefined"!==typeof self.listInterval.data[iLoop]){self.backupMarketName=self.listInterval.data[iLoop].name;self.set("text.marketname",self.getText(self.listInterval.data[iLoop].name));self.set("text.labelName","");self.set("text.labelStyle","");var select_market=self.listInterval.data[iLoop].id,milliseconds=new Date().getTime();self.firstRender(milliseconds,[],"",select_market,self.listInterval.data[iLoop])}if(iLoop==self.listInterval.data.length-1){iLoop=-1}}},1e3)}}).catch(err=>{})})})()}}).catch(err=>{})}getMarketInterval(eventId){var self=this,eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,bDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.banner_data?eDt.banner_data[0]:{};self.callWsScore(eventId,eDt.web_data.sport_id);self.getEventDetail(eventId);var time_change=20,rotate_data=null;(async()=>{await Promise.all([eDt.banner_data.forEach((item,i)=>{if(eDt.web_data.banner_id==item.banner_id){rotate_data=item}})]).then(pData=>{self.waitMinute=setInterval(function(){if(self.numberMinute(self.text.minute)){time_change=rotate_data.slide_duration;self.set("text.timecount",time_change);clearInterval(self.waitMinute);self.renderOddsInterval(eventId,time_change);self.countdownInterval(eventId,time_change)}},100);if("undefined"!==typeof self.subscribeOdds.id&&self.subscribeOdds.active){try{self.ws_session.unregister(self.subscribeOdds)}catch(err){self.subscribeOdds={}}}var topic=self.genMatchOdds(eventId,bDt);self.ws_session.register(topic,function(args,kwargs,details){self.wsChange(kwargs)}).then(function(regId2){self.subscribeOdds=regId2});self.hideSkeleton();self.removeDemo();self.$.slideSource.classList.add("fadebanner")})})()}rmCacheE(){var self=this,cacheName=self.genCacheName(self.tid,self.bannerId,self.eid,self.language),ls=self.lsGet("bmfe:events","json");if("undefined"!==typeof ls[cacheName]){delete ls[cacheName]}self.lsSet("bmfe:events",JSON.stringify(ls))}rmCacheEByName(cacheName){var self=this,ls=self.lsGet("bmfe:events","json");if("undefined"!==typeof ls[cacheName]){delete ls[cacheName]}self.lsSet("bmfe:events",JSON.stringify(ls))}getSportData(eventId,wsData=null){var self=this,timeOut=100;if("offerlibrary"==self.apiMethod&&"undefined"!==typeof self.WEB_API_CACHE.offer_library_ready||null!=self.ws_session){timeOut=20}var i=0,wait=setInterval(function(){var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,bDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.banner_data?eDt.banner_data[0]:{},cacheName=self.genCacheName(self.tid,self.bannerId,self.eid,self.language);if(("offerlibrary"==self.apiMethod&&"undefined"!==typeof self.WEB_API_CACHE.offer_library_ready||null!=self.ws_session)&&"undefined"!==typeof eDt&&"undefined"!==typeof bDt&&"undefined"!==typeof bDt.betting_event){if("undefined"!==typeof eventId&&null!=eventId&&0==eDt.web_data.interval_status){var status="",market=[];if("undefined"!==typeof self.arrEvent[eventId]){self.widget.events_list[0].banner_data[0].status_id=self.arrEvent[eventId].statusId}if(2==bDt.status_id&&0==bDt.markets_live.length&&1==bDt.incident_status&&self.widget_position_id&&["1","2"].includes(self.widget_position_id.toString())){clearInterval(wait);self.getEventDetail(eventId);self.callWsScore(eventId,eDt.web_data.sport_id);self.checkSliderChange()}else{if("offerlibrary"==self.apiMethod){(async()=>{var loaded=0;await Promise.all([self.listPopular.match.forEach((item2,i2)=>{self.listPopular.markets[item2.id].forEach((item3,i3)=>{var selections=self.listPopular.market[item3.id].selections;if(selections.length){selections=selections.sort((a,b)=>a.orderOutcome-b.orderOutcome);self.listPopular.markets[item2.id][i3].selections=selections;loaded++}})})]).then(pData1=>{if(0==self.listPopular.match.length){self.disableRmR("",self.bannerId,cacheName)}else{if(loaded){self.setTextEvent()}else{self.disableRmR("",self.bannerId,"auto",!1)}}})})()}else if(wsData){self.resetListPopular();(async()=>{if(wsData.length){await Promise.all([wsData.forEach((item,i)=>{self.genListPopular(item);if("MATCH"==item._type){if(item.currentPartId&&item.currentPartName){self.breakTime=item.currentPartId;self.set("text.partName",item.currentPartName);self.setEventLs(cacheName,"partName",{partName:item.currentPartName})}}else if("EVENT_INFO"==item._type){if("95"==item.typeId){self.set("text.time_id",item.id);if("undefined"!=typeof item.paramFloat1){var prefix="";if(self.widget_layout&&!["2","4","7","8"].includes(self.widget_layout.toString())){prefix=", "}var minute=item.paramFloat1.toString().replace(".0","");self.set("text.minute",prefix+minute+"'");self.minsec(minute)}else{self.set("text.minute","");self.resetMinsec()}}}})]).then(pData=>{(async()=>{var loaded=0;await Promise.all([self.listPopular.match.forEach((item2,i2)=>{self.listPopular.markets[item2.id].forEach((item3,i3)=>{var selections=self.listPopular.market[item3.id].selections;if(selections.length){selections=selections.sort((a,b)=>a.orderOutcome-b.orderOutcome);self.listPopular.markets[item2.id][i3].selections=selections;loaded++}})})]).then(pData1=>{if(0==self.listPopular.match.length){var cacheName=self.genCacheName(self.tid,self.bannerId,self.eid,self.language);self.disableRmR("",self.bannerId,cacheName)}else{if(loaded){self.setTextEvent()}else{self.disableRmR("",self.bannerId,"auto",!1)}}})})()})}})()}else{if(1==bDt.status_id){status="NOT_LIVE";market=bDt.markets}else if(2==bDt.status_id){status="LIVE";market=bDt.markets_live}var homeParticipant_id="",awayParticipant_id="";if("undefined"!=typeof bDt.event_json){if("undefined"!=typeof bDt.event_json.homeParticipant){homeParticipant_id=bDt.event_json.homeParticipant.id}if("undefined"!=typeof bDt.event_json.awayParticipant){awayParticipant_id=bDt.event_json.awayParticipant.id}}var eventFilter=self.checkMarket(status,market,!1);eventFilter.then(data_event=>{if(data_event.successful){if("undefined"===typeof data_event.data[0]){self.hideSkeleton();self.$.slideSource.classList.add("fadebanner");self.getEventDetail(eventId);self.callWsScore(eventId,bDt.sport_id);var iLoop=1;if(self.waitFallback){clearInterval(self.waitFallback);self.waitFallback={}}self.waitFallback=setInterval(function(){iLoop++;var eventFilter_wait_fallback=self.checkMarket(status,market,!1);eventFilter_wait_fallback.then(data_fallback_wait=>{if(data_fallback_wait.successful&&data_fallback_wait.data.length){self.getSportDataAction(eventId,data_fallback_wait);clearInterval(self.waitFallback)}else{if(30<=iLoop){self.disableBanner(eventId,self.bannerId);self.shadowRoot.querySelectorAll(".splide__pagination").forEach(el=>el.remove());self.resetWidget();self.startLoad();clearInterval(self.waitFallback)}}}).catch(err=>{clearInterval(self.waitFallback)})},1e4)}else{self.getEventDetail(eventId);self.callWsScore(eventId,bDt.sport_id);self.getSportDataAction(eventId,data_event)}}else{self.disableRmR(eventId,self.bannerId,"auto",!1);if(""==self.bannerId){self.resetWidget();self.startLoad()}}}).catch(err=>{self.disableRmR(eventId,self.bannerId,"auto");self.startLoad()})}clearInterval(wait)}}else if("undefined"!=typeof eventId&&null!=eventId&&1==eDt.web_data.interval_status){self.getMarketInterval(eventId);clearInterval(wait)}else{clearInterval(wait)}if("undefined"!==typeof eDt&&"undefined"!==typeof eDt.web_data.devices){var device=eDt.web_data.devices;if(device.desktop){self.$.slideSource.classList.add("d_desktop")}if(device.tablet){self.$.slideSource.classList.add("d_tablet")}if(device.mobile){self.$.slideSource.classList.add("d_mobile")}}if(self.bannerId){if(3==eDt.web_data.type_id){self.renderBanner();if(1==eDt.banner_data[0].display_time_status){if(0<eDt.banner_data[0].display_time){self.widgetTimeout=eDt.banner_data[0].display_time;if(1==self.use_timeout){self.checkTimeout(self.bannerId)}}}}else{if(3==eDt.banner_data[0].status_id){}else{if("4"==eDt.web_data.type_id){self.renderBanner()}else{self.renderBanner()}}}}else{if(wsData){}else if("offerlibrary"==self.apiMethod){}else{self.getBannerData()}}}else{i++;if(200<i){clearInterval(wait)}}},timeOut)}getBannerDataSingleEvent(data){var self=this,eventId=data.data.event_id;if("offerlibrary"==self.apiMethod){if(eventId&&"undefined"!==typeof self.WEB_API_CACHE.offer_library_ready){self.resetListPopular();const offerStruct=self.WEB_API_CACHE.offer_library.sport.offerStruct,focus=self.WEB_API_CACHE.offer_library.sport.matches.get(eventId);if(focus){const outcomes=focus.outcomes,startTime=new Date(focus.utcDate);let match={_type:"MATCH",id:focus.matchId,statusId:"prematch"==focus.state?1:"live"==focus.state&&"active"==focus.status?2:0,currentPartId:"",sportId:focus.sportId?focus.sportId.toString():"",sportName:`${offerStruct.sports[focus.sportId].sportName}`,shortSportName:`${offerStruct.sports[focus.sportId].sportName}`,parentId:focus.tournamentId?focus.tournamentId.toString():"",parentName:`${offerStruct.tournaments[focus.tournamentId].tournamentName}`,shortParentName:`${offerStruct.tournaments[focus.tournamentId].tournamentName}`,venueId:`${offerStruct.categories[focus.categoryId].sportId}`,venueName:`${offerStruct.categories[focus.categoryId].categoryName}`,homeParticipantId:focus.teamIdOne?focus.teamIdOne.toString():"",homeParticipantName:focus.teamNameOne,awayParticipantId:focus.teamIdTwo?focus.teamIdTwo.toString():"",awayParticipantName:focus.teamNameTwo,name:`${focus.teamNameOne} - ${focus.teamNameTwo}`,shortName:`${focus.teamNameOne} - ${focus.teamNameTwo}`,startTime:startTime.getTime()};self.arrEvent[match.id]=match;self.listPopular.match.push(match);self.listPopular.event[match.id]=match;self.listPopular.markets[match.id]=[];self.listPopular.query_markets[match.id]=[];self.listPopular.bettingTypeIds[match.id]=[];self.listPopular.eventPartIds[match.id]=[];const eventScores=self._offerScores(focus);let allowBettingTypeId=["35","69","70","466"];if(data.data.betting_event&&data.data.betting_event.bettingTypeIds){allowBettingTypeId=data.data.betting_event.bettingTypeIds}let scoreEventPart=[];(async()=>{await Promise.all([outcomes.forEach((item,i)=>{const outcome=outcomes[i];let bettingTypeId=outcome.marketDefId,eventPartId=outcome.eventPartId;const eventPartName=eventPartId&&offerStruct.eventParts&&offerStruct.eventParts[eventPartId]?offerStruct.eventParts[eventPartId].name:"";if(bettingTypeId&&-1!==bettingTypeId.indexOf("_")){const marketDefId=outcome.marketDefId.split("_");bettingTypeId=marketDefId[0];eventPartId=marketDefId[1]}if(eventPartId&&-1!==allowBettingTypeId.indexOf(bettingTypeId)){const id=`${match.id}_${bettingTypeId}_${eventPartId}`,outcomeId=`${id}_${item.outcomeId}`;if(-1==self.listPopular.query_markets[match.id].indexOf(id)){self.listPopular.markets[match.id].push({bettingTypeId:bettingTypeId,bettingTypeName:`${offerStruct.markets[outcome.marketDefId].shortName}`,eventId:match.id,eventPartId:eventPartId,eventPartName:eventPartName,id:id,name:`${offerStruct.markets[outcome.marketDefId].shortName}`,selections:[]});self.listPopular.query_markets[match.id].push(id);self.listPopular.bettingTypeIds[match.id].push(bettingTypeId);self.listPopular.eventPartIds[match.id].push(eventPartId)}let translationKey=`${offerStruct.outcomes[item.outcomeId].shortName}`;if(item.specifiers){Object.keys(item.specifiers).forEach(i2=>{translationKey=translationKey.replace(`{${i2}}`,`${item.specifiers[i2]}`)});translationKey=translationKey.replace(`{$competitor1}`,`${focus.teamNameOne}`);translationKey=translationKey.replace(`{$competitor2}`,`${focus.teamNameTwo}`)}let props={};if(outcome.specifiers&&"undefined"!==typeof outcome.specifiers.pf1){props.param=outcome.specifiers.pf1}const outcomeSelection={eventId:match.id,translationKey:translationKey,outcomeId:outcomeId,props:props,homeParticipantId:self.listPopular.event[match.id].homeParticipantId,awayParticipantId:self.listPopular.event[match.id].awayParticipantId,orderOutcome:offerStruct.outcomes[item.outcomeId].orderNum,isLive:"live"==focus.state?!0:!1,bettingTypeId:bettingTypeId,bettingTypeName:`${offerStruct.markets[outcome.marketDefId].shortName}`,price:item.value,providerId:"",available:"active"==item.status?!0:!1,id:item.outcomeHash,statusId:"active"==item.status?1:0};if("undefined"===typeof self.listPopular.market[id]){self.listPopular.market[id]={id:id,selections:[]}}self.listPopular.market[id].selections.push(outcomeSelection)}}),eventScores.forEach((item,i)=>{if("undefined"!=typeof item.t1Scr&&"undefined"!=typeof item.t2Scr){scoreEventPart.push({eventPartKey:item.type,eventPartName:item.name,homeScore:item.t1Scr,awayScore:item.t2Scr})}})]).then(oData=>{if("undefined"!==typeof self.arrEvent[eventId]){data.data.status_id=self.arrEvent[eventId].statusId;if(1==self.arrEvent[eventId].statusId||2==self.arrEvent[eventId].statusId){self.getBannerDataCacheAction(data)}else{if(self.bannerId&&-1==self.slider_disable.indexOf(self.bannerId)){self.disableBanner("",self.bannerId);self.updateBannerCacheAll(eventId)}}}if(scoreEventPart.length){self._offerText(focus,scoreEventPart)}})})()}else{self.disableBanner(eventId,self.bannerId);self.updatetBannerCache(data)}}else{self.disableBanner(eventId,self.bannerId);self.updatetBannerCache(data)}}else{var topic=self.genMatchOdds(eventId,data.data),isClone=self.parentNode.classList.contains("splide__slide--clone")&&self.fromInclude;if(isClone){if("undefined"!==typeof self.WEB_API_CACHE[topic]&&"undefined"!==typeof self.WEB_API_CACHE[topic].records){setTimeout(function(){self.matchOddsRes1(eventId,data,{kwargs:self.WEB_API_CACHE[topic]})},"9"==self.widget_layout?600:0)}else{if("undefined"!==typeof self.dumpMatchOddsListener){self.removeEventListener("topicListen:initialDump",self.dumpMatchOddsListener)}self.dumpMatchOddsListener=self.dumpMatchOdds.bind(self,topic,eventId,data);self.addEventListener("topicListen:initialDump",self.dumpMatchOddsListener)}if("undefined"!==typeof self.regMatchOddsListener){self.removeEventListener("topicListen:register",self.regMatchOddsListener)}self.regMatchOddsListener=self.regMatchOdds.bind(self,topic);self.addEventListener("topicListen:register",self.regMatchOddsListener)}else{self.ws_session.register(topic,function(args,kwargs,details){self.wsChange(kwargs);self.customEventTopic("topic:register",topic,kwargs)}).then(function(regId){self.subscribeOdds=regId;self.ws_session.call("/sports#initialDump",[],{topic:topic}).then(function(res){self.matchOddsRes1(eventId,data,res);self.customEventTopic("topic:initialDump",topic,res.kwargs)})})}}}regMatchOdds(topic,dataE){var self=this;if(dataE.detail&&dataE.detail.topic==topic){self.wsChange(dataE.detail.kwargs)}}dumpMatchOdds(topic,eventId,data,dataE){var self=this;if(dataE.detail&&dataE.detail.topic==topic){self.matchOddsRes1(eventId,data,{kwargs:dataE.detail.kwargs})}}matchOddsRes1(eventId,data,res){var self=this;if(eventId&&data&&res&&res.kwargs&&"undefined"!==typeof res.kwargs.records){if(res.kwargs.records.length){(async()=>{await Promise.all([res.kwargs.records.forEach((item2,i2)=>{if("MATCH"==item2._type){self.arrEvent[eventId]=item2;data.data.status_id=self.arrEvent[eventId].statusId}})]).then(pData=>{if(self.arrEvent[eventId]&&(1==self.arrEvent[eventId].statusId||2==self.arrEvent[eventId].statusId)){self.getBannerDataCacheAction(data,res.kwargs.records)}else{if(self.bannerId&&-1==self.slider_disable.indexOf(self.bannerId)){self.disableBanner("",self.bannerId);self.updateBannerCacheAll(eventId)}}})})()}else{self.disableBanner(eventId,self.bannerId);self.updatetBannerCache(data)}}}customEventTopic(eventName,topic,kwargs){var self=this;if("topic:initialDump"==eventName){self.WEB_API_CACHE[topic]=kwargs}const event=new CustomEvent(eventName,{detail:{topic:topic,kwargs:kwargs}});self.dispatchEvent(event)}customEventItem(eventName,detail){var self=this;self.shadowRoot.querySelectorAll("bannermatrix-banner").forEach(function(item,key){var isClone=item.parentNode.classList.contains("splide__slide--clone");if(isClone){const event=new CustomEvent(eventName,{detail:detail});item.dispatchEvent(event)}})}updatetBannerCache(data){var self=this;if(self.bannerId){var ls1=self.lsGet("bmfe:events","json"),cacheName=self.genCacheName(data.data.type_id,self.bannerId,self.eid,self.language);if(Object.keys(ls1).length&&"undefined"!==typeof ls1[cacheName]||dayjs().isAfter(dayjs(data.data.start_date).add(2,"hour"))){var lsParam=self.positionTag+"-"+self.pageTag+"-"+self.loggedIn+"-"+self.eventId.toString(),ls2=self.lsGet("bmfe:"+self.language+"-"+lsParam,"json");if(Object.keys(ls2).length&&"undefined"!==typeof ls2[self.bannerId]){ls2[self.bannerId].data.status_id=3;self.lsSet("bmfe:"+self.language+"-"+lsParam,JSON.stringify(ls2))}}}}updateBannerCacheAll(eventId){var self=this;if(self.bannerId){try{var lsParam=self.positionTag+"-"+self.pageTag+"-"+self.loggedIn+"-"+eventId,ls=self.lsGet("bmfe:"+self.language+"-"+lsParam,"json");if(Object.keys(ls).length){if("undefined"!==typeof ls[self.bannerId]){ls[self.bannerId].data.status_id=self.arrEvent[eventId].statusId}if(ls.maindata.data.length){(async()=>{var newdata=[];await Promise.all([ls.maindata.data.forEach((item3,i3)=>{if(item3.banner_id==self.bannerId){ls.maindata.data[i3].status_id=self.arrEvent[eventId].statusId}if(3==ls.maindata.data[i3].status_id){var cacheName=self.genCacheName(self.tid,item3.banner_id,eventId,self.language),lsEvents=self.lsGet("bmfe:events","json");if("undefined"!==typeof lsEvents[cacheName]){delete lsEvents[cacheName]}self.lsSet("bmfe:events",JSON.stringify(lsEvents));delete ls[ls.maindata.data[i3].banner_id]}else{newdata.push(ls.maindata.data[i3])}})]).then(pData=>{ls.maindata.data=newdata;self.lsSet("bmfe:"+self.language+"-"+lsParam,JSON.stringify(ls))})})()}}}catch(err){}}}disableBanner(eventId,bannerId){var self=this;if("undefined"!==typeof eventId&&eventId&&"undefined"!==typeof self.ws_event[eventId]){self.ws_event[eventId]=null}if("undefined"!==typeof bannerId&&bannerId){self.slider_disable.push(bannerId.toString());self.slider_disable_trigger=new Date().getTime();self.rmListener()}}disableRmR(eventId,bannerId,cacheName,reset=!0){var self=this;self.disableBanner(eventId,bannerId);if(cacheName){if("auto"==cacheName){self.rmCacheE()}else{self.rmCacheEByName(cacheName)}}if(reset){self.resetWidget()}}getBannerDataCache(data){var self=this;if(data.successful){var dt=data.data;self.tid=dt.type_id.toString();if(dt.custom_css){self.$.custom_style_single.innerHTML="<style>"+dt.custom_css+"</style>"}else{self.$.custom_style_single.innerHTML=""}if(6==dt.banner_layout){self.$.backgroundBanner.classList.add("banner_layout_6");self.useSection="buttonNav"}else{if(["7","8","9"].includes(dt.type_id.toString())){self.useSection="couponBanner"}else{self.useSection=""}self.$.backgroundBanner.classList.remove("banner_layout_6")}if(self.haveEventCache&&dt.event_id){var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,wDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.web_data?eDt.web_data:{},bannerId=self.bannerId?self.bannerId:wDt.banner_id,eid=self.eid?self.eid:wDt.event_id,cacheName=self.genCacheName(wDt.type_id,bannerId,eid,self.language);self.getEventCache(cacheName)}if(self.bannerId&&dt.event_id){var wstime=100;if("offerlibrary"==self.apiMethod&&"undefined"!==typeof self.WEB_API_CACHE.offer_library_ready||null!=self.ws_session||3==dt.type_id||2==dt.type_id&&("undefined"==typeof dt.tournament_event_id||0==dt.tournament_event_id.length)){wstime=20}var i=0,wait=setInterval(function(){if(("offerlibrary"==self.apiMethod&&"undefined"!==typeof self.WEB_API_CACHE.offer_library_ready||null!=self.ws_session||3==dt.type_id||2==dt.type_id&&("undefined"==typeof dt.tournament_event_id||0==dt.tournament_event_id.length))&&!self.cacheLoading){clearInterval(wait);self.getBannerDataSingleEvent(data)}else{i++;if(200<i){clearInterval(wait)}}},wstime)}else if(self.bannerId&&["4","6","7","8","9"].includes(dt.type_id.toString())){var check_first_banner=self.genCacheName(dt.type_id,self.bannerId,"",self.language);self.getEventCache(check_first_banner);var wstime=100;if(null!=self.ws_session){wstime=20}var i=0,wait=setInterval(function(){if(null!=self.ws_session&&!self.cacheLoading){clearInterval(wait);self.getBannerDataCacheAction(data)}else{i++;if(200<i){clearInterval(wait)}}},wstime)}else if(4==self.widget_position_id||3==dt.type_id||2==dt.type_id&&("undefined"==typeof dt.tournament_event_id||0==dt.tournament_event_id.length)){self.disableApiCallback=!0;self.getBannerDataCacheAction(data)}else{if(null==dt.event_id&&["4","6","7","8","9"].includes(dt.type_id.toString())){var wstime=100;if(null!=self.ws_session){wstime=20}var i=0;if(["4","7","8","9"].includes(dt.type_id.toString())){var check_first_banner=self.genCacheName(dt.type_id,dt.banner_id,"",self.language);self.getEventCache(check_first_banner)}var wait=setInterval(function(){if(null!=self.ws_session&&!self.cacheLoading){clearInterval(wait);if(dt.banner_layout){self.widget_layout=dt.banner_layout.toString()}self.setTypeBanner();self.showEventDetail();if(4==dt.type_id){self.callRecommend(dt.banner_id)}else if(6==dt.type_id){self.callPopularEvents(dt.sport_id,dt.location_id,1,3)}else if(7==dt.type_id||9==dt.type_id){self.callCouponEvents(data)}else if(8==dt.type_id){let cp=6;if(dt.coupon&&dt.coupon.couponNumber){cp=dt.coupon.couponNumber}self.callPopularEvents(dt.sport_id,dt.location_id,cp,3)}}else{i++;if(200<i){clearInterval(wait);self.checkSliderChange()}}},wstime)}else{self.getBannerDataSingleEvent(data)}}self.translateText()}}handleLink(e){var self=this,eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,wDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.web_data?eDt.web_data:{},bDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.banner_data?eDt.banner_data[0]:{},eventId="",targetLink=e.target.getAttribute("data-link"),target=e.target,link=self.root_auto_link?JSON.parse(JSON.stringify(self.root_auto_link)):{};if(null==targetLink){targetLink=e.target.parentNode.getAttribute("data-link");target=e.target.parentNode}if("link"==targetLink){eventId=target.getAttribute("data-event");if(link&&link.link){var param="/${sportId}/${shortSportName}/${shortVenueName}/${shortParentName}/${shortName}/${id}/";link.link=("/"==link.link.substr(-1)?link.link.slice(0,-1):link.link)+param}}else if(bDt&&bDt.event_id){eventId=bDt.event_id}if(eventId&&targetLink&&link&&link[targetLink]){var match=null;if(self.ws_event[eventId]){match=self.ws_event[eventId]}else if(self.arrEvent[eventId]){match=self.arrEvent[eventId]}if(match&&match.sportId){var category=null;if(link.sport_category_ids){category=link.sport_category_ids.toString().replaceAll(" ","").split(",");if(category&&category.includes(match.sportId)){if(link.link_sport_category){link.link_sport=link.link_sport_category}if(link.link_location_category){link.link_location=link.link_location_category}if(link.link_tournament_category){link.link_tournament=link.link_tournament_category}}}link=self.genLink(link[targetLink],match);if(-1==link.indexOf("${")){try{var target_link="_top";if("undefined"!==typeof self.root_auto_link.target_link){target_link=self.root_auto_link.target_link}window.open(link,target_link)}catch(err){}}}}}handleCouponAddToBetslip(){var self=this;if(self.offerCheckedArray.length){(async()=>{var includeAll=!0,disable=[],remove=[];if(self.activeBettingOffers){remove=[...self.activeBettingOffers]}await Promise.all([self.offerCheckedArray.forEach((item,i)=>{if(self.activeBettingOffers&&self.activeBettingOffers.includes(item.bettingOfferId)){disable.push(item.bettingOfferId);var index=remove.indexOf(item.bettingOfferId);if(-1!==index){remove.splice(index,1)}}else{includeAll=!1}})]).then(pData=>{if(remove&&remove.length&&!includeAll){remove.forEach((item,i)=>{var rmEvent=new CustomEvent("onOddsClick",{detail:{eventId:"1",bettingOfferId:item,odd:1}});window.dispatchEvent(rmEvent,{bubbles:!0,cancelable:!0})})}self.offerCheckedArray.forEach((item,i)=>{let push=!0;if(disable.includes(item.bettingOfferId)){push=!1}if(push||includeAll){var event=new CustomEvent("onOddsClick",{detail:{eventId:item.eventId,bettingOfferId:item.bettingOfferId,odd:item.odd}});window.dispatchEvent(event,{bubbles:!0,cancelable:!0})}});self.recordClick(self.bannerId,self.positionTag,self.pageTag,"","","","","")})})();if(self.widget_position_id&&["1","2"].includes(self.widget_position_id.toString())&&self.slider_setting.close_bottom_mobile){self.closePanel("0")}}}handleCouponCheckboxChange(){var self=this;if(9!=self.tid){var checkboxes=self.shadowRoot.querySelectorAll(".cpCheckbox"),oddsChkArr=[],oddsList=[];self.offerCheckedArray=[];for(var i=0;i<checkboxes.length;i++){if(checkboxes[i].checked){self.shadowRoot.querySelector(".cpItem-item:nth-child("+(i+1)+")").classList.add("checked");var odds=parseFloat(checkboxes[i].getAttribute("data-odds"));oddsList.push(odds);var offer=checkboxes[i].value,item=self.offerList.find(item=>item.id==offer);item.odds=odds;oddsChkArr.push({eventId:item.MATCH.id,bettingOfferId:offer,odd:item.odds})}else{self.shadowRoot.querySelector(".cpItem-item:nth-child("+(i+1)+")").classList.remove("checked")}}var totalOdds=0;if(oddsList.length){totalOdds=oddsList.reduce(function(a,b){return a*b})}self.set("offerCheckedArray",oddsChkArr);self.set("oddsCheckedArrayCount",totalOdds);var cacheName=self.genCacheName(self.tid,self.bannerId,"",self.language),eCache=self.getEventLs(cacheName);if(eCache&&eCache.action_outcome){eCache.action_outcome=JSON.stringify(self.offerList);self.setEventLs(cacheName,"action_outcome",eCache)}}}callCouponEvents(data){var self=this,dt=data&&data.data?data.data:{};if(dt.coupon&&dt.coupon.length){var list_offer=dt.coupon.map(item=>item.outcome.id),offerListStr=list_offer.join(",");if(offerListStr){var topic="/sports/"+self.operatorId+"/"+self.language+"/bettingOffers/"+offerListStr;if(1==list_offer.length){topic="/sports/"+self.operatorId+"/"+self.language+"/bettingOffer/"+offerListStr}var isClone=self.parentNode.classList.contains("splide__slide--clone")&&self.fromInclude;if(isClone){if("undefined"!==typeof self.WEB_API_CACHE[topic]&&"undefined"!==typeof self.WEB_API_CACHE[topic].records){self.couponRes(list_offer,dt,{kwargs:self.WEB_API_CACHE[topic]})}else{if("undefined"!==typeof self.dumpCouponListener){self.removeEventListener("topicListen:initialDump",self.dumpCouponListener)}self.dumpCouponListener=self.dumpCoupon.bind(self,topic,list_offer,dt);self.addEventListener("topicListen:initialDump",self.dumpCouponListener)}if("undefined"!==typeof self.regCouponListener){self.removeEventListener("topicListen:register",self.regCouponListener)}self.regCouponListener=self.regCoupon.bind(self,topic);self.addEventListener("topicListen:register",self.regCouponListener)}else{if("undefined"!==typeof self.subscribeCoupon.id&&self.subscribeCoupon.active){try{self.ws_session.unregister(self.subscribeCoupon)}catch(err){self.subscribeCoupon={}}}self.ws_session.register(topic,function(args,kwargs,details){self.wsChange(kwargs);self.customEventTopic("topic:register",topic,kwargs)}).then(function(regId){self.subscribeCoupon=regId;self.ws_session.call("/sports#initialDump",[],{topic:topic}).then(function(res){self.couponRes(list_offer,dt,res);self.customEventTopic("topic:initialDump",topic,res.kwargs)})})}}else{self.disableBanner("",self.bannerId);if(self.widget_position_id&&["1","2","3"].includes(self.widget_position_id.toString())){self.resetWidget();self.startLoad()}}}else{self.disableBanner("",self.bannerId);if(self.widget_position_id&&["1","2","3"].includes(self.widget_position_id.toString())){self.resetWidget();self.startLoad()}}}regCoupon(topic,dataE){var self=this;if(dataE.detail&&dataE.detail.topic==topic){self.wsChange(dataE.detail.kwargs)}}dumpCoupon(topic,list_offer,dt,dataE){var self=this;if(dataE.detail&&dataE.detail.topic==topic){self.couponRes(list_offer,dt,{kwargs:dataE.detail.kwargs})}}couponRes(list_offer,dt,res){var self=this,cacheName=self.genCacheName(self.tid,dt.banner_id,"",self.language);if(res&&res.kwargs&&res.kwargs.records&&res.kwargs.records.length){self.set("offerList",[]);self.set("offerListIndex",[]);(async()=>{var MATCH=[],MARKET=[],MARKET_OUTCOME_RELATION=[],OUTCOME=[],BETTING_OFFER=[],countAvailable=0,countDisable=0,totalOdds=0,offerList=[],offerListIndex=[],oddsCA=[];await Promise.all([res.kwargs.records.forEach((item,i)=>{if("MATCH"==item._type){self.arrEvent[item.id]=item;MATCH[item.id]=item}else if("MARKET"==item._type){MARKET[item.id]=item}else if("OUTCOME"==item._type){OUTCOME[item.id]=item}else if("MARKET_OUTCOME_RELATION"==item._type){MARKET_OUTCOME_RELATION[item.outcomeId]=item}else if("BETTING_OFFER"==item._type){BETTING_OFFER[item.id]=item}}),list_offer.forEach((item,c_i)=>{try{var statusId=MATCH[OUTCOME[BETTING_OFFER[item].outcomeId].eventId].statusId;if(BETTING_OFFER[item]&&("1"==statusId||"2"==statusId)){offerList.push({...BETTING_OFFER[item],OUTCOME:OUTCOME[BETTING_OFFER[item].outcomeId],MARKET:MARKET[MARKET_OUTCOME_RELATION[BETTING_OFFER[item].outcomeId].marketId],MATCH:MATCH[OUTCOME[BETTING_OFFER[item].outcomeId].eventId]});if(BETTING_OFFER[item].isAvailable){countAvailable++;totalOdds=(0==totalOdds?1:totalOdds)*BETTING_OFFER[item].odds;oddsCA.push({eventId:OUTCOME[BETTING_OFFER[item].outcomeId].eventId,bettingOfferId:item,odd:BETTING_OFFER[item].odds});offerListIndex.push(item)}else{countDisable++}}}catch(err){}})]).then(cThen=>{if(!offerList.length||1>=countAvailable){self.disableRmR("",self.bannerId,cacheName);if(self.widget_position_id&&["1","2","3"].includes(self.widget_position_id.toString())){self.startLoad()}}else{var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,wDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.web_data?eDt.web_data:{},bDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.banner_data?eDt.banner_data[0]:{};self.onResize();self.set("offerList",offerList);self.set("offerListIndex",offerListIndex);self.set("offerCheckedArray",oddsCA);if(9==self.tid){self.set("oddsCheckedArrayCount",0);var offerListStr=list_offer.join(","),topicBBD="/sports/"+self.operatorId+"/"+self.language+"/combined-odds/"+offerListStr,isClone=self.parentNode.classList.contains("splide__slide--clone")&&self.fromInclude;if(isClone){if("undefined"!==typeof self.WEB_API_CACHE[topicBBD]&&"undefined"!==typeof self.WEB_API_CACHE[topicBBD].records){self.couponBBDRes(cacheName,{kwargs:self.WEB_API_CACHE[topicBBD]})}else{if("undefined"!==typeof self.dumpCouponBBDListener){self.removeEventListener("topicListen:initialDump",self.dumpCouponBBDListener)}self.dumpCouponBBDListener=self.dumpCouponBBD.bind(self,topicBBD,cacheName);self.addEventListener("topicListen:initialDump",self.dumpCouponBBDListener)}if("undefined"!==typeof self.regCouponBBDListener){self.removeEventListener("topicListen:register",self.regCouponBBDListener)}self.regCouponBBDListener=self.regCouponBBD.bind(self,topicBBD,cacheName);self.addEventListener("topicListen:register",self.regCouponBBDListener)}else{if("undefined"!==typeof self.subscribeCouponBBD.id&&self.subscribeCouponBBD.active){try{self.ws_session.unregister(self.subscribeCouponBBD)}catch(err){self.subscribeCouponBBD={}}}self.ws_session.register(topicBBD,function(args,kwargs,details){self.wsBBDChange(cacheName,kwargs);self.customEventTopic("topic:register",topicBBD,kwargs)}).then(function(regId){self.subscribeCouponBBD=regId;self.ws_session.call("/sports#initialDump",[],{topic:topicBBD}).then(function(res){self.couponBBDRes(cacheName,res);self.customEventTopic("topic:initialDump",topicBBD,res.kwargs)})})}}else{self.set("oddsCheckedArrayCount",totalOdds)}var cacheOutcome=JSON.stringify(self.offerList);self.setEventLs(cacheName,"action_outcome",{type_id:dt.type_id,image_banner_set:bDt.banner_image,background_image_transperent:bDt.background_image_transperent,background_color:bDt.background_color,content:self.text.content,title:self.text.title,devices:wDt.devices,action_outcome:cacheOutcome});self.hideSkeleton();self.$.slideSource.classList.add("fadebanner")}})})()}else{self.disableRmR("",self.bannerId,cacheName);if(self.widget_position_id&&["1","2","3"].includes(self.widget_position_id.toString())){self.startLoad()}}}regCouponBBD(topic,cacheName,dataE){var self=this;if(dataE.detail&&dataE.detail.topic==topic){self.wsBBDChange(cacheName,dataE.detail.kwargs)}}dumpCouponBBD(topic,cacheName,dataE){var self=this;if(dataE.detail&&dataE.detail.topic==topic){self.couponBBDRes(cacheName,{kwargs:dataE.detail.kwargs})}}wsBBDChange(cacheName,kwargs){var self=this;if("UPDATE"==kwargs.messageType&&kwargs.records.length){var bbd=kwargs.records[0];if("UPDATE"==bbd.changeType&&bbd.changedProperties){bbd=bbd.changedProperties;if(bbd.combinedOddsAvailable&&"YES"==bbd.oddsCombinable){if(bbd.combinedOdds){self.set("oddsCheckedArrayCount",bbd.combinedOdds)}}else{self.disableRmR("",self.bannerId,cacheName);if(self.widget_position_id&&["1","2","3"].includes(self.widget_position_id.toString())){self.startLoad()}}}}}couponBBDRes(cacheName,res){var self=this;if(res&&res.kwargs&&res.kwargs.records&&res.kwargs.records.length){var bbd=res.kwargs.records[0];if(bbd.combinedOddsAvailable&&"YES"==bbd.oddsCombinable){self.set("oddsCheckedArrayCount",bbd.combinedOdds)}else{self.disableRmR("",self.bannerId,cacheName);if(self.widget_position_id&&["1","2","3"].includes(self.widget_position_id.toString())){self.startLoad()}}}else{self.disableRmR("",self.bannerId,cacheName);if(self.widget_position_id&&["1","2","3"].includes(self.widget_position_id.toString())){self.startLoad()}}}getBannerDataCacheAction(data,wsData=null){var self=this;if(data.successful){var dt=data.data;if("null"==dt.event_id&&2==dt.type_id){dt.event_id=0}if(dt.banner_layout){if(dt.banner_layout!=self.widget_layout){self.customStyleSetLayoutLS(dt.banner_layout)}self.widget_layout=dt.banner_layout.toString()}if(self.bannerId&&(0!=dt.event_id||6==dt.type_id)){self.$.slideSource.classList.add("d_desktop");self.$.slideSource.classList.add("d_tablet");self.$.slideSource.classList.add("d_mobile");if("undefined"===typeof self.widget.events_list||0==self.widget.events_list.length){self.widget={events_list:[]};self.widget.events_list[0]={web_data:dt,banner_data:[]}}self.widget.events_list[0].banner_data[0]=dt;if(null==dt.event_id){if(4==dt.type_id){self.callRecommend(dt.banner_id)}else if(6==dt.type_id){self.callPopularEvents(dt.sport_id,dt.location_id,1,3)}else if(7==dt.type_id||9==dt.type_id){self.callCouponEvents(data)}else if(8==dt.type_id){let cp=6;if(dt.coupon&&dt.coupon.couponNumber){cp=dt.coupon.couponNumber}self.callPopularEvents(dt.sport_id,dt.location_id,cp,3)}}else if(dt.event_id){self.showSkeleton();if(wsData){self.getSportData(dt.event_id,wsData)}else{self.getSportData(dt.event_id)}}}else{if("undefined"===typeof self.widget.events_list[0]){if(2==dt.type_id&&0==dt.interval_status){dt.type_id=3}self.widget={events_list:[]};self.widget.events_list[0]={web_data:dt,banner_data:[dt]}}else{self.widget.events_list[0].banner_data[0]=dt}if(wsData){self.getSportData(dt.event_id,wsData)}else if("offerlibrary"==self.apiMethod){self.getSportData(dt.event_id)}}var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0;if(3==dt.type_id){self.renderBanner();if(1==eDt.banner_data[0].display_time_status){if(0<eDt.banner_data[0].display_time){self.widgetTimeout=eDt.banner_data[0].display_time;self.checkTimeout(self.bannerId)}}var sendGA=self._sendGA(eDt.web_data.banner_id);if(sendGA){var dataPopupPromoGA4={event:"Views",operator_id:self.operatorId,banner_id:eDt.web_data.banner_id,banner_language:self.language,banner_page:self.pageTag,banner_position:self.positionTag,banner_type:eDt.web_data.type_id,em_id:"true"==self.loggedIn&&self.emUserId&&"undefined"!=self.emUserId?btoa(self.emUserId):"",sport_id:"",sport_name:"",country_id:"",country_name:"",tournament_id:"",tournament_name:"",market_id:"",market_name:"",market_short_id:"",event_id:"",event_match_name:"",outcome_id:"",outcome_key:"",outcome_name:""};self.ga4Push(dataPopupPromoGA4)}}else{if(3==eDt.banner_data[0].status_id){}else{if("4"==eDt.web_data.type_id){self.renderBanner()}else{self.renderBanner()}}}}else{clearInterval(self.waitDuration);self.set("text.minute","");self.set("text.timecount","");self.hideSkeleton();if(self.demo&&self.isSliderBanner()){self.$.slideSource.classList.remove("fadebanner");self.setDemo(self.positionTag,self.pageTag)}else{self.$.slideSource.classList.remove("fadebanner")}if(self.bannerId){return!1}else{self.startLoad()}}}getBannerDataCheck(apiParam,bannerId){var self=this,lsParam=self.positionTag+"-"+self.pageTag+"-"+self.loggedIn+"-"+self.eventId.toString(),ls=self.lsGet("bmfe:"+self.language+"-"+lsParam,"json");if("undefined"!==typeof ls[bannerId]&&"undefined"!==typeof ls[bannerId].successful){self.WEB_API_CACHE[apiParam].cachedata=ls[bannerId];self.getBannerDataCache(ls[bannerId])}else{self.lsDelete("bmfe:"+self.language+"-"+lsParam);self.resetWidget();self.removeSession();self.startLoad()}}getBannerData(){var self=this,webDBannerId="";if(self.bannerId){webDBannerId=self.bannerId}else{if(0==self.widget.events_list.length){var wait=setInterval(function(){self.resetWidget();self.startLoad();clearInterval(wait)},5e3);return!1}var wDt=self.widget.events_list[0].web_data;webDBannerId=wDt.banner_id}var lsParam=self.positionTag+"-"+self.pageTag+"-"+self.loggedIn+"-"+self.eventId.toString(),apiParam="/"+self.language+"/banners/widget/"+self.operatorId+"/"+webDBannerId+"/"+self.positionTag+"/"+self.eventId.toString(),nowTime=new Date,nextLoad=new Date(nowTime.getTime()+5e3),loadFirst=!1,banner_change=!1;if(""==self.bannerId){var banner_hash=self.position_hash}else{var banner_hash=""}var ls=self.lsGet("bmfe:"+self.language+"-"+lsParam,"json");if("undefined"===typeof ls.hash||ls.hash!=banner_hash){banner_change=!0}if(!banner_change&&"undefined"!==typeof ls[webDBannerId]&&ls[webDBannerId].successful&&3==ls[webDBannerId].data.type_id){if("undefined"===typeof self.WEB_API_CACHE[apiParam]){self.WEB_API_CACHE[apiParam]={min_next_load:nextLoad,cachedata:{}}}self.WEB_API_CACHE[apiParam].min_next_load=nextLoad;self.WEB_API_CACHE[apiParam].cachedata=ls[webDBannerId];self.WEB_API_CACHE[apiParam].cachedata.successful=1;self.getBannerDataCache(self.WEB_API_CACHE[apiParam].cachedata)}else{if("undefined"===typeof self.WEB_API_CACHE[apiParam]){self.WEB_API_CACHE[apiParam]={min_next_load:nextLoad,cachedata:{}};loadFirst=!0;self.getBannerDataCheck(apiParam,webDBannerId)}if(nowTime>self.WEB_API_CACHE[apiParam].min_next_load){self.WEB_API_CACHE[apiParam].min_next_load=nextLoad;self.getBannerDataCheck(apiParam,webDBannerId)}else if(!loadFirst&&"undefined"!==typeof self.WEB_API_CACHE[apiParam].cachedata.successful){self.getBannerDataCache(self.WEB_API_CACHE[apiParam].cachedata)}else{if(!loadFirst){var i=0,wait=setInterval(function(){i++;if("undefined"===typeof self.WEB_API_CACHE[apiParam].cachedata.successful){if(200<i){clearInterval(wait)}}else{self.getBannerDataCache(self.WEB_API_CACHE[apiParam].cachedata);clearInterval(wait)}},300)}}}}showFirstLoading(){var self=this,timeOut=0;if("undefined"===typeof self.widget_position_id){timeOut=30}var i=0,wait=setInterval(function(){i++;if("undefined"===typeof self.widget_position_id){if(500<i){clearInterval(wait)}}else{self.loadedSkelOrDemoPage=!0;if(self.isSliderBanner()){if(self.demo){self.setDemo(self.positionTag,self.pageTag)}else{self.showSkeleton()}}clearInterval(wait)}},timeOut)}sportbookInit(){var self=this;self.removeStream(!1);self.sportbook={scorll:"",stream:{payload:{streamUrl:""},rect:{x:0,y:0,top:0,bottom:0,left:0,right:0,width:0,height:0},position:!1},allowShow:!0}}readyStream(){var self=this;self.sportbookInit();if("streaming"==self.bannerType&&self.sportbookId){if(!self.positionTag){self.positionTag="streaming"}self.sportbookIframe=window.document.getElementById(self.sportbookId);self.setTypeBanner();if(self.sportbookIframe){window.addEventListener("message",function(e){let data=e.data;if(data){let type=data.type,payload=data.payload;switch(type){case"OMFE:locationChanged":self.sportbookInit();break;case"OMFE:videoStreamingURL":if(payload&&payload.streamUrl){self.sportbook.stream.payload=payload}else{self.sportbookInit()}break;case"OMFE:videoStreamingPosition":if(payload&&payload.rect){self.sportbook.stream.position=!0;self.sportbook.stream.rect={x:payload.rect.x,y:payload.rect.y,top:payload.rect.top,bottom:payload.rect.bottom,left:payload.rect.left,right:payload.rect.right,width:payload.rect.width,height:payload.rect.height}}break;}}});window.addEventListener("scroll",function(){if(self.sportbook.stream.payload.streamUrl){if(self.sportbook.stream.position){if(window.scrollY>self.sportbook.stream.rect.height+self.sportbook.stream.rect.top){self.setStream()}else{self.removeStream(!1)}}else{self.sportbookIframe.contentWindow.postMessage({type:"OP:videoStreamingPosition"},"*")}}});window.addEventListener("resize",function(){if(self.sportbook.stream.payload.streamUrl){self.sportbookIframe.contentWindow.postMessage({type:"OP:videoStreamingPosition"},"*");if(self.sportbook.stream.position){if(window.scrollY>self.sportbook.stream.rect.height+self.sportbook.stream.rect.top){self.setStream()}else{self.removeStream(!1)}}}})}}else if("iframe"==self.bannerType){if(!self.positionTag){self.positionTag="iframe"}}}resetListPopular(){var self=this;self.listPopular={event:[],market:[],main_market:[],match:[],markets:{},marketId:[],query_markets:{},bettingTypeIds:{},eventPartIds:{},outcome:[],outcomeId:[],bettingOfferId:[]}}updateListPopular(type,id,data,event){var self=this;if("BETTING_OFFER"==type){if(self.listPopular&&"undefined"!==typeof self.listPopular.bettingOfferId[id]){var outcomeId=self.listPopular.bettingOfferId[id].outcomeId;if("undefined"!==typeof self.listPopular.outcome[outcomeId]){if("isAvailable"==event){self.listPopular.bettingOfferId[id].isAvailable=data?!0:!1;self.listPopular.outcome[outcomeId].available=data?!0:!1}else if("odds"==event){self.listPopular.bettingOfferId[id].odds=data;self.listPopular.outcome[outcomeId].price=data}else if("statusId"==event){self.listPopular.bettingOfferId[id].statusId=data;self.listPopular.outcome[outcomeId].statusId=data}}}}}genListPopular(item){var self=this;if(item&&"undefined"!==typeof item._type){if("MATCH"==item._type){self.arrEvent[item.id]=item;self.listPopular.match.push(item);self.listPopular.event[item.id]=item;self.listPopular.markets[item.id]=[];self.listPopular.query_markets[item.id]=[];self.listPopular.bettingTypeIds[item.id]=[];self.listPopular.eventPartIds[item.id]=[]}else if("MARKET"==item._type){self.listPopular.markets[item.eventId].push({bettingTypeId:item.bettingTypeId,bettingTypeName:item.bettingTypeName,eventId:item.eventId,eventPartId:item.eventPartId,eventPartName:item.eventPartName,labelName:item.labelName?item.labelName:"",labelStyle:item.labelStyle?item.labelStyle:"",id:item.id,name:item.name,selections:[]});self.listPopular.marketId[item.id]=item;self.listPopular.query_markets[item.eventId].push(item.id);self.listPopular.bettingTypeIds[item.eventId].push(item.bettingTypeId);self.listPopular.eventPartIds[item.eventId].push(item.eventPartId)}else if("OUTCOME"==item._type){self.listPopular.outcomeId[item.id]=item;if("undefined"===typeof self.listPopular.outcome[item.id]){self.listPopular.outcome[item.id]={eventId:item.eventId,translationKey:item.translatedName,outcomeId:item.id,props:{},homeParticipantId:self.listPopular.event[item.eventId].homeParticipantId,awayParticipantId:self.listPopular.event[item.eventId].awayParticipantId};if("undefined"!==typeof item.headerNameKey){self.listPopular.outcome[item.id].role=item.headerNameKey}if("undefined"!==typeof item.paramFloat1){self.listPopular.outcome[item.id].props.param=item.paramFloat1}if("undefined"!==typeof item.paramParticipantId1){self.listPopular.outcome[item.id].props.participantId1=item.paramParticipantId1}if("undefined"!==typeof item.paramFloat1&&"undefined"!==typeof item.paramFloat2){self.listPopular.outcome[item.id].props.param1=item.paramFloat1;self.listPopular.outcome[item.id].props.param2=item.paramFloat2}}}else if("MARKET_OUTCOME_RELATION"==item._type){if("undefined"!==typeof self.listPopular.outcome[item.outcomeId]){if("undefined"===typeof self.listPopular.market[item.marketId]){self.listPopular.market[item.marketId]={id:item.marketId,selections:[]}}self.listPopular.market[item.marketId].selections.push(self.listPopular.outcome[item.outcomeId])}}else if("BETTING_OFFER"==item._type){self.listPopular.bettingOfferId[item.id]=item;if("undefined"!==typeof self.listPopular.outcome[item.outcomeId]){self.listPopular.outcome[item.outcomeId].isLive=item.isLive;self.listPopular.outcome[item.outcomeId].bettingTypeId=item.bettingTypeId;self.listPopular.outcome[item.outcomeId].bettingTypeName=item.bettingTypeName;self.listPopular.outcome[item.outcomeId].price=item.odds;self.listPopular.outcome[item.outcomeId].providerId=item.providerId;self.listPopular.outcome[item.outcomeId].available=item.isAvailable;self.listPopular.outcome[item.outcomeId].id=item.id;self.listPopular.outcome[item.outcomeId].statusId=item.statusId;self.listPopular.outcome[item.outcomeId].orderOutcome=self.outcomeOrder(self.listPopular.outcome[item.outcomeId].bettingTypeId,self.listPopular.outcome[item.outcomeId].role,self.listPopular.outcome[item.outcomeId].props,self.listPopular.outcome[item.outcomeId].homeParticipantId,self.listPopular.outcome[item.outcomeId].awayParticipantId,item.odds)}}else if("MAIN_MARKET"==item._type){self.listPopular.main_market.push(item)}}}genMatchOdds(eventId,bDt){var self=this,topic="/sports/"+self.operatorId+"/"+self.language+"/"+eventId+"/match-odds/market-group/Main_BannerMatrix";if(self.slider_setting&&self.slider_setting.extra_config&&self.slider_setting.extra_config.matchOdds){topic="/sports/"+self.operatorId+"/"+self.language+"/"+eventId+"/match-odds/market-group/"+self.slider_setting.extra_config.matchOdds}if(bDt){var betTypeEventParts=[];if(bDt.betting_event&&bDt.betting_event.betTypeEventParts&&bDt.betting_event.betTypeEventParts.length){betTypeEventParts=bDt.betting_event.betTypeEventParts}if(bDt.betting_event_live&&bDt.betting_event_live.betTypeEventParts&&bDt.betting_event_live.betTypeEventParts.length){bDt.betting_event_live.betTypeEventParts.forEach((item2,i2)=>{if(!betTypeEventParts.includes(item2)){betTypeEventParts.push(item2)}})}if(bDt.markets_incident){if(bDt.markets_incident.length){bDt.markets_incident.forEach((item2,i2)=>{if(item2.data){item2.data.forEach((item3,i3)=>{if(item3.betting_event&&item3.betting_event.betTypeEventParts&&item3.betting_event.betTypeEventParts.length){item3.betting_event.betTypeEventParts.forEach((item4,i4)=>{if(!betTypeEventParts.includes(item4)){betTypeEventParts.push(item4)}})}})}})}}if(betTypeEventParts.length){topic="/sports/"+self.operatorId+"/"+self.language+"/"+eventId+"/match-odds/"+betTypeEventParts.join(",").replaceAll("_","-")}}return topic}setTextEvent(type=""){var self=this,check=0;self.listPopular.match.forEach((item,i)=>{if(0==check&&"undefined"!==typeof self.listPopular.markets[item.id]&&self.listPopular.markets[item.id].length){self.set("text.countryId",item.venueId);self.set("text.countryName",item.venueName);self.set("text.event_id",item.id);self.set("text.event_name",item.name);self.set("text.time",self.getDateFormat(item.startTime));self.set("text.homeName",item.homeParticipantName);self.set("text.awayName",item.awayParticipantName);self.set("text.sportId",item.sportId);self.set("text.sportName",item.sportName);self.set("text.status_id",item.statusId);self.set("text.status",item.statusName);self.set("text.tournamentId",item.parentId);if("undefined"!==typeof item.shortParentName){self.set("text.tournamentName",item.shortParentName)}else if("undefined"!==typeof item.parentName){self.set("text.tournamentName",item.parentName)}check=1;if(0==self.listPopular.markets[item.id][0].selections.length){var i=0,wait=setInterval(function(){if("undefined"!==typeof self.listPopular.markets[item.id]&&"undefined"!==typeof self.listPopular.markets[item.id][0]&&self.listPopular.markets[item.id][0].selections.length){clearInterval(wait);if("popular"==type){self.getPopularSportDataAction(item.id,{successful:1,data:self.listPopular.markets[item.id],main_market:self.listPopular.main_market})}else{self.getSingleSportDataAction(item.id,{successful:1,data:self.listPopular.markets[item.id]})}}else{i++;if(100<i){clearInterval(wait);self.disableRmR("",self.bannerId,"");if(self.widget_position_id&&["1","2","3"].includes(self.widget_position_id.toString())){self.startLoad()}}}},100)}else{if("popular"==type){self.getPopularSportDataAction(item.id,{successful:1,data:self.listPopular.markets[item.id],main_market:self.listPopular.main_market})}else{self.getSingleSportDataAction(item.id,{successful:1,data:self.listPopular.markets[item.id]})}}}})}callPopularEvents(disciplineId,locationId,eventsNumber,marketsNumber){var self=this;if(self.disableApiCallback){return!0}var topic="/sports/"+self.operatorId+"/"+self.language+"/popular-matches-aggregator-main/"+disciplineId+"/"+locationId+"/"+eventsNumber+"/"+marketsNumber,isClone=self.parentNode.classList.contains("splide__slide--clone")&&self.fromInclude;if(isClone){if("undefined"!==typeof self.WEB_API_CACHE[topic]&&"undefined"!==typeof self.WEB_API_CACHE[topic].records){self.popularRes({kwargs:self.WEB_API_CACHE[topic]})}else{if("undefined"!==typeof self.dumpPopularListener){self.removeEventListener("topicListen:initialDump",self.dumpPopularListener)}self.dumpPopularListener=self.dumpPopular.bind(self,topic);self.addEventListener("topicListen:initialDump",self.dumpPopularListener)}if("undefined"!==typeof self.regPopularListener){self.removeEventListener("topicListen:register",self.regPopularListener)}self.regPopularListener=self.regPopular.bind(self,topic);self.addEventListener("topicListen:register",self.regPopularListener)}else{self.ws_session.register(topic,function(args,kwargs,details){self.wsChange(kwargs);self.customEventTopic("topic:register",topic,kwargs)}).then(function(regId){self.subscribePopular=regId;self.ws_session.call("/sports#initialDump",[],{topic:topic}).then(function(res){self.popularRes(res);self.customEventTopic("topic:initialDump",topic,res.kwargs)})})}}regPopular(topic,dataE){var self=this;if(dataE.detail&&dataE.detail.topic==topic){self.wsChange(dataE.detail.kwargs)}}dumpPopular(topic,dataE){var self=this;if(dataE.detail&&dataE.detail.topic==topic){self.popularRes({kwargs:dataE.detail.kwargs})}}popularRes(res){var self=this;if(res&&res.kwargs&&res.kwargs.records&&res.kwargs.records.length){self.resetListPopular();(async()=>{await Promise.all([res.kwargs.records.forEach((item,i)=>{self.genListPopular(item)})]).then(pData=>{(async()=>{var loaded=0;await Promise.all([self.listPopular.match.forEach((item2,i2)=>{self.listPopular.markets[item2.id].forEach((item3,i3)=>{var selections=self.listPopular.market[item3.id].selections;if(selections.length){selections=selections.sort((a,b)=>a.orderOutcome-b.orderOutcome);self.listPopular.markets[item2.id][i3].selections=selections;loaded++}})})]).then(pData1=>{var eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0,wDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.web_data?eDt.web_data:{},bDt="undefined"!==typeof eDt&&"undefined"!==typeof eDt.banner_data?eDt.banner_data[0]:{};if("8"==self.tid){var cacheName=self.genCacheName(self.tid,self.bannerId,"",self.language);self.set("offerList",[]);self.set("offerListIndex",[]);var countAvailable=0,countDisable=0,totalOdds=0,offerList=[],offerListIndex=[],oddsCA=[];self.listPopular.match.forEach((item2,i2)=>{if(self.listPopular.markets[item2.id]){var found=[];if(self.listPopular.markets){if(self.listPopular.main_market[0]){found=self.listPopular.markets[item2.id].filter(function(item3,i3){return item3.bettingTypeId==self.listPopular.main_market[0].bettingTypeId})}found.push(self.listPopular.markets[item2.id][0]);if(found[0]&&found[0].selections){var selections=found[0].selections;if(wDt.coupon&&wDt.coupon.couponOddType&&"highest"==wDt.coupon.couponOddType){selections=selections.sort((a,b)=>b.price-a.price)}else{selections=selections.sort((a,b)=>a.price-b.price)}if(self.listPopular.bettingOfferId[selections[0].id]){offerList.push({...self.listPopular.bettingOfferId[selections[0].id],OUTCOME:self.listPopular.outcomeId[selections[0].outcomeId],MARKET:self.listPopular.marketId[found[0].id],MATCH:self.listPopular.event[selections[0].eventId]});if(self.listPopular.bettingOfferId[selections[0].id].isAvailable){countAvailable++;totalOdds=(0==totalOdds?1:totalOdds)*selections[0].price;oddsCA.push({eventId:selections[0].eventId,bettingOfferId:selections[0].id,odd:selections[0].price});offerListIndex.push(selections[0].id)}else{countDisable++}}}}}});if(!offerList.length||1>=countAvailable){self.disableRmR("",self.bannerId,cacheName,!1)}else{self.onResize();self.set("offerList",offerList);self.set("offerListIndex",offerListIndex);self.set("offerCheckedArray",oddsCA);self.set("oddsCheckedArrayCount",totalOdds);var cacheOutcome=JSON.stringify(self.offerList);self.setEventLs(cacheName,"action_outcome",{type_id:self.tid,image_banner_set:bDt.banner_image,background_image_transperent:bDt.background_image_transperent,background_color:bDt.background_color,content:self.text.content,title:self.text.title,devices:wDt.devices,action_outcome:cacheOutcome});self.hideSkeleton();self.$.slideSource.classList.add("fadebanner")}}else{var bannerId=self.bannerId;if(self.widget_position_id&&["1","2","3"].includes(self.widget_position_id.toString())){if("undefined"!==typeof wDt.banner_id){bannerId=wDt.banner_id}else{self.resetWidget();self.startLoad();return!1}}if(0==self.listPopular.match.length){var cacheName=self.genCacheName(self.tid,bannerId,"",self.language);self.disableRmR("",bannerId,cacheName);if(self.widget_position_id&&["1","2","3"].includes(self.widget_position_id.toString())){self.startLoad()}}else{if(loaded){if(wDt.sport_id===self.listPopular.match[0].sportId&&wDt.location_id===self.listPopular.match[0].venueId){self.setTextEvent("popular")}}else{self.disableRmR("",bannerId,"auto",!1);if(self.widget_position_id&&["1","2","3"].includes(self.widget_position_id.toString())){self.resetWidget();self.startLoad()}}}}})})()})})()}}renderPopularEvent(eventId,data_event){var self=this;self.widget.events_list[0].banner_data[0].status_id=self.arrEvent[eventId].statusId;self.backupMarketName=data_event.data[0].name;self.set("text.marketname",self.getText(data_event.data[0].name));self.set("text.labelName",data_event.data[0].labelName);self.set("text.labelStyle",data_event.data[0].labelStyle);if("undefined"!==typeof self.arrEvent[eventId]&&"undefined"!==typeof self.arrEvent[eventId].venueName){self.set("text.countryId",self.arrEvent[eventId].venueId);self.set("text.countryName",self.arrEvent[eventId].venueName)}var data_event_data=data_event.data[0],select_market=data_event_data.id,milliseconds=new Date().getTime();self.firstRender(milliseconds,[],"",select_market,data_event_data);self.hideSkeleton();self.removeDemo();self.$.slideSource.classList.add("fadebanner");try{if(self.widget.events_list[0].web_data.generate_link&&"undefined"!==typeof self.listPopular.event[eventId]){self.ws_event[eventId]=self.listPopular.event[eventId];self.autoLink(self.ws_event[eventId])}}catch(err){}}getSingleSportDataAction(eventId,data_event){var self=this,selectMk=[],selectMkProps=[],eDt=self.widget&&self.widget.events_list.length?self.widget.events_list[0]:void 0;if("undefined"!==typeof eDt&&"undefined"!==typeof eDt.web_data&&6!=eDt.web_data.type_id){if(2==eDt.web_data.status_id){if("offerlibrary"==self.apiMethod){if(eDt.web_data.betting_event_live.marketIds&&eDt.web_data.markets_live.length){eDt.web_data.markets_live.forEach((item,i)=>{if(eDt.web_data.betting_event_live.marketIds[item]){selectMk.push(`${eventId}_${eDt.web_data.betting_event_live.marketIds[item]}`);selectMkProps.push(eDt.web_data.betting_event_live.props&&eDt.web_data.betting_event_live.props[item]?eDt.web_data.betting_event_live.props[item]:"")}})}}else{selectMk=eDt.web_data.markets_live}}else{if("offerlibrary"==self.apiMethod){if(eDt.web_data.betting_event.marketIds&&eDt.web_data.markets.length){eDt.web_data.markets.forEach((item,i)=>{if(eDt.web_data.betting_event.marketIds[item]){selectMk.push(`${eventId}_${eDt.web_data.betting_event.marketIds[item]}`);selectMkProps.push(eDt.web_data.betting_event.props&&eDt.web_data.betting_event.props[item]?eDt.web_data.betting_event.props[item]:"")}})}}else{selectMk=eDt.web_data.markets}}}if(0==selectMk.length){self.disableBanner(eventId,self.bannerId)}else{(async()=>{var newOutcome=[];await Promise.all([selectMk.forEach((item,i)=>{var btId="",epId="";if(-1!==item.indexOf("_")&&2==item.split("_").length){[btId,epId]=item.split("_")}var found=data_event.data.filter(function(item2,i2){return btId&&epId?item2.bettingTypeId==btId&&item2.eventPartId==epId:item2.id==item});if(found.length){if("offerlibrary"==self.apiMethod){if(found[0].selections){if(3>=found[0].selections.length){newOutcome.push(found[0])}else{if(selectMkProps[i]){var selections=found[0].selections.filter(function(item2,i2){return item2.props&&item2.props.param==selectMkProps[i]});if(selections.length&&3>=selections.length){newOutcome.push({...found[0],selections:selections})}}}}}else{newOutcome.push(found[0])}}})]).then(pData=>{if(newOutcome.length){self.renderPopularEvent(eventId,{successful:1,data:newOutcome});if("undefined"!==typeof eDt&&"undefined"!==typeof eDt.web_data){self.callWsScore(eventId,eDt.web_data.sport_id)}}else{self.disableBanner(eventId,self.bannerId)}})})()}}getPopularSportDataAction(eventId,data_event){var self=this;(async()=>{var newOutcome=[];await Promise.all([data_event.main_market.forEach((item,i)=>{var found=data_event.data.filter(function(item2,i2){return item2.bettingTypeId==item.bettingTypeId&&item2.eventPartId==item.eventPartId});if(found.length){newOutcome.push(found[0])}})]).then(pData=>{if(newOutcome.length){self.renderPopularEvent(eventId,{successful:1,data:newOutcome})}else{self.renderPopularEvent(eventId,data_event)}})})()}readyBanner(){var self=this;if((!self.positionTag||!self.pageTag)&&!self.isSpecialBanner()){return!1}self.showLoading=!0;self.onResize();self.customStyle();self.haveEventCache=!1;if(self.isSpecialBanner()){return!1}if(self.bannerId&&(self.eid||"6"==self.tid)){var cacheName=self.genCacheName(self.tid,self.bannerId,self.eid,self.language),eCache=self.getEventLs(cacheName);if(eCache){self.haveEventCache=!0}}var lsParam=self.positionTag+"-"+self.pageTag+"-"+self.loggedIn+"-"+self.eventId.toString(),ls=self.lsGet("bmfe:"+self.language+"-"+lsParam,"json");if(0==self.widget_position_id&&""==self.bannerId||"undefined"!=typeof ls.maindata&&ls.maindata.data.length&&(3==ls.maindata.data[0].type_id||2==ls.maindata.data[0].type_id&&("undefined"==typeof ls.maindata.data[0].tournament_event_id||0==ls.maindata.data[0].tournament_event_id.length))){if(""==self.bannerId){self.showLoading=!1}}self.showFirstLoading();var i=0,wait=setInterval(function(){i++;if(!self.loadedSkelOrDemoPage){if(5e3<i){clearInterval(wait)}}else{self.startLoad();clearInterval(wait)}},self.loadedSkelOrDemoPage?0:10)}lsSet(k,v){window.localStorage.setItem(k,v)}lsGet(k,t="plain"){var ls=window.localStorage.getItem(k);if("json"==t){return ls?JSON.parse(ls):{}}else{return ls?ls:""}}lsDelete(k){window.localStorage.removeItem(k)}lsPrepare(){var self=this,ls=[{k:"bmfe:events",v:"{}"},{k:"bmfe:login",v:"false"},{k:"bmfe:location",v:"{}"},{k:"bmfe:tournament",v:"{}"},{k:"bmfe:config",v:"{}"},{k:"bmfe:discipline",v:"{}"},{k:"bmfe:eventPart",v:"{}"},{k:"bmfe:blockpopup",v:"{\"logout\":[], \"login\":[]}"},{k:"bmfe:blockpopupLimit",v:"[]"},{k:"bmfe:blockpopupForever",v:"{\"hash\":\"\", \"positions\":[], \"old_data\": \"\"}"}];ls.forEach(i=>{var tmp=self.lsGet(i.k);if(!tmp){self.lsSet(i.k,i.v)}})}lsRemoveAll(){let keys=Object.keys(window.localStorage);keys.forEach((key,i)=>{if(0===key.indexOf("bmfe:")&&!["bmfe:blockpopup","bmfe:blockpopupLimit","bmfe:blockpopupForever"].includes(key)){window.localStorage.removeItem(key)}})}ready(){super.ready();var self=this;self.set("text.liveText","LIVE");if("tr"==self.language.toLowerCase()){self.set("text.liveText","CANLI")}self.set("text.couponSelect","sel.");self.set("text.couponTotal","TOTAL ODDS:");self.set("text.couponAdd","ADD");self.set("text.couponAddBetslip","SELECTIONS TO BETSLIP");if(!self.fromInclude){var firstLogin=self.lsGet("bmfe:login");if("undefined"===typeof self.loggedIn||"false"!=self.loggedIn&&"true"!=self.loggedIn){self.loggedIn="true"!=firstLogin?"false":"true"}setTimeout(function(){if(firstLogin!=self.loggedIn){self.lsSet("bmfe:login",self.loggedIn.toString())}},2e3)}self.readyStream();self.readyBanner();self.resizeListener=self.onResize.bind(self);window.addEventListener("resize",self.resizeListener);self.messageListener=self.messageReceive.bind(self);window.addEventListener("message",self.messageListener)}getCookie(name){try{var cookie=`; ${document.cookie}`,split=cookie.split(`; ${name}=`);if(2===split.length){var value=split[1].split(";")[0];return value}}catch(err){}return null}constructor(){super();var self=this;self.useSection="";self.googleTagManagerId=!1;var config=self.lsGet("bmfe:config","json");if(config&&config.ga&&config.ga.key){if(config.ga.consent){var consent=self.getCookie("OptanonConsent");if(consent&&-1!==consent.indexOf("C0002%3A1")){self.googleTagManagerId=config.ga.key}}else{self.googleTagManagerId=config.ga.key}}setTimeout(function(){self.webapiUrl=null!=self.getAttribute("webapi-url")&&self.getAttribute("webapi-url")&&"undefined"!=self.getAttribute("webapi-url")?self.getAttribute("webapi-url"):"";self.webapiRealm=null!=self.getAttribute("webapi-realm")&&self.getAttribute("webapi-realm")&&"undefined"!=self.getAttribute("webapi-realm")?self.getAttribute("webapi-realm"):"";self.offerlibUrl=null!=self.getAttribute("offerlib-url")&&self.getAttribute("offerlib-url")&&"undefined"!=self.getAttribute("offerlib-url")?self.getAttribute("offerlib-url"):"";self.offerlibLang=null!=self.getAttribute("offerlib-lang")&&self.getAttribute("offerlib-lang")&&"undefined"!=self.getAttribute("offerlib-lang")?self.getAttribute("offerlib-lang"):"";self.loadAutobahn();if(self.googleTagManagerId){self.loadGoogleTagManager()}self.loadOfferLib()},100);var bannerId=self.getAttribute("banner-id"),loggedIn=self.getAttribute("logged-in");if((null==bannerId||""==bannerId)&&null==loggedIn||null!=loggedIn&&"true"!=loggedIn.toLowerCase()&&"false"!=loggedIn.toLowerCase()){setTimeout(function(){loggedIn=self.getAttribute("logged-in");if(null==loggedIn||null!=loggedIn&&"true"!=loggedIn.toLowerCase()&&"false"!=loggedIn.toLowerCase()){self.lsSet("bmfe:login",!1);setTimeout(function(){loggedIn=self.getAttribute("logged-in");if(self.ws_session&&(null==loggedIn||null!=loggedIn&&"true"!=loggedIn.toLowerCase()&&"false"!=loggedIn.toLowerCase())){self.setAttribute("logged-in","false")}},3e4)}},5e3)}self.lsPrepare();self.showSelectPopup="false";self.disableCloseButton="false";self.widget_id=self.randomID();self.random_color=self.randomRGBA();self.hasWebP().then(function(hasWebP){self.webp_support=hasWebP});self.fromInclude="true"==self.getAttribute("from-include")||!0==self.getAttribute("from-include")?!0:!1;self.fromIncludeWS="true"==self.getAttribute("from-include")||!0==self.getAttribute("from-include")?!0:!1;self.demo="true"==self.getAttribute("demo")||!0==self.getAttribute("demo")?!0:!1;self.subscribeWsMinute={};self.subscribeOdds={};self.subscribeScore={};self.subscribePopular={};self.subscribeCoupon={};self.subscribeCouponBBD={};self.subscribeRecommend={};self.loadedSkelOrDemoPage=!1;if("undefined"===typeof self.WEB_API_CACHE){self.WEB_API_CACHE=[]}if("undefined"===typeof self.GA4_PUSH_CACHE){self.GA4_PUSH_CACHE=[]}if("undefined"===typeof self.last_hash){self.last_hash=[]}self.last_hash[self.widget_id]=[];self.webp_support=null;self.text={timecount:"",title:"",content:"",time:"",status:"",marketid:"",marketname:"",marketShortId:"",minute:"",score1:0,score2:0,homeName:"",awayName:"",partName:"",sportId:"",sportName:"",tournamentId:"",tournamentName:"",countryId:"",countryName:"",liveText:"",status_id:"",event_id:"",event_name:"",time_id:""};self.loadedSkelton=!1;self.nowScreen="desktop";if(480>window.innerWidth){self.nowScreen="mobile"}else if(481<=window.innerWidth&&1024>=window.innerWidth){self.nowScreen="tablet"}else if(1024<window.innerWidth){self.nowScreen="desktop"}self.sliderSkelArray=[1,2,3,4];self.interval_main_time=6e4;self.ws_event=[];self.arrEvent=[];self.waitTNoRecords={};self.waitTNoSlide1={};self.waitTNoSlide2={};self.waitTNoSlide3={};self.waitTSliderCheck={};self.waitTCheckDelete={};self.waitTIncidentClose={};self.waitTShowName={};self.waitTScreensize={};self.waitTDelayIncident={};self.waitSliderRm={};self.waitFallback={};self.waitRepeat={};self.waitDuration={};self.waitChange={};self.waitMinute={};self.waitMinsec={};self.waitCTimeout=!1;self.bettingClass=[];self.eventScoreDetails=[];self.loadingFallback=!1;self.widgetTimeout=-1;self.last_score=null;self.last_yellow_card=null;self.last_red_card=null;self.last_corner=null;self.use_skeleton_img="false";self.default_skeleton="";self.backupMarketName="";self.listInterval=null;self.sportbook={};self.floating_video=!1;self.FLAG_ENDPOINT="";self.FLAG_EXT="";self.SPORT_ENDPOINT="";self.SPORT_EXT="";self.root_auto_link="";self.disableFallback=!1;self.disableApiCallback=!1;self.oddsCheckedArray=[];self.oddsCheckedArrayCount=0;self.offerCheckedArray=[];self.marketsColumn=[];self.xClass1="";self.xClass2="";self.autoHeight=!1;self.disableCrop=!1;self.cacheLoading=!1}}window.customElements.define(BannermatrixBannerWebapi.is,BannermatrixBannerWebapi);
//# sourceURL=https://bannermatrix.nwacdn.com/assets/widgets/0.21.3/index.html-24.js
